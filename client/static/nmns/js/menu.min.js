!function(){$("#mainRow").append($('<div id="menuModal" class="modal fade" tabIndex="-1" role="dialog" aria-hidden="true" data-index="0">        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">          <div class="modal-content">            <div class="modal-header">              <span>                <h5 class="modal-title" id="menuTitle">메뉴 상세정보</h5>              </span>              <button type="button" class="close" data-dismiss="modal" aria-label="닫기">                <span aria-hidden="true">&times;</span>              </button>            </div>            <div class="modal-body">              <div class="form-group">                <div class="row mb-2">                  <div class="col-lg-6 col-12 text-center">                    <input id="menuName" type="text" placeholder="이름" class="form-control col-12 border-0 text-center my-3"/>                    <input id="menuContact" type="text" placeholder="연락처" class="form-control col-12 border-0 text-center my-3"/>                  </div>                  <div class="col-lg-6 col-12">                    <label for="menuEtc" class="col-12 px-0 col-form-label col-form-label-sm">메모</label>                    <div class="col-12 px-0">                      <textarea id="menuEtc" type="text" placeholder="이 고객에 대한 메모를 적어주세요." class="form-control han"></textarea>                    </div>                  </div>                </div>                <div class="row mb-2 px-3">                  <label for="menuManager" class="col-2 col-lg-1 p-0 col-form-label col-form-label-sm">담당자</label>                  <div class="col-lg-10 col-sm-8 col-7 px-0 mr-auto">                    <button id="menuManager" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn btn-sm dropdown-toggle btn-flat form-control form-control-sm text-left"></button>                    <div class="dropdown-menu rounded-0" aria-labelledby="menuManager" role="menu">                    </div>                  </div>                  <button type="button" id="submitMenu" class="btn btn-primary btn-flat col-auto" aria-label="수정">수정</button>                </div>                <div class="form-group d-flex">                  <label for="menuNoShow" class="col-2 col-lg-1 p-0 col-form-label col-form-label-sm">노쇼내역</label>                  <div class="col-10 col-lg-11 pl-sm-0 mr-auto">                    <span id="menuNoShow"></span>                  </div>                </div>                <div class="form-group border-top">                  <ul id="menuTabs" class="nav nav-tabs mt-3" role="tablist">                    <li class="nav-item active" style="display:flex;">                      <a class="nav-link active" id="menuHistoryTab" data-toggle="tab" href="#menuHistory" role="tab" aria-controls="menuHistory" aria-selected="true">예약내역</a>                    </li>                    <li class="nav-item" style="display:flex;">                      <a class="nav-link" id="menuAlrimTab" data-toggle="tab" href="#menuAlrim" role="tab" aria-controls="menuAlrim" aria-selected="false">알림톡 내역</a>                    </li>                  </ul>                  <div class="tab-content">                    <div id="menuHistory" class="col-12 my-3 tab-pane fade show active px-0" role="tabpanel" aria-labelledby="menuHistoryTab"></div>                    <div id="menuAlrim" class="col-12 my-3 tab-pane fade accordion px-0" role="tabpanel" aria-labelledby="menuAlrimTab"></div>                  </div>                  <div class="ml-3 px-0 btn addHistory">                    <p class="text-secondary align-top mb-0">                      <i class="fas fa-plus" aria-label="예약 추가하기"></i> 예약 추가하기                    </p>                  </div>                </div>              </div>            </div>          </div>        </div>      </div>').on("show.bs.modal",e)),$("#updateMenuLink").on("touch click",function(){if($(".updatingMenu-collapsed").toggle(),$(".updatingMenu-expanded").toggle(),$("#mainMenuTools .updatingMenu-collapsed").toggleClass("d-inline-flex"),$(".updatingMenu-collapsed").is(":visible"))$("#mainMenuList").data("sortable")&&$("#mainMenuList").data("sortable").option("disabled",!1),$(this).text("완료");else{$("#mainMenuList").data("sortable")&&$("#mainMenuList").data("sortable").option("disabled",!0);var t=!1,i=[];$("#mainMenuList .menuRow").map(function(e,a){i.push(NMNS.menuList[1*a.getAttribute("data-index")]),"delete"===$(a).data("action")?(i[e].action="delete",t=!0):e!==1*a.getAttribute("data-index")&&(t=!0)}),t&&NMNS.socket.emit("update menu list",i),$(this).text("수정")}});var n=0;function l(e,a){for(var t,i="",n=e;n<a;n++)i+='<div class="menuRow col-12" data-index="'+n+'"><div class="col-3 px-0 font-weight-bold" style="font-size:14px">'+((t=NMNS.menuList[n]).name&&""!==t.name?t.name:"(이름없음)")+'</div><div class="col px-0 montserrat">'+(0!=t.cardPrice&&t.cardPrice?(t.cardPrice+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):"-")+'</div><div class="col-3 px-0 montserrat">'+(0!=t.cashPrice&&t.cashPrice?(t.cashPrice+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):"-")+'</div><div class="col-3 px-0 montserrat">'+(0!=t.memberPrice&&t.memberPrice?(t.memberPrice+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):"-")+'</div><div class="col-1 updatingMenu-collapsed"><button type="button" class="deleteMenuLink close p-0 m-0" aria-label="삭제"><span aria-hidden="true">&times;</span></button></div><a class="menuModalLink" href="#" data-toggle="modal" data-target="#menuModal" title="상세보기"></a></div>';return i}function i(e){var a,t=$("#mainMenuList"),i="";NMNS.menuList&&e?(t.children(":not(.ps)").remove(),NMNS.menuList&&0<NMNS.menuList.length?i+=l(0,a=Math.min(0===n?n+Math.max(20,5+Math.ceil($("#mainMenuList").height()/48)-$("#mainMenuList .menuRow").length):n,NMNS.menuList.length)):i+="<p>아직 등록된 메뉴가 없습니다. 새로운 메뉴를 등록하여 고객의 매출내역을 기록, 관리해보세요!</p>"):NMNS.menuList&&(a=Math.min(n+Math.max(20,5+Math.ceil($("#mainMenuList").height()/48)-$("#mainMenuList .menuRow").length),NMNS.menuList.length),i+=l(n,a)),n=a,t.append($(i).on("touch click",".menuModalLink",function(e){e.preventDefault()}).on("touch click",".deleteMenuLink",function(e){e.stopPropagation(),$(this).parents(".menuRow").data("action","delete").hide()})),t.data("sortable")||t.data("sortable",Sortable.create(t[0],{animation:150,disabled:!0,forceFallback:!0}))}function e(){}NMNS.socket.on("get menu list",socketResponse("메뉴 리스트 조회",function(e){NMNS.menuList=e.data,i(!(n=0))})),NMNS.socket.on("update menu list",socketResponse("메뉴 리스트 수정",void 0,function(e){NMNS.menuList=e.data,i(!(n=0))})),NMNS.socket.on("add menu",socketResponse("메뉴 추가",function(e){NMNS.history.remove(e.data.id,findById)},function(a){var e=NMNS.menuList.findIndex(function(e){return e.id===a.data.id});Number.isInteger(e)&&-1<e&&(NMNS.menuList.splice(e,1),i(!0))})),NMNS.socket.on("update menu",socketResponse("메뉴 항목 수정",function(e){NMNS.history.remove(e.data.id,findById)},function(a){var e=NMNS.history.find(function(e){return e.id===a.data.id}),t=NMNS.menuList.findIndex(function(e){return e.id===a.data.id});Number.isInteger(t)&&-1<t&&(NMNS.menuList[t].cardPrice=e.cardPrice,NMNS.menuList[t].cashPrice=e.cashPrice,NMNS.menuList[t].name=e.name,NMNS.menuList[t].memberPrice=e.memberPrice,NMNS.history.remove(a.data.id,findById),i(!0))})),NMNS.menuList=[{id:1,name:"매니큐어",cashPrice:1e4,cardPrice:2e4,memberPrice:1e4},{id:2,name:"매니큐어2",cashPrice:1e4,cardPrice:2e4,memberPrice:1e4},{id:3,name:"매니큐어3",cashPrice:1e4,cardPrice:2e4,memberPrice:1e4},{id:4,name:"매니큐어4",cashPrice:1e4,cardPrice:2e4,memberPrice:1e4},{id:5,name:"매니큐어5",cashPrice:1e4,cardPrice:2e4,memberPrice:1e4},{id:6,name:"매니큐어6",cashPrice:1e4,cardPrice:2e4,memberPrice:1e4}],i(!0)}();