!function(){$("#mainRow").append($('<div id="menuModal" class="modal fade" tabIndex="-1" role="dialog" aria-hidden="true" data-index="0">        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">          <div class="modal-content">            <div class="modal-header">              <span>                <h5 class="modal-title" id="menuTitle">메뉴 추가</h5>              </span>              <button type="button" class="close" data-dismiss="modal" aria-label="닫기">                <span aria-hidden="true">&times;</span>              </button>            </div>            <div class="modal-body">              <div class="row mx-0 col-12 p-0">                <form id="menuForm" class="mb-1 col-12 px-0">                  <div class="form-group mb-0">                    <div>메뉴 이름</div>                    <input id="menuFormName" type="text" placeholder="메뉴 이름을 입력해주세요." class="form-control form-control-sm mt-3"/>                    <div style="margin-top:35px">카드 가격</div>                    <input id="menuFormPriceCard" type="text" pattern="[0-9]*" placeholder="카드 가격을 입력해주세요." class="form-control form-control-sm mt-3 mb-2 montserrat"/>                    <div style="margin-top:35px">현금 가격</div>                    <input id="menuFormPriceCash" type="text" pattern="[0-9]*" placeholder="현금 가격을 입력해주세요." class="form-control form-control-sm mt-3 mb-2 montserrat"/>                    <div style="margin-top:35px">멤버십 가격</div>                    <input id="menuFormPriceMembership" type="text" pattern="[0-9]*" placeholder="멤버십 가격을 입력해주세요." class="form-control form-control-sm mt-3 mb-2 montserrat"/>                  </div>                </form>                <div class="row mx-0 col-12 px-0 mt-5">                  <button type="button" class="btn btn-accent col" id="menuFormBtn">저장</button>                </div>              </div>            </div>          </div>        </div>      </div>').one("show.bs.modal",function(){$("#menuFormBtn").on("touch click",function(){if(""!==$("#menuFormName").val()){var e=$("#menuForm").data("origin");if(e){NMNS.history.push({id:e.id,name:e.name,priceCash:e.priceCash,priceCard:e.priceCard,priceMembership:e.priceMembership});var i={id:e.id,name:$("#menuFormName").val(),priceCash:""===$("#menuFormPriceCash").val()?null:1*$("#menuFormPriceCash").val(),priceCard:""===$("#menuFormPriceCard").val()?null:1*$("#menuFormPriceCard").val(),priceMembership:""===$("#menuFormPriceMembersip").val()?null:1*$("#menuFormPriceMembership").val()};NMNS.socket.emit("update menu",i),(e=NMNS.menuList.find(function(e){return e.id===i.id})).name=i.name,e.priceCash=i.priceCash,e.priceCard=i.priceCard,e.priceMembership=i.priceMembership}else e={id:NMNS.email+generateRandom(),name:$("#menuFormName").val(),priceCash:""===$("#menuFormPriceCash").val()?null:1*$("#menuFormPriceCash").val(),priceCard:""===$("#menuFormPriceCard").val()?null:1*$("#menuFormPriceCard").val(),priceMembership:""===$("#menuFormPriceMembersip").val()?null:1*$("#menuFormPriceMembership").val()},NMNS.socket.emit("add menu",e),NMNS.menuList.push(e);$("#menuModal").modal("hide"),n(!0)}else showSnackBar("메뉴 이름을 입력해주세요.")})})),$("#updateMenuLink").on("touch click",function(){if($(".menuRow .updatingMenu-collapsed").toggleClass("d-none").toggleClass("d-block"),$(".updatingMenu-expanded").toggle(),$("#mainMenuTools .updatingMenu-collapsed").toggleClass("d-inline-flex"),$(".updatingMenu-collapsed").is(":visible"))$("#mainMenuList").data("sortable")&&$("#mainMenuList").data("sortable").option("disabled",!1),$(this).text("수정 완료");else{$("#mainMenuList").data("sortable")&&$("#mainMenuList").data("sortable").option("disabled",!0);var a=!1,n=[];$("#mainMenuList .menuRow").map(function(e,i){n.push(NMNS.menuList[1*i.getAttribute("data-index")]),"delete"===$(i).data("action")?(n[e].action="delete",a=!0):e!==1*i.getAttribute("data-index")&&(a=!0)}),a&&NMNS.socket.emit("update menu list",n),$(this).text("수정")}});var t=0;function r(e,i){for(var a,n="",t=e;t<i;t++)n+='<div class="menuRow col-12" data-index="'+t+'"><div class="col-3 px-0 font-weight-bold" style="font-size:14px">'+((a=NMNS.menuList[t]).name&&""!==a.name?a.name:"(이름없음)")+'</div><div class="col px-0 montserrat">'+(0!=a.priceCard&&a.priceCard?(a.priceCard+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):"-")+'</div><div class="col-3 px-0 montserrat">'+(0!=a.priceCash&&a.priceCash?(a.priceCash+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):"-")+'</div><div class="col-3 px-0 montserrat">'+(0!=a.priceMembership&&a.priceMembership?(a.priceMembership+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):"-")+'</div><div class="col-1 updatingMenu-collapsed d-none"><button type="button" class="deleteMenuLink close p-0 m-0" aria-label="삭제"><span aria-hidden="true">&times;</span></button></div><a class="menuModalLink" href="#" data-toggle="modal" data-target="#menuModal" title="상세보기"></a></div>';return n}function n(e){var i,a=$("#mainMenuList"),n="";NMNS.menuList&&e?(a.children(":not(.ps)").remove(),NMNS.menuList&&0<NMNS.menuList.length?n+=r(0,i=Math.min(0===t?t+Math.max(20,5+Math.ceil($("#mainMenuList").height()/48)-$("#mainMenuList .menuRow").length):t,NMNS.menuList.length)):n+="<p>아직 등록된 메뉴가 없습니다. 새로운 메뉴를 등록하여 고객의 매출내역을 기록, 관리해보세요!</p>"):NMNS.menuList&&(i=Math.min(t+Math.max(20,5+Math.ceil($("#mainMenuList").height()/48)-$("#mainMenuList .menuRow").length),NMNS.menuList.length),n+=r(t,i)),t=i,a.append($(n).on("touch click",".menuModalLink",function(e){e.preventDefault(),m(NMNS.menuList[1*$(this).parent().data("index")])}).on("touch click",".deleteMenuLink",function(e){e.stopPropagation(),$(this).parents(".menuRow").data("action","delete").hide()})),a.data("sortable")||a.data("sortable",Sortable.create(a[0],{animation:150,disabled:!0,forceFallback:!0}))}function m(e){$("#menuForm").data("origin",e),e?($("#menuFormName").val(e.name),$("#menuFormPriceCard").val(e.priceCard),$("#menuFormPriceCash").val(e.priceCash),$("#menuFormPriceMembership").val(e.priceMembership)):($("#menuFormName").val(""),$("#menuFormPriceCard").val(""),$("#menuFormPriceCash").val(""),$("#menuFormPriceMembership").val(""))}$("#createMenuLink").on("touch click",function(){m(null)}),NMNS.socket.on("update menu list",socketResponse("메뉴 리스트 수정",void 0,function(e){NMNS.menuList=e.data,n(!(t=0))})),NMNS.socket.on("add menu",socketResponse("메뉴 추가",function(e){NMNS.history.remove(e.data.id,findById)},function(i){var e=NMNS.menuList.findIndex(function(e){return e.id===i.data.id});Number.isInteger(e)&&-1<e&&(NMNS.menuList.splice(e,1),n(!0))})),NMNS.socket.on("update menu",socketResponse("메뉴 항목 수정",function(e){NMNS.history.remove(e.data.id,findById)},function(i){var e=NMNS.history.find(function(e){return e.id===i.data.id}),a=NMNS.menuList.findIndex(function(e){return e.id===i.data.id});Number.isInteger(a)&&-1<a&&(NMNS.menuList[a].priceCard=e.priceCard,NMNS.menuList[a].priceCash=e.priceCash,NMNS.menuList[a].name=e.name,NMNS.menuList[a].priceMembership=e.priceMembership,NMNS.history.remove(i.data.id,findById),n(!0))})),NMNS.menuList=[{id:1,name:"매니큐어",priceCash:1e4,priceCard:2e4,priceMembership:1e4},{id:2,name:"매니큐어2",priceCash:1e4,priceCard:2e4,priceMembership:1e4},{id:3,name:"매니큐어3",priceCash:1e4,priceCard:2e4,priceMembership:1e4},{id:4,name:"매니큐어4",priceCash:1e4,priceCard:2e4,priceMembership:1e4},{id:5,name:"매니큐어5",priceCash:1e4,priceCard:2e4,priceMembership:1e4},{id:6,name:"매니큐어6",priceCash:1e4,priceCard:2e4,priceMembership:1e4}],n(!0)}();