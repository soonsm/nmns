!function(){function r(t,e){for(var a,s=$("#customerMembershipList").data("item"),i="",o=t;o<e;o++)a=s[o],i+='<div class="customerMembership row col-12" data-index="'+o+'"><div class="d-flex col-12 px-0 mb-1"><div class="customerDetailTitle">날짜</div><div class="col pr-0 montserrat" title="'+moment(a.date,"YYYYMMDD").format("YYYY. MM. DD")+'">'+moment(a.date,"YYYYMMDD").format("YYYY. MM. DD")+'</div></div><div class="d-flex col-12 px-0 mb-1"><div class="customerDetailTitle">예약내용</div><div class="col pr-0" title="'+a.item+'">'+(a.item||"")+'</div></div><div class="d-flex col-12 px-0 mb-1"><div class="customerDetailTitle">증/감</div><div class="col pr-0 montserrat">'+("MEMBERSHIP_INCREMENT"===a.type||"MEMBERSHIP_ADD"===a.type?"+ ":"- ")+((a.membershipChange||"")+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+'</div></div><div class="d-flex col-12 px-0 mb-1"><div class="customerDetailTitle">잔액</div><div class="col pr-0 montserrat">'+((a.balanceMembership||"")+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+"</div></div></div>";return i}function a(t){var e,a=$("#customerMembershipList"),s=a.data("item"),i=a.data("index"),o="";if(!t&&i||(i=0),s&&t){if($("#customerMembershipLoading").hide(),a.children().remove(),!(0<s.length))return $("#customerMembershipList").hide(),void $("#customerMembershipEmpty").show();o=r(0,e=Math.min(0===i?i+Math.max(20,5+Math.ceil(a.height()/48)-a.find(".customerMembership").length):i,s.length))}else{if(!s)return $("#customerMembershipList").hide(),void $("#customerMembershipEmpty").show();o=r(i,e=Math.min(i+Math.max(20,5+Math.ceil(a.height()/48)-a.find(".customerMembership").length),s.length))}a.data("index",e).append(o),$("#customerMembershipEmpty").hide(),$("#customerMembershipList").show()}function c(t,e){for(var a,s=$("#customerAlrimList").data("item"),i="",o=t;o<e;o++)a=s[o],i+='<div class="customerAlrim col-12 montserrat" title="눌러서 전송된 알림톡 내용 보기"><a href="#customerAlrimDetail'+o+'" class="customerAlrimDetailLink collapsed" data-toggle="collapse" role="button" aria-expanded="false" aria-controls="customerAlrimDetail'+o+'"></a>'+moment(a.date,"YYYYMMDDHHmm").format("YYYY. MM. DD HH:mm")+'</div><div class="row customerAlrimDetail collapse mx-0 col-12" id="customerAlrimDetail'+o+'"><div>'+(a.contents?a.contents.replace(/\n/g,"<br>"):"")+"</div></div>";return i}function e(t){var e,a=$("#customerAlrimList"),s=a.data("item"),i=a.data("index"),o="";if(s&&t){if($("#customerAlrimLoading").hide(),a.children().remove(),!(0<s.length))return $("#customerAlrimNotEmpty").hide(),void $("#customerAlrimEmpty").show();o=c(0,e=Math.min(0===i?i+Math.max(20,5+Math.ceil(a.height()/48)-a.find(".customerAlrim").length):i,s.length))}else{if(!s)return $("#customerAlrimNotEmpty").hide(),void $("#customerAlrimEmpty").show();o=c(i,e=Math.min(i+Math.max(20,5+Math.ceil(a.height()/48)-a.find(".customerAlrim").length),s.length))}a.data("index",e).append(o).on("touch click",".customerAlrimDetailLink",function(){$(this).parent().toggleClass("active")}),$("#customerAlrimEmpty").hide(),$("#customerAlrimNotEmpty").show()}function n(t,e){for(var a,s,i,o,r=NMNS.calendar.getCalendars(),c=$("#customerScheduleList").data("item"),n="",l=t;l<e;l++){s=c[l],(a=r.find(function(t){return t.id===s.managerId}))||(a={color:"#334150",name:"(삭제된 담당자)"});try{i=JSON.parse(s.contents).map(function(t){return t.value}).join(", ")}catch(t){i=s.contents}n+='<div class="customerSchedule row col-12" data-index="'+l+'"><div class="d-flex col-12 px-0 mb-1"><div class="customerDetailTitle">날짜</div><div class="col pr-0 montserrat" title="'+(o=moment(s.start,"YYYYMMDDHHmm").format("YYYY. MM. DD HH:mm")+(s.end?moment(s.end,"YYYYMMDDHHmm").format(moment(s.start,"YYYYMMDDHHmm").isSame(moment(s.end,"YYYYMMDDHHmm"),"day")?" - HH:mm":" - YYYY. MM. DD HH:mm"):""))+'">'+o+'</div></div><div class="d-flex col-12 px-0 mb-1"><div class="customerDetailTitle">담당</div><div class="col pr-0"><span class="tui-full-calendar-weekday-schedule-bullet" style="background:'+a.color+'" title="'+a.name+'"></span>'+a.name+'</div></div><div class="d-flex col-12 px-0 mb-1"><div class="customerDetailTitle">예약내용</div><div class="col pr-0">'+(i||"")+'</div></div><div class="d-flex col-12 px-0 mb-1"><div class="customerDetailTitle">매출액</div><div class="col pr-0 montserrat">'+(s.sales?(s.sales+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):"-")+'</div></div><div class="d-flex col-12 px-0 mb-1"><div class="customerDetailTitle">예약상태</div><div class="col pr-0">'+("NOSHOW"==s.status?"노쇼":"CANCELED"===s.status||"CUSTOMERCANCELED"===s.status?"취소":"정상")+"</div></div></div>"}return n}function s(t){var e,a=$("#customerScheduleList"),s=a.data("item"),i=a.data("index"),o="";if(s&&t){if(a.children().remove(),!(0<s.length))return $("#customerScheduleNotEmpty").hide(),void $("#customerScheduleEmpty").show();o=n(0,e=Math.min(0===i?i+Math.max(20,5+Math.ceil(a.height()/48)-a.find(".customerSchedule").length):i,s.length))}else{if(!s)return $("#customerScheduleNotEmpty").hide(),void $("#customerScheduleEmpty").show();o=n(i,e=Math.min(i+Math.max(20,5+Math.ceil(a.height()/48)-a.find(".customerSchedule").length),s.length))}a.data("index",e).append(o),$("#customerScheduleEmpty").hide(),$("#customerScheduleNotEmpty").show()}$("#mainContents").append('<div id="customerDetailMenu" class="switchingMenu customerDetailMenu">    <div class="d-flex horizontalTab">      <div class="row col-12">        <ul id="customerTabList" class="nav nav-pills nowrap" role="tabList" style="display:inline-flex !important;height:51px;padding-right:20px">          <li class="nav-item" style="display:inline-flex !important"><a class="nav-link pt-0 rounded-0 active" href="#customerInfo" data-toggle="tab" aria-selected="true" aria-label="고객 정보">고객 정보</a></li>          <li class="nav-item" style="display:inline-flex !important"><a class="nav-link pt-0 rounded-0" href="#customerSchedule" data-toggle="tab" aria-label="예약 내역">예약 내역</a></li>          <li class="nav-item" style="display:inline-flex !important"><a class="nav-link pt-0 rounded-0" href="#customerAlrim" data-toggle="tab" aria-label="알림톡 내역">알림톡 내역</a></li>          <li class="nav-item" style="display:inline-flex !important"><a class="nav-link pt-0 rounded-0" href="#customerMembership" data-toggle="tab" aria-label="멤버십 금액 내역">멤버십 금액 내역</a></li>        </ul>      </div>    </div>    <div class="menuContents px-3">      <div class="row mx-0 col-12 tab-content p-0">                      <div id="customerInfo" class="tab-pane col-12 px-0 fade show active" role="tabpanel" style="font-size:15px;padding-top:35px">          <div class="row mx-0 hasBottomArea">            <div id="customerNoShow" class="col-12 px-0" style="margin-bottom:35px">총 <span id="customerNoShowCount" class="montserrat text-accent ml-1" style="font-weight:500">0</span>건의 노쇼 이력이 있는 고객님이에요.</div>            <div>고객 이름</div>            <input type="text" class="form-control form-control-sm mt-3" id="customerName" placeholder="고객 이름을 입력해주세요." style="margin-bottom:35px">            <div>고객 연락처</div>            <input type="tel" class="form-control form-control-sm mt-3 montserrat" id="customerContact" placeholder="고객 연락처를 입력해주세요." style="margin-bottom:35px">            <div>담당자</div>            <div class="col-12 px-0" style="margin-bottom:35px">              <button id="customerManager" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="btn btn-sm dropdown-toggle btn-flat form-control form-control-sm text-left mt-3" aria-label="담당자">                <span>선택</span>              </button>              <div class="dropdown-menu" aria-labelledby="customerManager" role="menu" id="customerManagerList" style="right:0"></div>            </div>            <div>고객메모</div>            <div class="col-12 px-0" style="margin-bottom:35px"><input type="text" id="customerEtc" class="form-control form-control-sm mt-3" placeholder="고객 메모를 입력해주세요."></div>            <div class="d-flex col-12 px-0">              <div class="customerTitle">멤버십 잔액</div>              <div class="ml-auto"><span id="customerBalanceMembership" class="montserrat mr-1">0</span>원</div>            </div>            <div class="d-flex col-12 px-0" style="margin-bottom:20px">              <div class="customerTitle">총 매출액</div>              <div class="ml-auto"><span id="customerTotalSales" class="montserrat mr-1">0</span>원</div>            </div>          </div>          <div class="bottomButtonArea">            <button type="button" class="btn btn-white col mr-1" id="closeCustomerModal">취소</button>            <button id="customerBtn" type="button" class="btn btn-accent col ml-1">저장</button>          </div>        </div>                <div id="customerSchedule" class="tab-pane col-12 px-0 fade" role="tabpanel" style="padding-top:20px">          <div id="customerScheduleNotEmpty" class="row mx-0 flex-column">            <div class="col-12 position-relative">              <button id="customerScheduleSortTypeMenu" type="button" class="btn btn-flat dropdown-toggle ml-auto d-flex pr-0" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="예약 내역 정렬하기" data-action="sort-date">날짜</button>              <div class="dropdown-menu dropdown-menu-right text-center" aria-labelledby="customerScheduleSortTypeMenu">                <a class="customerScheduleSortType dropdown-item active" href="#" data-action="sort-date" aria-label="날짜">날짜</a>                <a class="customerScheduleSortType dropdown-item" href="#" data-action="sort-manager" aria-label="담당">담당</a>                <a class="customerScheduleSortType dropdown-item" href="#" data-action="sort-sales" aria-label="매출액">매출액</a>                <a class="customerScheduleSortType dropdown-item" href="#" data-action="sort-status" aria-label="예약 상태">예약 상태</a>              </div>            </div>            <div class="row mx-0 col-12 px-0" id="customerScheduleList"></div>          </div>          <div id="customerScheduleEmpty" style="display:none;margin-top:-35px">예약 내역이 없어요.</div>        </div>                <div id="customerAlrim" class="tab-pane col-12 px-0 fade" role="tabpanel" style="padding:20px 0">          <div id="customerAlrimNotEmpty" class="row mx-0 flex-column">            <div id="customerAlrimList" class="row"></div>          </div>          <div id="customerAlrimLoading" class="flex-column">            <div class="bouncingLoader">              <div></div>              <div></div>              <div></div>            </div>             <span>알림톡 내역을 불러오는 중입니다...</span>          </div>          <div id="customerAlrimEmpty" style="display:none">알림톡 내역이 없어요.</div>        </div>                <div id="customerMembership" class="tab-pane col-12 px-0 fade" role="tabpanel">          <div class="row mx-0" id="customerMembershipList"></div>          <div id="customerMembershipEmpty" style="text-align:center;padding:30px;display:none">멤버십 내역이 없어요.</div>          <div id="customerMembershipLoading" class="flex-column text-center">            <div class="bouncingLoader">              <div></div>              <div></div>              <div></div>            </div>             <span>멤버십 내역을 불러오는 중입니다...</span>          </div>        </div>              </div>    </div>  </div>'),Inputmask("999-999[9]-9999",{showMaskOnFocus:!1,showMaskOnHover:!1,autoUnmask:!0,placeholder:""}).mask("#customerContact");var i=0;function o(t,e){for(var a,s,i=NMNS.calendar.getCalendars(),o="",r=t;r<e;r++)s=NMNS.customerList[r],(a=i.find(function(t){return t.id===s.managerId}))||(a={color:"#334150",name:"(삭제된 담당자)"}),o+='<div class="customer col-12" data-index="'+r+'"><div class="col-12 px-0 position-relative d-flex align-items-center"><div class="font-weight-bold" style="font-size:14px">'+(s.name&&""!==s.name?s.name:"(이름없음)")+"</div>"+(s.contact&&""!==s.contact?'<span class="divider" style="display:inline-table">&nbsp;</span><div class="montserrat">'+dashContact(s.contact,".")+"</div>":"")+'<span class="tui-full-calendar-weekday-schedule-bullet" style="background:'+a.color+'" title="'+a.name+'"></span></div><div class="col-6 px-0 d-flex"><div class="col-4 px-0 customerSubHead">방문</div><div class="col-8 pr-0"><span class="montserrat">'+(s.history?s.history.length:"0")+'</span>회</div></div><div class="col-6 px-0 d-flex"><div class="col-5 px-0 customerSubHead">마지막 방문</div><div class="col-7 pr-0 montserrat">'+(s.history&&0<s.history.length?moment(s.history[0].start,"YYYYMMDDHHmm").format("YYYY. MM. DD"):"-")+'</div></div><div class="col-6 px-0 d-flex"><div class="col-4 px-0 customerSubHead">매출액</div><div class="col-8 pr-0 montserrat">'+(s.cardSales+s.cashSales?(s.cardSales+s.cashSales+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):"-")+'</div></div><div class="col-6 px-0 d-flex"><div class="col-5 px-0 customerSubHead">멤버십 잔액</div><div class="col-7 pr-0 montserrat">'+(s.pointMembership?(s.pointMembership+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):"-")+"</div></div>"+(s.etc&&""!==s.etc?'<hr/><div class="col-12 px-0 customerSubHead">'+s.etc+"</div>":"")+'<a class="customerModalLink" href="#" title="상세보기"></a></div>';return o}function l(t){var e,a=$("#mainCustomerList"),s="";NMNS.customerList&&t?(a.children(":not(.ps)").remove(),NMNS.customerList&&0<NMNS.customerList.length?s+=o(0,e=Math.min(0===i?i+Math.max(20,5+Math.ceil($("#mainCustomerList").height()/48)-$("#mainCustomerList .customer").length):i,NMNS.customerList.length)):s+="<p class='m-auto'>아직 등록된 고객이 없습니다.<br>새로운 고객을 등록하여 방문 및 매출내역을<br>기록, 관리해보세요!</p>"):NMNS.customerList&&(e=Math.min(i+Math.max(20,5+Math.ceil($("#mainCustomerList").height()/48)-$("#mainCustomerList .customer").length),NMNS.customerList.length),s+=o(i,e)),i=e,$("#customerCount").text(NMNS.customerList.length),a.append(s),a.find(".customerModalLink").off("touch click").on("touch click",function(t){t.preventDefault(),function(t){if(t){var e=NMNS.customerList[Number(t.parent().data("index"))];$("#customerName").val(e.name),$("#customerContact").val(e.contact),$("#customerEtc").val(e.etc),0===e.totalNoShow?$("#customerNoShow").hide():$("#customerNoShowCount").text(e.totalNoShow).parent().show(),$("#customerBalanceMembership").text((e.pointMembership+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")),$("#customerTotalSales").text((e.cardSales+e.cashSales+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"));var a=NMNS.calendar.getCalendars().find(function(t){return t.id===e.managerId});a||(a={color:"#334150",name:"(삭제된 담당자)"}),$("#customerManager").data("calendar-id",a.id).data("color",a.color).html(a.id?$("#customerManagerList button[data-calendar-id='"+a.id+"']").html():'<span class="tui-full-calendar-icon tui-full-calendar-calendar-dot mr-3" style="background-color: #334150"></span><span class="tui-full-calendar-content">(삭제된 담당자)</span>'),$(".addCustomerScheduleBtn").show(),$("#customerTabList a[href='#customerInfo']").text("고객 상세").tab("show"),$("#customerDetailMenu").data("customer",e)}}($(this)),NMNS.switchMenu.call($(".customerDetailLink"),t)})}function d(t){switch(t){case"sort-start":return function(t,e){return t.start?e.start?t.start<e.start?-1:t.start>e.start?1:d("sort-name")(t,e):-1:e.start?1:d("sort-name")(t,e)};case"sort-date":return function(t,e){return t.history&&0!==t.history.length?e.history&&0!==e.history.length?t.history[0].start<e.history[0].start?1:t.history[0].start>e.history[0].start?-1:d("sort-name")(t,e):-1:e.history&&0<e.history.length?1:d("sort-name")(t,e)};case"sort-manager":return function(t,e){return t.manager?e.manager?t.manager.name<e.manager.name?-1:t.manager.name>e.manager.name?1:d("sort-name")(t,e):-1:e.manager?1:d("sort-name")(t,e)};case"sort-sales":return function(t,e){return t.sales?e.sales?1*t.sales<1*e.sales?-1:1*t.sales>1*e.sales?1:d("sort-name")(t,e):-1:e.sales?1:d("sort-name")(t,e)};case"sort-membership":return function(t,e){return t.membership?e.membership?1*t.membership<1*e.membership?-1:1*t.membership>1*e.membership?1:d("sort-name")(t,e):-1:e.membership?1:d("sort-name")(t,e)};case"sort-visit":return function(t,e){return t.history&&0!==t.history.length?e.history&&0!==e.history.length?t.history.length<e.history.length?-1:t.history.length>e.history.length?1:d("sort-name")(t,e):-1:e.history&&0<e.history.length?1:d("sort-name")(t,e)};case"sort-status":return function(t,e){return t.status?e.status?t.status<e.status?-1:t.status>e.status?1:d("sort-name")(t,e):-1:e.status?1:d("sort-name")(t,e)};case"sort-name":default:return function(t,e){return t.name?e.name?t.name<e.name?-1:t.name>e.name?1:0:-1:e.name?1:0}}}NMNS.socket.on("get customer list",socketResponse("고객 조회",function(t){if(NMNS.customerList=t.data,t.data&&0<t.data.length){var a=NMNS.calendar.getCalendars();t.data.forEach(function(e){e.manager=a[a.findIndex(function(t){return t.id===e.managerId})]})}l(!(i=0))})),NMNS.socket.on("update customer",socketResponse("고객정보 수정",function(e){var t=NMNS.customerList.findIndex(function(t){return t.id===e.data.id});if(Number.isInteger(t)&&-1<t){var a=NMNS.customerList[t];a.name=$("#customerName").val(),a.contact=$("#customerContact").val().replace(/-/gi,""),a.etc=$("#customerEtc").val(),a.managerId=$("#customerManager").data("calendar-id");var s=NMNS.calendar.getCalendars();a.manager=s[s.findIndex(function(t){return t.id===a.managerId})],showSnackBar("<span>고객의 정보를 수정하였습니다.</span>"),l(!0)}},function(e){if("DUPLICATED"===e.data.reason){if(confirm("이미 같은 이름과 연락처를 가진 고객이 존재합니다.\n그 고객쪽으로 모든 정보 및 예약, 알림톡 내역을 합칠까요?"))return void NMNS.socket.emit("merge customer",{id:e.data.id,name:$("#customerName").val(),contact:$("#customerContact").val().replace(/-/gi,""),etc:$("#customerEtc").val(),managerId:$("#customerManager").data("calendar-id")})}else alert("고객정보 수정에 실패하였습니다."+(e.message?"("+e.message+")":""));var t=NMNS.customerList.findIndex(function(t){return t.id===e.data.id});Number.isInteger(t)&&-1<t&&($("#customerName").val(NMNS.customerList[t].name),$("#customerContact").val(NMNS.customerList[t].contact),$("#customerEtc").val(NMNS.customerList[t].etc))},!0)),NMNS.socket.on("get customer alrim",socketResponse("알림톡 내역 조회",function(t){t.data=[{date:"20190101123059",contents:"알림톡내용입니다.알림톡내용입니다.알림톡내용입니다.알림톡내용입니다.알림톡내용입니다.알림톡내용입니다.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"},{date:"20190201123059",contents:"알림톡내용입니다.알림톡내용입니다.알림톡내용입니다.알림톡내용입니다.알림톡내용입니다.알림톡내용입니다.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"},{date:"20190301123059",contents:"1123123알림톡내용입니다.알림톡내용입니다.알림톡내용입니다.알림톡내용입니다.알림톡내용입니다.알림톡내용입니다.aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"}],$("#customerAlrimList").data("index",0).data("item",t.data),e(!0)})),NMNS.socket.on("delete customer",socketResponse("고객 삭제",function(t){NMNS.history.remove(t.data.id,function(t,e){return t.id===e})},function(e){var t=NMNS.history.find(function(t){return t.id===e.data.id});NMNS.history.remove(e.data.id,function(t,e){return t.id===e}),NMNS.customerList.splice(t.index,0,t),l(!0)})),NMNS.socket.on("merge customer",socketResponse("고객정보 합치기",function(){NMNS.socket.emit("get customer list",{type:"all",target:""===$("#customerSearchTarget").val()?void 0:$("#customerSearchTarget").val(),sort:$($(".customerSortType.active")[0]).data("action")}),showSnackBar("<span>두 고객의 정보와 예약, 알림톡 내역을 합쳤습니다.</span>"),history.back()},function(){NMNS.socket.emit("get customer list",{type:"all",target:""===$("#customerSearchTarget").val()?void 0:$("#customerSearchTarget").val(),sort:$($(".customerSortType.active")[0]).data("action")}),history.back()})),NMNS.socket.on("get membership history",socketResponse("멤버십 내역 조회",function(t){t.data=[{date:"20190101123050",item:"예약내용입니다 예약내용입니다.",balanceMembership:1e4,type:"MEMBERSHIP_ADD",membershipChange:1e3},{date:"20190103123050",item:"예약내용입니다 예약내용입니다.",balanceMembership:1e4,type:"MEMBERSHIP_DECREMENT",membershipChange:1e3}],$("#customerMembershipList").data("index",0).data("item",t.data),a(!0)})).on("add membership",socketResponse("멤버십 내역 변경",function(t){$("#customerMembershipList .customerMembership[data-id='"+t.data.id+"'] .balanceMembership").text(((t.data.balanceMembership||"")+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"))},function(e){var t=$("#customerMembershipList").data("item");t.splice(t.findIndex(function(t){return t.id===e.data.id}),1),a(!0)})),$("#customerBtn").on("touch click",function(t){if(t.preventDefault(),""!==$("#customerName").val()||""!==$("#customerContact").val().replace(/-/gi,""))if(0<$("#customerInfo input:invalid").length)alert("입력하신 고객 정보를 확인해주세요.");else{var e=$("#customerDetailMenu").data("customer");e&&NMNS.socket.emit("update customer",{id:e.id,name:$("#customerName").val(),contact:$("#customerContact").val().replace(/-/gi,""),etc:$("#customerEtc").val(),managerId:$("#customerManager").data("calendar-id")}),history.back()}else alert("고객 이름과 전화번호 중 하나는 반드시 입력해주세요.")}),$("#closeCustomerModal").on("touch click",function(){history.back()}),$("#customerTabList a[href='#customerAlrim']").on("show.bs.tab",function(){$(this).data("id")!==$("#customerDetailMenu").data("customer").id&&($(this).data("id",$("#customerDetailMenu").data("customer").id),$("#customerAlrimNotEmpty").hide(),$("#customerAlrimEmpty").hide(),$("#customerAlrimLoading").show(),NMNS.socket.emit("get customer alrim",{id:$("#customerDetailMenu").data("customer").id}))}).one("show.bs.tab",function(){var t=!1;$("#customerAlrimList").on("scroll",debounce(function(){!t&&$(this).data("item")&&$(this).data("index")<$(this).data("item").length&&this.scrollHeight-this.scrollTop-this.offsetHeight<Math.max(100,.2*this.getBoundingClientRect().height)&&(t=!0,e(),t=!1)},200))}),$("#customerTabList a[href='#customerSchedule']").on("show.bs.tab",function(){if($(this).data("id")!==$("#customerDetailMenu").data("customer").id){var t=$("#customerDetailMenu").data("customer");$(this).data("id",t.id),t.history=[{start:"20190101123059",end:"20190201123050",contents:"테스트 내용입니다.ㅎㅎ",manager:"aaa",status:"NOSHOW",sales:1e4},{start:"20190103123059",end:"20190203123050",contents:"테스트 내용입니다.ㅎㅎㅎ",manager:"aaa",status:"RESERVED",sales:1e5}],t.history&&0!==t.history.length?($("#customerScheduleNotEmpty").show(),$("#customerScheduleEmpty").hide(),$("#customerScheduleList").data("index",0).data("item",t.history).html(s(!0))):($("#customerScheduleNotEmpty").hide(),$("#customerScheduleEmpty").show())}}).one("show.bs.tab",function(){$("#customerScheduleSortTypeMenu").next().children("a").on("touch click",function(t){t.preventDefault();var e=$(t.target);e.hasClass("dropdown-item")||(e=e.parents(".dropdown-item")),$("#customerScheduleSortTypeMenu").data("action")===e.data("action")?$("#customerScheduleList").data("item").reverse():($("#customerScheduleSortTypeMenu").html(e.html()).data("action",e.data("action")),$("#customerScheduleList").data("item").sort(d(e.data("action"))),$(".customerScheduleSortType").removeClass("active"),$(".customerScheduleSortType[data-action='"+e.data("action")+"']").addClass("active")),$("#customerScheduleList").data("index",0),s(!0)});var t=!1;$("#customerScheduleList").on("scroll",debounce(function(){!t&&$(this).data("item")&&$(this).data("index")<$(this).data("item").length&&this.scrollHeight-this.scrollTop-this.offsetHeight<Math.max(100,.2*this.getBoundingClientRect().height)&&(t=!0,s(),t=!1)},200))}),$("#customerTabList a[href='#customerMembership']").on("show.bs.tab",function(){if($(this).data("id")!==$("#customerDetailMenu").data("customer").id){var t=$("#customerDetailMenu").data("customer").id;$(this).data("id",t),$("#customerMembershipList").hide(),$("#customerMembershipEmpty").hide(),$("#customerMembershipLoading").show(),NMNS.socket.emit("get membership history",{customerId:t})}}),$("#customerSortTypeMenu").next().children("a").on("touch click",function(t){t.preventDefault();var e=$(t.target);e.hasClass("dropdown-item")||(e=e.parents(".dropdown-item")),$("#customerSortTypeMenu").data("action")===e.data("action")?NMNS.customerList.reverse():($("#customerSortTypeMenu").html(e.html()).data("action",e.data("action")),NMNS.customerList.sort(d(e.data("action")))),l(!(i=0))}),$("#searchCustomer").on("keyup",function(t){13===t.which&&NMNS.socket.emit("get customer list",{type:"all",target:this.value,sort:$("#customerSortTypeMenu").data("action")})});var t=!1;$(document).on("scroll",debounce(function(){$("#mainCustomerList").is(":visible")&&!t&&NMNS.customerList&&i<NMNS.customerList.length&&Math.max(document.body.scrollHeight-window.innerHeight-window.scrollY,0)<Math.max(100,.2*window.innerHeight)&&(t=!0,$("#mainCustomerLoading").show(),l(),$("#mainCustomerLoading").hide(),t=!1)},100))}();