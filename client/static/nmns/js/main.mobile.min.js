!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Siema",[],t):"object"==typeof exports?exports.Siema=t():e.Siema=t()}("undefined"!=typeof self?self:this,function(){return o={},n.m=a=[function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=(function(e,t,a){return t&&s(e.prototype,t),a&&s(e,a),e}(i,[{key:"attachEvents",value:function(){window.addEventListener("resize",this.resizeHandler),this.config.draggable&&(this.pointerDown=!1,this.drag={startX:0,endX:0,startY:0,letItGo:null,preventClick:!1},this.selector.addEventListener("touchstart",this.touchstartHandler),this.selector.addEventListener("touchend",this.touchendHandler),this.selector.addEventListener("touchmove",this.touchmoveHandler),this.selector.addEventListener("mousedown",this.mousedownHandler),this.selector.addEventListener("mouseup",this.mouseupHandler),this.selector.addEventListener("mouseleave",this.mouseleaveHandler),this.selector.addEventListener("mousemove",this.mousemoveHandler),this.selector.addEventListener("click",this.clickHandler))}},{key:"detachEvents",value:function(){window.removeEventListener("resize",this.resizeHandler),this.selector.removeEventListener("touchstart",this.touchstartHandler),this.selector.removeEventListener("touchend",this.touchendHandler),this.selector.removeEventListener("touchmove",this.touchmoveHandler),this.selector.removeEventListener("mousedown",this.mousedownHandler),this.selector.removeEventListener("mouseup",this.mouseupHandler),this.selector.removeEventListener("mouseleave",this.mouseleaveHandler),this.selector.removeEventListener("mousemove",this.mousemoveHandler),this.selector.removeEventListener("click",this.clickHandler)}},{key:"init",value:function(){this.innerElements=[].slice.call(this.selector.children),this.currentSlide=this.config.loop?this.config.startIndex%this.innerElements.length:Math.max(0,Math.min(this.config.startIndex,this.innerElements.length-this.perPage)),this.attachEvents(),this.selector.style.overflow="hidden",this.selector.style.direction=this.config.rtl?"rtl":"ltr",this.buildSliderFrame(),this.config.onInit.call(this)}},{key:"buildSliderFrame",value:function(){var e=this.selectorWidth/this.perPage,t=this.config.loop?this.innerElements.length+2*this.perPage:this.innerElements.length;this.sliderFrame=document.createElement("div"),this.sliderFrame.style.width=e*t+"px",this.enableTransition(),this.config.draggable&&(this.selector.style.cursor="-webkit-grab");var a=document.createDocumentFragment();if(this.config.loop)for(var n=this.innerElements.length-this.perPage;n<this.innerElements.length;n++){var o=this.buildSliderFrameItem(this.innerElements[n].cloneNode(!0));a.appendChild(o)}for(var i=0;i<this.innerElements.length;i++){var s=this.buildSliderFrameItem(this.innerElements[i]);a.appendChild(s)}if(this.config.loop)for(var r=0;r<this.perPage;r++){var l=this.buildSliderFrameItem(this.innerElements[r].cloneNode(!0));a.appendChild(l)}this.sliderFrame.appendChild(a),this.selector.innerHTML="",this.selector.appendChild(this.sliderFrame),this.slideToCurrent()}},{key:"buildSliderFrameItem",value:function(e){var t=document.createElement("div");return t.style.cssFloat=this.config.rtl?"right":"left",t.style.float=this.config.rtl?"right":"left",t.style.width=(this.config.loop?100/(this.innerElements.length+2*this.perPage):100/this.innerElements.length)+"%",t.appendChild(e),t}},{key:"resolveSlidesNumber",value:function(){if("number"==typeof this.config.perPage)this.perPage=this.config.perPage;else if("object"===n(this.config.perPage))for(var e in this.perPage=1,this.config.perPage)window.innerWidth>=e&&(this.perPage=this.config.perPage[e])}},{key:"prev",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=arguments[1];if(!(this.innerElements.length<=this.perPage)){var a=this.currentSlide;if(this.config.loop)if(this.currentSlide-e<0){this.disableTransition();var n=this.currentSlide+this.innerElements.length,o=n+this.perPage,i=(this.config.rtl?1:-1)*o*(this.selectorWidth/this.perPage),s=this.config.draggable?this.drag.endX-this.drag.startX:0;this.sliderFrame.style[this.transformProperty]="translate3d("+(i+s)+"px, 0, 0)",this.currentSlide=n-e}else this.currentSlide=this.currentSlide-e;else this.currentSlide=Math.max(this.currentSlide-e,0);a!==this.currentSlide&&(this.slideToCurrent(this.config.loop),this.config.onChange.call(this),t&&t.call(this))}}},{key:"next",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=arguments[1];if(!(this.innerElements.length<=this.perPage)){var a=this.currentSlide;if(this.config.loop)if(this.currentSlide+e>this.innerElements.length-this.perPage){this.disableTransition();var n=this.currentSlide-this.innerElements.length,o=n+this.perPage,i=(this.config.rtl?1:-1)*o*(this.selectorWidth/this.perPage),s=this.config.draggable?this.drag.endX-this.drag.startX:0;this.sliderFrame.style[this.transformProperty]="translate3d("+(i+s)+"px, 0, 0)",this.currentSlide=n+e}else this.currentSlide=this.currentSlide+e;else this.currentSlide=Math.min(this.currentSlide+e,this.innerElements.length-this.perPage);a!==this.currentSlide&&(this.slideToCurrent(this.config.loop),this.config.onChange.call(this),t&&t.call(this))}}},{key:"disableTransition",value:function(){this.sliderFrame.style.webkitTransition="all 0ms "+this.config.easing,this.sliderFrame.style.transition="all 0ms "+this.config.easing}},{key:"enableTransition",value:function(){this.sliderFrame.style.webkitTransition="all "+this.config.duration+"ms "+this.config.easing,this.sliderFrame.style.transition="all "+this.config.duration+"ms "+this.config.easing}},{key:"goTo",value:function(e,t){if(!(this.innerElements.length<=this.perPage)){var a=this.currentSlide;this.currentSlide=this.config.loop?e%this.innerElements.length:Math.min(Math.max(e,0),this.innerElements.length-this.perPage),a!==this.currentSlide&&(this.slideToCurrent(),this.config.onChange.call(this),t&&t.call(this))}}},{key:"slideToCurrent",value:function(e){var t=this,a=this.config.loop?this.currentSlide+this.perPage:this.currentSlide,n=(this.config.rtl?1:-1)*a*(this.selectorWidth/this.perPage);e?requestAnimationFrame(function(){requestAnimationFrame(function(){t.enableTransition(),t.sliderFrame.style[t.transformProperty]="translate3d("+n+"px, 0, 0)"})}):this.sliderFrame.style[this.transformProperty]="translate3d("+n+"px, 0, 0)"}},{key:"updateAfterDrag",value:function(){var e=(this.config.rtl?-1:1)*(this.drag.endX-this.drag.startX),t=Math.abs(e),a=this.config.multipleDrag?Math.ceil(t/(this.selectorWidth/this.perPage)):1,n=0<e&&this.currentSlide-a<0,o=e<0&&this.currentSlide+a>this.innerElements.length-this.perPage;0<e&&t>this.config.threshold&&this.innerElements.length>this.perPage?this.prev(a):e<0&&t>this.config.threshold&&this.innerElements.length>this.perPage&&this.next(a),this.slideToCurrent(n||o)}},{key:"resizeHandler",value:function(){this.resolveSlidesNumber(),this.currentSlide+this.perPage>this.innerElements.length&&(this.currentSlide=this.innerElements.length<=this.perPage?0:this.innerElements.length-this.perPage),this.selectorWidth=this.selector.offsetWidth,this.buildSliderFrame()}},{key:"clearDrag",value:function(){this.drag={startX:0,endX:0,startY:0,letItGo:null,preventClick:this.drag.preventClick}}},{key:"touchstartHandler",value:function(e){-1!==["TEXTAREA","OPTION","INPUT","SELECT"].indexOf(e.target.nodeName)||(e.stopPropagation(),this.pointerDown=!0,this.drag.startX=e.touches[0].pageX,this.drag.startY=e.touches[0].pageY)}},{key:"touchendHandler",value:function(e){e.stopPropagation(),this.pointerDown=!1,this.enableTransition(),this.drag.endX&&this.updateAfterDrag(),this.clearDrag()}},{key:"touchmoveHandler",value:function(e){if(e.stopPropagation(),null===this.drag.letItGo&&(this.drag.letItGo=Math.abs(this.drag.startY-e.touches[0].pageY)<Math.abs(this.drag.startX-e.touches[0].pageX)),this.pointerDown&&this.drag.letItGo){e.preventDefault(),this.drag.endX=e.touches[0].pageX,this.sliderFrame.style.webkitTransition="all 0ms "+this.config.easing,this.sliderFrame.style.transition="all 0ms "+this.config.easing;var t=(this.config.loop?this.currentSlide+this.perPage:this.currentSlide)*(this.selectorWidth/this.perPage),a=this.drag.endX-this.drag.startX,n=this.config.rtl?t+a:t-a;this.sliderFrame.style[this.transformProperty]="translate3d("+(this.config.rtl?1:-1)*n+"px, 0, 0)"}}},{key:"mousedownHandler",value:function(e){-1!==["TEXTAREA","OPTION","INPUT","SELECT"].indexOf(e.target.nodeName)||(e.preventDefault(),e.stopPropagation(),this.pointerDown=!0,this.drag.startX=e.pageX)}},{key:"mouseupHandler",value:function(e){e.stopPropagation(),this.pointerDown=!1,this.selector.style.cursor="-webkit-grab",this.enableTransition(),this.drag.endX&&this.updateAfterDrag(),this.clearDrag()}},{key:"mousemoveHandler",value:function(e){if(e.preventDefault(),this.pointerDown){"A"===e.target.nodeName&&(this.drag.preventClick=!0),this.drag.endX=e.pageX,this.selector.style.cursor="-webkit-grabbing",this.sliderFrame.style.webkitTransition="all 0ms "+this.config.easing,this.sliderFrame.style.transition="all 0ms "+this.config.easing;var t=(this.config.loop?this.currentSlide+this.perPage:this.currentSlide)*(this.selectorWidth/this.perPage),a=this.drag.endX-this.drag.startX,n=this.config.rtl?t+a:t-a;this.sliderFrame.style[this.transformProperty]="translate3d("+(this.config.rtl?1:-1)*n+"px, 0, 0)"}}},{key:"mouseleaveHandler",value:function(e){this.pointerDown&&(this.pointerDown=!1,this.selector.style.cursor="-webkit-grab",this.drag.endX=e.pageX,this.drag.preventClick=!1,this.enableTransition(),this.updateAfterDrag(),this.clearDrag())}},{key:"clickHandler",value:function(e){this.drag.preventClick&&e.preventDefault(),this.drag.preventClick=!1}},{key:"remove",value:function(e,t){if(e<0||e>=this.innerElements.length)throw new Error("Item to remove doesn't exist ğŸ˜­");var a=e<this.currentSlide,n=this.currentSlide+this.perPage-1===e;(a||n)&&this.currentSlide--,this.innerElements.splice(e,1),this.buildSliderFrame(),t&&t.call(this)}},{key:"insert",value:function(e,t,a){if(t<0||t>this.innerElements.length+1)throw new Error("Unable to inset it at this index ğŸ˜­");if(-1!==this.innerElements.indexOf(e))throw new Error("The same item in a carousel? Really? Nope ğŸ˜­");var n=0<(t<=this.currentSlide)&&this.innerElements.length;this.currentSlide=n?this.currentSlide+1:this.currentSlide,this.innerElements.splice(t,0,e),this.buildSliderFrame(),a&&a.call(this)}},{key:"prepend",value:function(e,t){this.insert(e,0),t&&t.call(this)}},{key:"append",value:function(e,t){this.insert(e,this.innerElements.length+1),t&&t.call(this)}},{key:"destroy",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=arguments[1];if(this.detachEvents(),this.selector.style.cursor="auto",e){for(var a=document.createDocumentFragment(),n=0;n<this.innerElements.length;n++)a.appendChild(this.innerElements[n]);this.selector.innerHTML="",this.selector.appendChild(a),this.selector.removeAttribute("style")}t&&t.call(this)}}],[{key:"mergeSettings",value:function(e){var t={selector:".siema",duration:200,easing:"ease-out",perPage:1,startIndex:0,draggable:!0,multipleDrag:!0,threshold:20,loop:!1,rtl:!1,onInit:function(){},onChange:function(){}},a=e;for(var n in a)t[n]=a[n];return t}},{key:"webkitOrNot",value:function(){return"string"==typeof document.documentElement.style.transform?"transform":"WebkitTransform"}}]),i);function i(e){var t=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.config=i.mergeSettings(e),this.selector="string"==typeof this.config.selector?document.querySelector(this.config.selector):this.config.selector,null===this.selector)throw new Error("Something wrong with your selector ğŸ˜­");this.resolveSlidesNumber(),this.selectorWidth=this.selector.offsetWidth,this.transformProperty=i.webkitOrNot(),["resizeHandler","touchstartHandler","touchendHandler","touchmoveHandler","mousedownHandler","mouseupHandler","mouseleaveHandler","mousemoveHandler","clickHandler"].forEach(function(e){t[e]=t[e].bind(t)}),this.init()}function s(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.default=o,e.exports=t.default}],n.c=o,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0);function n(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return a[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}var a,o}),function(u){if(document.documentMode){var e,t=navigator.userAgent.toLowerCase();if("Microsoft Internet Explorer"==navigator.appName?e="msie ":-1<t.search("trident")?e="trident/.*rv:":-1<t.search("edge/")&&(e="edge/"),null!==new RegExp(e+"([0-9]{1,})(\\.{0,}[0-9]{0,1})").exec(t)&&parseFloat(RegExp.$1+RegExp.$2)<10&&!confirm("ì˜¤ë˜ëœ IE"+parseFloat(RegExp.$1+RegExp.$2)+" ë¸Œë¼ìš°ì €ë¥¼ ì‚¬ìš©í•˜ê³  ê³„ì‹­ë‹ˆë‹¤.\n ê³„ì†í•˜ì‹œë©´ í˜ì´ì§€ê°€ ì •í™•íˆ í‘œì‹œë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ë„ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n *WA:SHOWëŠ” IE10 ì´ìƒì˜ ë¸Œë¼ìš°ì €ë¥¼ ì§€ì›í•˜ê³ ,\nChrome ë¸Œë¼ìš°ì €ì— ìµœì í™”ë˜ì–´ìˆìŠµë‹ˆë‹¤."))return location.href="/signout"}function a(t){var e="task"===t.category?"ì¼ì •":"ì˜ˆì•½",a="",n=null;if(t.raw.contents)try{n=JSON.parse(t.raw.contents).map(function(e){return e.value}).join(", ")}catch(e){n=t.raw.contents}return a+="<div class='tui-full-calendar-schedule-cover'><div><div class='row align-items-center' style='margin-bottom:5px'><div class='row mx-0 col'>",a+="<div title='"+e+"ë‚´ìš©:"+(n||"")+"' class='tui-full-calendar-time-schedule-title'>"+(n||"(ì˜ˆì•½ë‚´ìš© ì—†ìŒ)")+"</div>",a+="<div class='montserrat ml-auto' style='font-weight:500'>"+moment(t.start.toDate()).format("HH:mm")+" - "+moment(t.end.toDate()).format("HH:mm")+"</div></div></div><div style='font-size:11px'>"+(t.raw.etc||"")+"</div><div class='mt-auto tui-full-calendar-time-schedule-contact'>"+(t.title?"<span title='ì´ë¦„:"+t.title+"' class='mr-1'>"+t.title+"</span>":"")+(t.raw.contact?"<span title='ì—°ë½ì²˜:"+dashContact(t.raw.contact,".")+"'>"+dashContact(t.raw.contact,".")+"</span>":"")+"</div></div></div>"}function n(e){var t="",a=e.clone().add(1,"days"),n=e.clone().add(2,"days"),o=e.clone().add(3,"days"),i=e.clone().add(4,"days"),s=e.clone().add(5,"days"),r=e.clone().add(6,"days");return t+='<div class="mainCalendarWeek" data-start="'+e.format("YYYYMMDD")+'"><div data-date="'+e.format("YYYYMMDD")+'" class="mainCalendarWeekday mainCalendarHoliday"><div class="mainCalendarDayName">ì¼</div><div class="mainCalendarDay"><span>'+e.format("D")+'</span></div></div><div data-date="'+a.format("YYYYMMDD")+'" class="mainCalendarWeekday'+(NMNS.holiday&&NMNS.holiday.find(function(e){return e.date===a.format("YYYY-MM-DD")})?" mainCalendarHoliday":"")+'"><div class="mainCalendarDayName">ì›”</div><div class="mainCalendarDay"><span>'+a.format("D")+'</span></div></div><div data-date="'+n.format("YYYYMMDD")+'" class="mainCalendarWeekday'+(NMNS.holiday&&NMNS.holiday.find(function(e){return e.date===n.format("YYYY-MM-DD")})?" mainCalendarHoliday":"")+'"><div class="mainCalendarDayName">í™”</div><div class="mainCalendarDay"><span>'+n.format("D")+'</span></div></div><div data-date="'+o.format("YYYYMMDD")+'" class="mainCalendarWeekday'+(NMNS.holiday&&NMNS.holiday.find(function(e){return e.date===o.format("YYYY-MM-DD")})?" mainCalendarHoliday":"")+'"><div class="mainCalendarDayName">ìˆ˜</div><div class="mainCalendarDay"><span>'+o.format("D")+'</span></div></div><div data-date="'+i.format("YYYYMMDD")+'" class="mainCalendarWeekday'+(NMNS.holiday&&NMNS.holiday.find(function(e){return e.date===i.format("YYYY-MM-DD")})?" mainCalendarHoliday":"")+'"><div class="mainCalendarDayName">ëª©</div><div class="mainCalendarDay"><span>'+i.format("D")+'</span></div></div><div data-date="'+s.format("YYYYMMDD")+'" class="mainCalendarWeekday'+(NMNS.holiday&&NMNS.holiday.find(function(e){return e.date===s.format("YYYY-MM-DD")})?" mainCalendarHoliday":"")+'"><div class="mainCalendarDayName">ê¸ˆ</div><div class="mainCalendarDay"><span>'+s.format("D")+'</span></div></div><div data-date="'+r.format("YYYYMMDD")+'" class="mainCalendarWeekday'+(NMNS.holiday&&NMNS.holiday.find(function(e){return e.date===r.format("YYYY-MM-DD")})?" mainCalendarHoliday":" mainCalendarSaturday")+'"><div class="mainCalendarDayName">í† </div><div class="mainCalendarDay"><span>'+r.format("D")+"</span></div></div></div>",t=u(t).on("touch click",".mainCalendarWeekday",function(e){if(!u(this).hasClass("mainCalendarWeekdayActive")){u(".mainCalendarWeekdayActive").removeClass("mainCalendarWeekdayActive"),u(this).addClass("mainCalendarWeekdayActive"),NMNS.calendar.setDate(moment(u(this).data("date"),"YYYYMMDD").toDate()),f(),p();var a=moment(NMNS.calendar.getDate().getTime()).format("YYYYMM");u("#mainCalendarCarousel > div > div:nth-child("+(NMNS.siema.currentSlide+1)+") .mainCalendarWeekday").each(function(e,t){0===(u(t).data("date")+"").indexOf(a)?u(t).removeClass("mainCalendarOtherMonth"):u(t).addClass("mainCalendarOtherMonth")})}})}function o(){var e=NMNS.calendar.getDate().toDate();NMNS.siema?(NMNS.siema.destroy(!0),u("#mainCalendarCarousel").html("").html(n(moment(e).add(-7,"days").startOf("week"))).append(n(moment(e).startOf("week"))).append(n(moment(e).add(7,"days").startOf("week"))),NMNS.siema.init(),NMNS.siema.goTo(1)):(u("#mainCalendarCarousel").html(n(moment(e).add(-7,"days").startOf("week"))).append(n(moment(e).startOf("week"))).append(n(moment(e).add(7,"days").startOf("week"))),NMNS.siema=new Siema({selector:"#mainCalendarCarousel",duration:200,easing:"ease-out",perPage:1,startIndex:1,draggable:!0,multipleDrag:!1,threshold:20,loop:!1,rtl:!1,onChange:i})),u("#mainCalendarCarousel > div > div:nth-child(2) .mainCalendarWeekday[data-date='"+moment(e).format("YYYYMMDD")+"']").addClass("mainCalendarWeekdayActive")}function i(){var e=NMNS.siema.currentSlide,t=u("#mainCalendarCarousel .mainCalendarWeek").length;NMNS.calendar.setDate(moment(u("#mainCalendarCarousel > div > div:nth-child("+(e+1)+") .mainCalendarWeek .mainCalendarWeekday:nth-child("+(u("#mainCalendarCarousel .mainCalendarWeekdayActive").removeClass("mainCalendarWeekdayActive").index()+1)+")").addClass("mainCalendarWeekdayActive").data("date"),"YYYYMMDD").toDate()),f();var a=moment(NMNS.calendar.getDate().getTime()).format("YYYYMM");u("#mainCalendarCarousel > div > div:nth-child("+(NMNS.siema.currentSlide+1)+") .mainCalendarWeekday").each(function(e,t){0===(u(t).data("date")+"").indexOf(a)?u(t).removeClass("mainCalendarOtherMonth"):u(t).addClass("mainCalendarOtherMonth")}),p(),0===e?NMNS.siema.prepend(n(moment(u("#mainCalendarCarousel .mainCalendarWeek").eq(e).data("start"),"YYYYMMDD").add(-7,"days"))[0]):e===t-1&&NMNS.siema.append(n(moment(u("#mainCalendarCarousel .mainCalendarWeek").eq(e).data("start"),"YYYYMMDD").add(7,"days"))[0])}function s(){var e,t;switch(NMNS.siemaCalendar.currentSlide){case 0:e=2,t=3;break;case 1:e=3,t=1;break;case 2:e=1,t=2;break;default:return}var a=document.getElementById("mainCalendarRangeInput"+(NMNS.siemaCalendar.currentSlide+1))._flatpickr;f(a.currentYear+". "+(8<a.currentMonth?"":"0")+(a.currentMonth+1)),a=moment([a.currentYear+"",a.currentMonth+""]).toDate(),document.getElementById("mainCalendarRangeInput"+t)._flatpickr.jumpToDate(moment(a).add(-1,"month").toDate()),document.getElementById("mainCalendarRangeInput"+e)._flatpickr.jumpToDate(moment(a).add(1,"month").toDate())}function r(e){return function(){NMNS.calendar.setDate(moment(u(e).val(),"YYYYMMDD").toDate()),u("#mainCalendarRange").trigger("click"),o();var a=moment(NMNS.calendar.getDate().getTime()).format("YYYYMM");u("#mainCalendarCarousel > div > div:nth-child("+(NMNS.siema.currentSlide+1)+") .mainCalendarWeekday").each(function(e,t){0===(u(t).data("date")+"").indexOf(a)?u(t).removeClass("mainCalendarOtherMonth"):u(t).addClass("mainCalendarOtherMonth")}),u(e).val(null),p()}}function l(e){if(u("#mainCalendarCalendar").is(":visible")){e.stopPropagation();var t=e.target.getAttribute("data-action");switch(t=t||e.target.parentElement.getAttribute("data-action")){case"prev":NMNS.siemaCalendar.prev();break;case"next":NMNS.siemaCalendar.next();break;default:return}}}function d(e){document.scrollingElement.scrollTop=0,u(".calendarMenu").removeClass("fixedScroll"),u("#mainTask").toggleClass("show"),u("#mainCalendarArea").toggle().is(":visible")&&(NMNS.siema&&NMNS.siema.resizeHandler(),NMNS.siemaCalendar&&NMNS.siemaCalendar.resizeHandler())}function c(t){return NMNS.calendar.getCalendars()?NMNS.calendar.getCalendars().find(function(e){return e.id===t}):null}function m(e){var t=c(u(e.target).parents(".lnbManagerItem").data("value"));t&&t.checked!==e.target.checked&&(t.checked=e.target.checked,h())}function h(){var e=Array.prototype.slice.call(document.querySelectorAll("#lnbManagerList input"));NMNS.calendar.getCalendars().forEach(function(e){NMNS.calendar.toggleSchedules(e.id,!e.checked,!1)}),NMNS.calendar.render(!0),e.forEach(function(e){var t=e.nextElementSibling;t.style.backgroundColor=e.checked?t.getAttribute("data-color"):"transparent",t.style.borderColor=e.checked?t.getAttribute("data-color"):"#7f8fa4"})}function f(e){var t=document.getElementById("renderRange");t.innerHTML=e||moment(NMNS.calendar.getDate().getTime()).format("YYYY. MM")}function p(){NMNS.calendar.clear(),function(e,t){NMNS.socket.emit("get reserv",{start:toYYYYMMDD(e._date)+"0000",end:toYYYYMMDD(t._date)+"2359"})}(NMNS.calendar.getDateRangeStart(),NMNS.calendar.getDateRangeEnd())}function g(e){switch(e){case"BEFORE_EMAIL_VERIFICATION":return"<span class='badge badge-danger' title='ì¸ì¦ë©”ì¼ ë³´ë‚´ê¸°' style='cursor:pointer;'>ì´ë©”ì¼ ë¯¸ì¸ì¦</span><span class='btn btn-sm btn-flat btn-secondary ml-2'>ì¸ì¦ë©”ì¼ ë³´ë‚´ê¸°</span>";case"EMAIL_VERIFICATED":return"<span class='badge badge-primary badge-pill'><span class='icon-email-ok mr-1'></span>ì¸ì¦ì™„ë£Œ</span>"}return""}function N(e){u("#mainShopName").text(""!==e?e:NMNS.email),u("#mainShopCapital").text(""!==e?e.substring(0,1):NMNS.email.substring(0,1))}function S(){"Y"===NMNS.info.alrimTalkInfo.useYn?(u("#alrimUseYn").prop("checked",!0),u("#alrimScreen").hide()):(u("#alrimUseYn").prop("checked",!1),u("#alrimScreen").show()),u("#alrimCallbackPhone").val(NMNS.info.alrimTalkInfo.callbackPhone||""),u("#alrimShopName").val(NMNS.info.shopName||""),u("#alrimCancelDue").val(NMNS.info.alrimTalkInfo.cancelDue||""),u("#alrimNotice").val(NMNS.info.alrimTalkInfo.notice||"")}function v(){if(700<u("#alrimNotice").val().length)return alert("ì•Œë¦¼ ì•ˆë‚´ë¬¸êµ¬ì˜ ê¸¸ì´ê°€ ë„ˆë¬´ ê¹ë‹ˆë‹¤. ì¡°ê¸ˆë§Œ ì¤„ì—¬ì£¼ì„¸ìš” :)"),void u("#alrimNotice").focus();if(u("#alrimUseYn").prop("checked")){if(""===u("#alrimCallbackPhone").val().replace(/-/gi,""))return alert("ì•Œë¦¼í†¡ì„ ì‚¬ìš©í•˜ì‹œë ¤ë©´ ì˜ˆì•½ì·¨ì†Œ ì•Œë¦¼í†¡ì„ ë°›ì„ íœ´ëŒ€í°ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!"),void u("#alrimCallbackPhone").focus();if(!/^01([016789]?)([0-9]{3,4})([0-9]{4})$/.test(u("#alrimCallbackPhone").val().replace(/-/gi,"")))return alert("ì…ë ¥í•˜ì‹  íœ´ëŒ€í°ë²ˆí˜¸ê°€ ì •í™•í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\níœ´ëŒ€í°ë²ˆí˜¸ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”!"),void u("#alrimCallbackPhone").focus();if(""===u("#alrimShopName").val())return alert("ì•Œë¦¼í†¡ì„ ì‚¬ìš©í•˜ì‹œë ¤ë©´ ê³ ê°ì—ê²Œ ë³´ì—¬ì¤„ ë§¤ì¥ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!"),void u("#alrimShopName").focus()}var e={},t={id:"alrimInfo"},a=!1;u("#alrimShopName").val()!==(NMNS.info.shopName||"")&&(NMNS.history.push({id:"info",shopName:NMNS.info.shopName}),e={shopName:u("#alrimShopName").val()},NMNS.info.shopName=e.shopName,NMNS.socket.emit("update info",e),N(e.shopName),e={},a=!0),(u("#alrimUseYn").prop("checked")&&"Y"!==NMNS.info.alrimTalkInfo.useYn||!u("#alrimUseYn").prop("checked")&&"N"!==NMNS.info.alrimTalkInfo.useYn)&&(t.useYn=NMNS.info.alrimTalkInfo.useYn,e.useYn=u("#alrimUseYn").prop("checked")?"Y":"N",NMNS.info.alrimTalkInfo.useYn=e.useYn),u("#alrimCallbackPhone").val().replace(/-/gi,"")!==(NMNS.info.alrimTalkInfo.callbackPhone||"")&&(t.callbackPhone=NMNS.info.alrimTalkInfo.callbackPhone,e.callbackPhone=u("#alrimCallbackPhone").val().replace(/-/gi,""),NMNS.info.alrimTalkInfo.callbackPhone=e.callbackPhone),u("#alrimCancelDue").val()!==(NMNS.info.alrimTalkInfo.cancelDue||"")&&(t.cancelDue=NMNS.info.alrimTalkInfo.cancelDue,e.cancelDue=u("#alrimCancelDue").val(),NMNS.info.alrimTalkInfo.cancelDue=e.cancelDue),u("#alrimNotice").val()!==(NMNS.info.alrimTalkInfo.notice||"")&&(t.notice=NMNS.info.alrimTalkInfo.notice,e.notice=u("#alrimNotice").val(),NMNS.info.alrimTalkInfo.notice=e.notice),Object.keys(e).length&&(NMNS.history.push(t),NMNS.socket.emit("update alrim",e)),Object.keys(e).length||a?t.back():showSnackBar("<span>ë³€ê²½ëœ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</span>")}function M(){var e=moment(u("#infoBizBeginTime").val(),"HHmm");if(!e.isValid())return alert("ë§¤ì¥ ìš´ì˜ ì‹œì‘ì‹œê°„ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."),void u("#infoBizBeginTime").focus();var t=moment(u("#infoBizEndTime").val(),"HHmm");if(!t.isValid())return alert("ë§¤ì¥ ìš´ì˜ ì¢…ë£Œì‹œê°„ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."),void u("#infoBizEndTime").focus();if(e.isAfter(t))e=[t,t=e][0];else if(e.isSame(t))return void alert("ë§¤ì¥ ìš´ì˜ ì‹œì‘ì‹œê°„ê³¼ ì¢…ë£Œì‹œê°„ì´ ê°™ìŠµë‹ˆë‹¤.");if(""===u("#infoShopName").val()&&"Y"===NMNS.info.alrimTalkInfo.useYn)return alert("ì•Œë¦¼í†¡ì„ ì‚¬ìš©í•˜ê³  ê³„ì‹¤ ë•ŒëŠ” ì˜ˆì•½ê³ ê°ì—ê²Œ ë³´ì—¬ë“œë¦´ ë§¤ì¥ì´ë¦„ì´ ë°˜ë“œì‹œ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.\në§¤ì¥ì´ë¦„ì„ ì‚­ì œí•˜ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´ ì•Œë¦¼í†¡ ì‚¬ìš©ì„ ë¨¼ì € í•´ì œí•´ì£¼ì„¸ìš”."),void u("#infoShopName").val(NMNS.info.shopName);var a={},n=!1,o={id:"info"};e.format("HHmm")===NMNS.info.bizBeginTime&&t.format("HHmm")===NMNS.info.bizEndTime||(o.hourStart=NMNS.info.bizBeginTime||"0900",o.hourEnd=NMNS.info.bizEndTime||"2300",a.bizBeginTime=e.format("HHmm"),a.bizEndTime=t.format("HHmm"),NMNS.info.bizBeginTime=a.bizBeginTime||"0900",NMNS.info.bizEndTime=a.bizEndTime||"2300",NMNS.calendar.setOptions({week:{hourStart:a.bizBeginTime?parseInt(a.bizBeginTime.substring(0,2),10):NMNS.calendar.getOptions().week.hourStart,hourEnd:a.bizEndTime?parseInt(a.bizEndTime.substring(0,2),10):NMNS.calendar.getOptions().week.hourEnd}}),n=!0),u("#infoShopName").val()!==(NMNS.info.shopName||"")&&(o.shopName=NMNS.info.shopName,a.shopName=u("#infoShopName").val(),NMNS.info.shopName=a.shopName,N(a.shopName),n=!0),u("#infoBizType").val()!==(NMNS.info.bizType||"")&&(o.bizType=NMNS.info.bizType,a.bizType=u("#infoBizType").val(),NMNS.info.bizType=a.bizType,n=!0),n?(NMNS.history.push(o),NMNS.socket.emit("update info",a)):showSnackBar("<span>ë³€ê²½ëœ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</span>")}function k(){u("#noShowScheduleList").hasClass("ps")?(u("#noShowAddContact").autocomplete().clearCache(),u("#noShowScheduleTarget").autocomplete().clearCache()):(u(".noShowAddCase").off("touch click").on("touch click",function(){u(this).siblings().removeClass("bg-primary"),u(this).toggleClass("bg-primary"),u(this).parent().is(u("#noShowAddContent"))&&0<u("#noShowAddContact").val().trim().length&&(0<u(this).parent().children(".bg-primary").length||0<u(this).siblings("input").val().trim().length)?u(this).parent().next().children("span").css("opacity",1):u(this).parent().is(u("#noShowScheduleContent"))&&0<u("#noShowScheduleList input:checked").length&&(0<u(this).parent().children(".bg-primary").length||0<u(this).siblings("input").val().trim().length)?u(this).parent().next().children("span").css("opacity",1):u(this).parent().next().children("span").css("opacity",.35)}),u("#noShowAddCaseEtc,#noShowScheduleCaseEtc").on("keyup",function(e){u(this).siblings().removeClass("bg-primary"),u(this).parent().is(u("#noShowAddContent"))&&0<u("#noShowAddContact").val().trim().length&&0<u(this).val().trim().length?u(this).parent().next().children("span").css("opacity",1):u(this).parent().is(u("#noShowScheduleContent"))&&0<u("#noShowScheduleList input:checked").length&&0<u(this).val().trim().length?u(this).parent().next().children("span").css("opacity",1):u(this).parent().next().children("span").css("opacity",.35),13===e.which&&u(this).parent().next().trigger("click")}),u("#noShowAddBtn").off("touch click").on("touch click",function(){""!==u("#noShowAddContact").val()?0!==u("#noShowAddContent .noShowAddCase.bg-primary").length||0!==u("#noShowAddCaseEtc").val().trim().length?NMNS.socket.emit("add noshow",{id:NMNS.email+generateRandom(),contact:u("#noShowAddContact").val(),noShowCase:0===u("#noShowAddContent .bg-primary").length?u("#noShowAddCaseEtc").val().trim():u("#noShowAddContent .bg-primary").data("value")}):showSnackBar("<span>ë…¸ì‡¼ ì‚¬ìœ ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</span>"):showSnackBar("<span>ì €ì¥í•  ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!</span>")}),u("#noShowScheduleBtn").off("touch click").on("touch click",function(){if(0!==u("#noShowScheduleList input:checked").length)if(0!==u("#noShowScheduleContent .noShowAddCase.bg-primary").length||0!==u("#noShowScheduleCaseEtc").val().trim().length){var e=u("#noShowScheduleList input:checked").parent().parent();NMNS.history.push({id:e.data("id"),status:e.data("status"),manager:e.data("manager"),contents:e.data("contents")}),NMNS.socket.emit("update reserv",{id:e.data("id"),status:"NOSHOW",noShowCase:0<u("#noShowScheduleContent .noShowAddCase.bg-primary").length?u("#noShowScheduleContent .noShowAddCase.bg-primary").data("value"):u("#noShowScheduleCaseEtc").val().trim()})}else showSnackBar("<span>ë…¸ì‡¼ ì‚¬ìœ ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</span>");else showSnackBar("<span>ë…¸ì‡¼ë¡œ ë“±ë¡í•  ì˜ˆì•½ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</span>")}),u("#noShowScheduleSearch").off("touch click").on("touch click",function(){var e={};""!==u("#noShowScheduleTarget").val()&&(e.target=u("#noShowScheduleTarget").val()),u("#noShowScheduleList .row").remove(),NMNS.socket.emit("get summary",e)}),u("#noShowAddContact").on("keyup",function(e){13===e.which&&u("#noShowAddBtn").trigger("click")}),u("#noShowTabList a[href='#noShowSchedule']").on("show.bs.tab",function(){u("#noShowScheduleSearch").trigger("click")}),u("#noShowAddContact").autocomplete({serviceUrl:"get customer info",paramName:"contact",zIndex:1060,maxHeight:150,triggerSelectOnValidInput:!1,transformResult:function(e,t){return e.forEach(function(e){e.data=e.name,e.value=e.contact,delete e.contact,delete e.name}),{suggestions:e}},onSearchComplete:function(){},formatResult:function(e,t){return dashContact(e.value)+" ("+e.data+")"},onSearchError:function(){},onSelect:function(e){}},NMNS.socket),u("#noShowScheduleTarget").on("keyup",function(e){13===e.which&&u("#noShowScheduleSearch").trigger("click")}).autocomplete({serviceUrl:"get customer info",paramName:"target",zIndex:1060,maxHeight:150,triggerSelectOnValidInput:!1,transformResult:function(e,t){return e.forEach(function(e){e.data=e.contact,e.value=e.name,delete e.contact,delete e.name}),{suggestions:e}},onSearchComplete:function(){},formatResult:function(e,t){return e.value+" ("+dashContact(e.data)+")"},onSearchError:function(){},onSelect:function(e){u("#noShowScheduleContact").val(e.data)}},NMNS.socket))}function y(e){var t=e?"<button type='button' class='dropdown-item tui-full-calendar-dropdown-item'>ì„ íƒ</button>":"";return NMNS.calendar.getCalendars().forEach(function(e){t+="<button type='button' class='dropdown-item tui-full-calendar-dropdown-item ellipsis' data-calendar-id='"+e.id+"' data-color='"+e.color+"'><span class='tui-full-calendar-icon tui-full-calendar-calendar-dot mr-3' style='background-color: "+e.color+"'></span><span class='tui-full-calendar-content'>"+e.name+"</span></button>"}),t}function b(t){var a="";if(null==t)t=[""];else if("string"==typeof t)try{t=JSON.parse(t)}catch(e){t=[t]}else Array.isArray(t)||(t=[t]);var n=u("#scheduleTabContents input").toArray();return t.filter(function(t){return!n.find(function(e){return e.value===(t&&t.value||t)&&!(""===t&&""===e.value)})}).forEach(function(t){var e=n.find(function(e){return(""===e.value||!e.value)&&""!==t});e?u(e).data("menu-id",t?t.menuId:null).val(t&&t.value||t):a+='<div class="row mx-0 col-12 px-0"><input type="text" class="form-control form-control-sm han col" name="scheduleContents" aria-label="ì˜ˆì•½ ë‚´ìš©" placeholder="ì˜ˆì•½ ë‚´ìš©ì„ ì§ì ‘ ì…ë ¥í•˜ê±°ë‚˜ ë©”ë‰´ì—ì„œ ì„ íƒí•˜ì„¸ìš”." autocomplete="off" list="scheduleTabContentList" value="'+(t&&t.value||t)+'" '+(t&&t.menuId?'data-menu-id="'+t.menuId+'"':"")+'><button type="button" class="btn btn-sm btn-form ml-2 deleteScheduleContents">ì‚­ì œ</button></div>'}),a}function C(e){1===u("#scheduleTabContents .row").length?u(e).prev().data("menu-id",null).val(""):u(e).parent().remove()}function w(e){var t="";return e.forEach(function(e){t+='<option value="'+e.name+'"></option>'}),t}function D(e){if(!u(".scheduleMenu").data("inited")){var t;function a(){clearTimeout(t),(9<u("#scheduleContact").val().replace(/-/gi,"").length||""!==u("#scheduleName").val().replace(/-/gi,""))&&NMNS.socket.emit("get customer",{name:u("#scheduleName").val(),contact:u("#scheduleContact").val().replace(/-/gi,"")})}u(".scheduleMenu").data("inited",!0),u("#scheduleStartDate").on("touch click",function(){u("#endCalendarArea").hide(),u("#startCalendarArea").show(),this._flatpickr.setDate(moment(u(this).val(),"YYYY. MM. DD").toDate())}),u("#scheduleEndDate").on("touch click",function(){u("#startCalendarArea").hide(),u("#endCalendarArea").show(),this._flatpickr.setDate(moment(u(this).val(),"YYYY. MM. DD").toDate())}),flatpickr("#scheduleStartDate",{dateFormat:"Y. m. d",disableMobile:!0,appendTo:document.getElementById("startCalendarArea"),locale:"ko",onChange:function(e,t,a){u("#calendarModal").modal("hide")}}),flatpickr("#scheduleEndDate",{dateFormat:"Y. m. d",disableMobile:!0,appendTo:document.getElementById("endCalendarArea"),locale:"ko",onChange:function(e,t,a){u("#calendarModal").modal("hide")}}),u("#scheduleAddContents").on("touch click",function(){u("#scheduleTabContents").append(u(b("")).on("touch click","button",function(){C(this)}))}),u("#scheduleName").autocomplete({serviceUrl:"get customer info",paramName:"name",zIndex:1060,maxHeight:150,triggerSelectOnValidInput:!1,transformResult:function(e){return e.forEach(function(e){e.data=e.contact,e.value=e.name,delete e.contact,delete e.name}),{suggestions:e}},onSearchComplete:function(){},formatResult:function(e){return e.value+" ("+dashContact(e.data)+")"},onSearchError:function(){},onSelect:function(e){u("#scheduleContact").val(e.data).trigger("blur")}},NMNS.socket).on("blur",function(){clearTimeout(t),t=setTimeout(function(){a()},300)}),u("#scheduleContact").autocomplete({serviceUrl:"get customer info",paramName:"contact",zIndex:1060,maxHeight:150,triggerSelectOnValidInput:!1,transformResult:function(e){return e.forEach(function(e){e.data=e.name,e.value=e.contact,delete e.contact,delete e.name}),{suggestions:e}},onSearchComplete:function(){},formatResult:function(e){return e.value+" ("+dashContact(e.data)+")"},onSearchError:function(){},onSelect:function(e){u("#scheduleName").val(e.data),a()}},NMNS.socket).on("blur",function(){clearTimeout(t),t=setTimeout(function(){a()},300)}),u("#scheduleBtn").on("touch click",function(){var e,t,a,n,o,i,s,r,l,d;try{if(t=u("#scheduleStartDate")[0]._flatpickr.selectedDates[0],a=u("#scheduleEndDate")[0]._flatpickr.selectedDates[0],!moment(t).isValid())return void showSnackBar("ì‹œì‘ ì¼ìë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");if(!moment(a).isValid())return void showSnackBar("ì¢…ë£Œ ì¼ìë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.")}catch(e){if(!t||!a)return void showSnackBar("ì‹œê°„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!")}if(n=u("#scheduleStartTime").val(),o=u("#scheduleEndTime").val(),n)if(o)if(t.setHours(1*n.substring(0,2)),t.setMinutes(1*n.substring(2)),a.setHours(1*o.substring(0,2)),a.setMinutes(1*o.substring(2)),l=u("#scheduleManager").data("calendar-id"),d=NMNS.calendar.getCalendars().find(function(e){return e.id===l})){if(t.getTime()>a.getTime()&&(t=[a,a=t][0]),e=u("#scheduleName").val(),i=JSON.stringify(u("#scheduleTabContents input").filter(function(){return""!==this.value}).map(function(){return{id:this.getAttribute("data-menu-id")||(NMNS.menuList?NMNS.menuList.find(function(e){return e.menuName===this.value}):NMNS.email+generateRandom()),value:this.value}}).toArray()),s=u("#scheduleContact").val().replace(/-/gi,""),r=u("#scheduleEtc").val(),"Y"!==NMNS.info.alrimTalkInfo.useYn||""===s||/^01([016789]?)([0-9]{3,4})([0-9]{4})$/.test(s)||confirm("ì…ë ¥í•˜ì‹  ì „í™”ë²ˆí˜¸ëŠ” ì•Œë¦¼í†¡ì„ ë³´ë‚¼ ìˆ˜ ìˆëŠ” ì „í™”ë²ˆí˜¸ê°€ ì•„ë‹™ë‹ˆë‹¤. ê·¸ë˜ë„ ë“±ë¡í•˜ì‹œê² ì–´ìš”?")){if(NMNS.scheduleTarget&&NMNS.scheduleTarget.schedule){var c=NMNS.scheduleTarget.schedule;c.manager=c.calendarId,NMNS.history.push(c),c.calendarId!==l?(c.newCalendarId=l,NMNS.calendar.deleteSchedule(c.id,c.manager,!0),NMNS.calendar.createSchedules([{id:c.id,calendarId:l,title:e,start:t,end:a,isAllDay:!1,category:"time",attendees:[],recurrenceRule:!1,isPending:!1,dueDateClass:"",color:d.color,isFocused:!1,isVisible:!0,isReadOnly:!1,isPrivate:!1,customStyle:"",location:"",bgColor:getBackgroundColor(d.color),borderColor:d.color,dragBgColor:d.bgColor||"#334150",raw:{contact:s,contents:i,etc:r,status:u("#scheduleStatus input:checked").val()}}])):NMNS.calendar.updateSchedule(c.id,c.calendarId,{title:e,start:t,end:a,raw:{contents:i,contact:s,status:u("#scheduleStatus input:checked").val()}}),NMNS.socket.emit("update reserv",{email:NMNS.email,id:c.id,manager:l,name:e,start:moment(t).format("YYYYMMDDHHmm"),end:moment(a).format("YYYYMMDDHHmm"),contents:i,contact:s,isAllDay:!1,status:u("#scheduleStatus input:checked").val()})}else{var m=NMNS.email+generateRandom();NMNS.calendar.createSchedules([{id:m,calendarId:l,title:e,start:t,end:a,isAllDay:!1,category:"time",attendees:[],recurrenceRule:!1,isPending:!1,dueDateClass:"",color:d.color,isFocused:!1,isVisible:!0,isReadOnly:!1,isPrivate:!1,customStyle:"",location:"",bgColor:getBackgroundColor(d.color),borderColor:d.color,dragBgColor:d.bgColor||"#334150",raw:{contact:s,contents:i,etc:r,status:"RESERVED"}}]),NMNS.history.push({id:m,manager:l,type:"T"}),NMNS.socket.emit("add reserv",{email:NMNS.email,id:m,manager:l,name:e,start:moment(t).format("YYYYMMDDHHmm"),end:moment(a).format("YYYYMMDDHHmm"),isAllDay:!1,type:"R",bgColor:getBackgroundColor(d.color),borderColor:d.color,dragBgColor:d.bgColor||"#334150",color:d.color,contact:s,contents:i,etc:r,status:"RESERVED"})}history.back()}}else showSnackBar("ë‹´ë‹¹ìë¥¼ ì§€ì •í•´ì£¼ì„¸ìš”.");else showSnackBar("ì¢…ë£Œ ì‹œê°„ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");else showSnackBar("ì‹œì‘ ì‹œê°„ì„ í™•ì¸í•´ì£¼ì„¸ìš”.")}),u("#deleteScheduleBtn").on("touch click",function(e){e.preventDefault(),NMNS.scheduleTarget&&NMNS.scheduleTarget.schedule&&confirm("ì´ ì˜ˆì•½ì„ ì‚­ì œí•˜ì‹œê² ì–´ìš”?")&&(NMNS.history.push(NMNS.scheduleTarget.schedule),NMNS.calendar.deleteSchedule(NMNS.scheduleTarget.schedule.id,NMNS.scheduleTarget.schedule.calendarId),NMNS.socket.emit("update reserv",{id:NMNS.scheduleTarget.schedule.id,status:"DELETED"}),history.back())}),u("#resendAlrimScheduleBtn").on("touch click",function(e){e.preventDefault(),NMNS.scheduleTarget&&NMNS.scheduleTarget.schedule&&confirm("ê³ ê°ì—ê²Œ ì•Œë¦¼í†¡ì„ ë‹¤ì‹œ ë³´ë‚¼ê¹Œìš”?")&&NMNS.socket.emit("resend alrimtalk",{id:NMNS.scheduleTarget.schedule.id})})}!function(e){var t;NMNS.refreshScheduleManager&&(NMNS.refreshScheduleManager=!1,u("#scheduleManager").next().html(y()).off("touch click","button").on("touch click","button",function(){u("#scheduleManager").data("calendar-id",u(this).data("calendar-id")).data("color",u(this).data("color")).html(u(this).html())})),NMNS.refreshMenu&&(NMNS.refreshMenu=!1,NMNS.socket.emit("get menu list")),u("#scheduleName").autocomplete()&&u("#scheduleName").autocomplete().clearCache(),u("#scheduleContact").autocomplete()&&u("#scheduleContact").autocomplete().clearCache(),u(".scheduleMenu").data("contact",e&&e.schedule?e.schedule.raw.contact:null).data("name",e&&e.schedule?e.schedule.title:""),"object"==typeof e&&(e.schedule&&(u("#scheduleStatus input[type='radio']").prop("checked",!1),u("#scheduleStatus input[value='"+e.schedule.raw.status+"']").length?u("#scheduleStatus input[value='"+e.schedule.raw.status+"']").prop("checked",!0):"CUSTOMERCANCELED"===e.schedule.raw.status?u("#scheduleStatus input[value='CUSTOMERCANCELED']").prop("checked",!0):u("#scheduleStatus input[value='RESERVED']").prop("checked",!0),document.getElementById("scheduleStartDate")._flatpickr.setDate(e.schedule.start.toDate()),document.getElementById("scheduleEndDate")._flatpickr.setDate(e.schedule.end.toDate()),u("#scheduleStartTime").val(moment(e.schedule.start.toDate()).format("HHmm")),u("#scheduleEndTime").val(moment(e.schedule.end.toDate()).format("HHmm")),u("#scheduleName").val(e.schedule.title),u("#scheduleTabContents").append(b(e.schedule.raw?e.schedule.raw.contents:"")).find("button").off("touch click").on("touch click",function(){C(this)}),u("#scheduleContact").val(e.schedule.raw?e.schedule.raw.contact:e.schedule.contact),u("#scheduleEtc").val(e.schedule.raw?e.schedule.raw.etc:e.schedule.etc),moment(e.schedule.start.toDate()).isBefore(moment())?u("#resendAlrimScheduleBtn").addClass("d-none").next().removeClass("ml-1"):u("#resendAlrimScheduleBtn").removeClass("d-none").next().addClasS("ml-1"),t=c(e.schedule.calendarId)),t?(t=u("#scheduleManagerList").find("button[data-calendar-id='"+t.id+"']"),u("#scheduleManager").html(t.html()).data("calendar-id",t.data("calendarId")).data("color",t.data("color"))):u("#scheduleManager").html("<span class='tui-full-calendar-icon tui-full-calendar-calendar-dot' style='background-color: "+e.schedule.color+"'></span><span class='tui-full-calendar-content'>(ì‚­ì œëœ ë‹´ë‹¹ì)</span>").data("calendar-id",e.schedule.calendarId).data("color",e.schedule.color))}(e)}function Y(e){if(!u(".taskDetailMenu").data("inited")){u(".taskDetailMenu").data("inited",!0);var t={dateFormat:"Y. m. d",enableTime:!1,defaultDate:new Date,locale:"ko"};flatpickr("#taskStartDate",t),flatpickr("#taskEndDate",t),u("#taskStartDate").on("touch click",function(){u("#endTaskArea").hide(),u("#startTaskArea").show(),this._flatpickr.setDate(moment(u(this).val(),"YYYY. MM. DD").toDate())}),u("#taskEndDate").on("touch click",function(){u("#startTaskArea").hide(),u("#endTaskArea").show(),this._flatpickr.setDate(moment(u(this).val(),"YYYY. MM. DD").toDate())}),flatpickr("#taskStartDate",{dateFormat:"Y. m. d",disableMobile:!0,appendTo:document.getElementById("startTaskArea"),locale:"ko",onChange:function(e,t,a){u("#taskCalendarModal").modal("hide")}}),flatpickr("#taskEndDate",{dateFormat:"Y. m. d",disableMobile:!0,appendTo:document.getElementById("endTaskArea"),locale:"ko",onChange:function(e,t,a){u("#taskCalendarModal").modal("hide")}}),u("#taskBtn").on("touch click",function(){if(""===u("#taskName").val())return alert("ì¼ì • ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!"),void u("#taskName").focus();var e=u("#taskStartDate")[0]._flatpickr.selectedDates[0],t=u("#taskEndDate")[0]._flatpickr.selectedDates[0];e.getTime()>t.getTime()&&(e=[t,t=e][0]);var a=u("#taskStartTime").val(),n=u("#taskEndTime").val();if(a)if(n){e.setHours(1*a.substring(0,2)),e.setMinutes(1*a.substring(2)),t.setHours(1*n.substring(0,2)),t.setMinutes(1*n.substring(2));var o=u(".taskDetailMenu").data("task");o.manager=o.calendarId,NMNS.history.push(o),o.calendarId!==u("#taskManager").data("calendar-id")?(o.newCalendarId=u("#taskManager").data("calendar-id"),NMNS.calendar.deleteSchedule(o.id,o.manager,!0),NMNS.calendar.createSchedules([{id:o.id,calendarId:u("#taskManager").data("calendar-id"),title:u("#taskName").val(),start:e,end:t,isAllDay:!1,category:"task",dueDateClass:"",color:u("#taskManager").data("bgcolor"),bgColor:getBackgroundColor(u("#taskManager").data("bgcolor")),borderColor:u("#taskManager").data("bgcolor"),raw:{status:"RESERVED"}}])):NMNS.calendar.updateSchedule(o.id,o.calendarId,{title:u("#taskName").val(),start:e,end:t,isAllDay:!1}),NMNS.socket.emit("update reserv",{id:o.id,manager:u("#taskManager").data("calendar-id"),name:u("#taskName").val(),start:moment(e).format("YYYYMMDDHHmm"),end:moment(t).format("YYYYMMDDHHmm"),type:"T",isAllDay:!1}),history.back()}else showSnackBar("ì¢…ë£Œ ì‹œê°„ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");else showSnackBar("ì‹œì‘ ì‹œê°„ì„ í™•ì¸í•´ì£¼ì„¸ìš”.")}),u("#deleteTaskBtn").on("touch click",function(){var e=u(".taskDetailMenu").data("task");NMNS.history.push(e),NMNS.socket.emit("update reserv",{id:e.id,status:"DELETED",type:"T"}),history.back()})}!function(t){var e;NMNS.refreshTaskManager&&(NMNS.refreshTaskManager=!1,u("#taskManager").next().html(y()).off("touch click","button").on("touch click","button",function(){u("#taskManager").data("calendar-id",u(this).data("calendar-id")).data("color",u(this).data("color")).html(u(this).html())})),u(".taskDetailMenu").data("task",t),document.getElementById("taskStartDate")._flatpickr.setDate(moment(t.start,"YYYYMMDDHHmm").toDate()),document.getElementById("taskEndDate")._flatpickr.setDate(moment(t.end,"YYYYMMDDHHmm").toDate()),u("#taskStartTime").val(getTimeFormat(moment(t.start,"YYYYMMDDHHmm"))),u("#taskEndTime").val(getTimeFormat(moment(t.end,"YYYYMMDDHHmm"))),u("#taskName").val(t.name||""),u("#taskContents").val(t.raw&&t.raw.contents||""),(e=t.calendarId?NMNS.calendar.getCalendars().find(function(e){return e.id===t.calendarId}):NMNS.calendar.getCalendars()[0])?(e=u("#taskManager").next().find("button[data-calendar-id='"+e.id+"']"),u("#taskManager").html(e.html()).data("calendar-id",e.data("calendar-id")).data("color",e.data("color"))):u("#taskManager").html("<span class='tui-full-calendar-icon tui-full-calendar-calendar-dot' style='background-color: "+t.color+"'></span><span class='tui-full-calendar-content'>(ì‚­ì œëœ ë‹´ë‹¹ì)</span>").data("calendar-id",t.calendarId).data("color",t.color)}(e)}function T(e){NMNS.calendar.createSchedules(e.map(function(e){if(e.raw)return"string"==typeof e.start&&(e.start=moment(e.start,"YYYYMMDDHHmm").toDate()),"string"==typeof e.end&&(e.end=moment(e.end,"YYYYMMDDHHmm").toDate()),e;var t=c(e.manager||e.calendarId)||{};return{id:e.id,calendarId:t.id||"A1",title:e.name||e.title,start:"string"==typeof e.start?moment(e.start,"YYYYMMDDHHmm").toDate():e.start,end:"string"==typeof e.end?moment(e.end,"YYYYMMDDHHmm").toDate():e.end,isAllDay:!1,category:"T"===e.type?"task":"time",dueDateClass:"T"===e.type?"dueDateClass":"",attendees:[],recurrenceRule:!1,isPending:e.isCanceled,isFocused:!1,isVisible:!0,isReadOnly:!1,isPrivate:!1,customStyle:"",location:"",bgColor:getBackgroundColor(t.color||"#334150"),borderColor:t.borderColor||"#334150",color:t.color||"#334150",dragBgColor:t.bgColor||"#334150",raw:{contact:e.contact,contents:e.contents,etc:e.etc,status:e.status}}}),!0)}function E(e){var t=e.parentsUntil("#noShowSearchList",".row");NMNS.history.push({id:t.data("id"),contact:t.data("contact")+"",date:t.data("date")+"",noShowCase:t.data("noshowcase")}),NMNS.socket.emit("delete noshow",{id:t.data("id")}),t.remove()}function x(e,t){e&&e.preventDefault&&e.preventDefault(),u(this).hasClass("menuLinkActive")||(u(".modal-backdrop.show").remove(),u(document.body).removeClass("modal-open"),u(".switchingMenu:not(."+u(this).data("link")+")").hide(),u("."+u(this).data("link")).show().hasClass("salesMenu")?u("#mainRow").addClass("fixedScroll"):u("#mainRow").removeClass("fixedScroll"),u(".menuLinkActive").removeClass("menuLinkActive"),u(this).addClass("menuLinkActive"),u(".calendarMenu").removeClass("fixedScroll").is(":visible")&&(NMNS.siema&&NMNS.siema.resizeHandler(),NMNS.siemaCalendar&&NMNS.siemaCalendar.resizeHandler()),document.scrollingElement.scrollTop=0,u("#mainAside").removeClass("sidebar-toggled"),t||history.pushState({link:u(this).data("link"),type:u(this).data("type"),title:u(this).data("title")},"",u(this).data("history")),"detail"!==u(this).data("type")?(u("#detailMenuTitle").hide().prev().show(),u("#exitDetailMenu").hide().prev().show(),"white"!==u(this).data("background")?u("#mainContents,body").removeClass("bg-white"):u("#mainContents,body").addClass("bg-white")):(u("#detailMenuTitle").html(u(this).data("title")).show().prev().hide(),u(".announcementMenuLink").hide().next().show(),u("#mainContents,body").addClass("bg-white")))}NMNS.calendar=new tui.Calendar("#mainCalendar",{taskView:[],defaultView:"day",scheduleView:["time"],useCreationPopup:!1,useDetailPopup:!0,disableDblClick:!0,isReadOnly:!0,template:{allday:function(e){return a(e,e.isAllDay)},time:function(e){return a(e,e.isAllDay)},task:function(e){return a(e,e.isAllDay)},alldayTitle:function(){return"<span class='tui-full-calendar-left-content'>í•˜ë£¨ì¢…ì¼</span>"},taskTitle:function(){return"<span class='tui-full-calendar-left-content'>ì¼ì •</span>"},timegridDisplayPrimayTime:function(e){return e.hour+":00"},popupIsAllDay:function(){return"í•˜ë£¨ì¢…ì¼"},startDatePlaceholder:function(){return"ì‹œì‘ì‹œê°„"},endDatePlaceholder:function(){return"ì¢…ë£Œì‹œê°„"},popupDetailDate:function(e,t,a){var n=moment(t instanceof Date?t:t.toDate()),o=moment(a instanceof Date?a:a.toDate()),i=n.isSame(o,"day"),s=(i?"":"YYYY.MM.DD ")+"a h:mm";return e?n.format("YYYY.MM.DD")+(i?"":" - "+o.format("YYYY.MM.DD")):n.format("YYYY.MM.DD a h:mm")+" - "+o.format(s)},popupEdit:function(){return"ìˆ˜ì •"},popupDelete:function(){return"ì‚­ì œ"},weekDayname:function(t){var e="tui-full-calendar-dayname-date",a="tui-full-calendar-dayname-name"+(NMNS.calendar&&"week"===NMNS.calendar.getViewName()?" weekViewDayName":""),n=NMNS.holiday?NMNS.holiday.find(function(e){return e.date===t.renderDate}):void 0;return n&&(a+=" tui-full-calendar-holiday",e+=" tui-full-calendar-holiday"),'<span class="'+e+'">'+t.date+'</span>&nbsp;&nbsp;<span class="'+a+'">'+t.dayName+(n?"["+n.title+"]":"")+"</span>"},monthGridHeader:function(t){var e=parseInt(t.date.split("-")[2],10),a=["tui-full-calendar-weekday-grid-date"],n=NMNS.holiday?NMNS.holiday.find(function(e){return e.date===t.date}):void 0;return n&&a.push("tui-full-calendar-holiday"),'<span class="'+a.join(" ")+'">'+e+(n?"<small class='d-none d-sm-inline'>["+n.title+"]</small>":"")+"</span>"},monthGridHeaderExceed:function(){return""},monthGridFooterExceed:function(e){return'<span class="tui-full-calendar-weekday-grid-more-schedules" title="ì „ì²´ ì˜ˆì•½">ì „ì²´ ì˜ˆì•½ <span class="icon-arrow icon-arrow-right"></span></span>'},monthMoreTitleDate:function(e,t){var a=e.split(".").join("-"),n=NMNS.holiday?NMNS.holiday.find(function(e){return e.date===a}):void 0;return'<span class="'+("tui-full-calendar-month-more-title-day"+("ì¼"===t?" tui-full-calendar-holiday-sun":"")+(n?" tui-full-calendar-holiday":"")+("í† "===t?" tui-full-calendar-holiday-sat":""))+'">'+parseInt(a.substring(8),10)+'</span> <span class="tui-full-calendar-month-more-title-day-label">'+t+(n?"<small class='d-none d-sm-inline'>["+n.title+"]</small>":"")+"</span>"},monthlyDetailPopup:function(e,t){var a,n="<div class='d-flex flex-column position-relative'><button type='button' class='tui-full-calendar-popup-close close p-0 ml-auto my-0 mr-0 position-absolute' aria-label='ë‹«ê¸°' style='right:0'><span aria-hidden='true' style='vertical-align:top;font-size:12px'>&times;</span></button>",o=moment(t);return e.forEach(function(t,e){if(0===e&&(n+="<div class='d-flex'>"),n+="<div class='monthlyDetailPopupTime montserrat col px-0'>"+(moment(t.start.toDate()).isSame(o,"days")?moment(t.start.toDate()).format("HH:mm"):moment(t.start.toDate()).format("MM. DD HH:mm"))+(t.end?moment(t.end.toDate()).isSame(o,"days")?moment(t.end.toDate()).format(" - HH:mm"):moment(t.end.toDate()).format(" - MM. DD HH:mm"):"")+"</div>",0===e&&(n+="<div class='d-inline-block' style='width:25px'></div></div>"),t.title&&""!==t.title)a=t.title;else if(t.raw.contents&&""!==t.raw.contents)try{a=JSON.parse(t.raw.contents).map(function(e){return e.value}).join(", ")}catch(e){a=t.raw.contents}else a=t.raw.contact&&""!==t.raw.contact?t.raw.contact:"";n+="<div class='monthlyDetailPopupTitle col-12 px-0'>"+a+"</div>"}),n+="</div>"}},month:{daynames:["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "],scheduleFilter:function(){return!0},grid:{header:{height:26}}},week:{daynames:["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "],hourStart:NMNS.info.bizBeginTime?parseInt(NMNS.info.bizBeginTime.substring(0,2),10):9,hourEnd:NMNS.info.bizEndTime?parseInt(NMNS.info.bizEndTime.substring(0,2),10)+("00"===NMNS.info.bizEndTime.substring(2)?0:1):23},theme:{"common.border":"1px solid rgba(57, 53, 53, 0.2)","common.saturday.color":"#1736ff","common.dayname.color":"#393535","common.holiday.color":"#fd5b77","common.creationGuide.backgroundColor":"#ffdbdb","common.creationGuide.border":"1px solid #ffdbdb","month.schedule.marginLeft":"0px","month.schedule.marginRight":"1px","month.schedule.marginTop":"5px","month.schedule.height":"12px","month.dayname.height":"52px","month.dayname.borderLeft":"none","month.dayname.borderTop":"none","month.dayname.textAlign":"center","month.dayname.fontWeight":"normal","month.holidayExceptThisMonth.color":"rgba(253, 91, 119, 0.35)","month.saturdayExceptThisMonth.color":"rgba(23, 54, 255, 0.35)","month.dayExceptThisMonth.color":"rgba(57, 53, 53, 0.35)","month.day.fontSize":"13px","week.currentTime.color":"#fd5b77","week.currentTimeLinePast.border":"1px solid #fd5b77","week.currentTimeLineBullet.backgroundColor":"transparent","week.currentTimeLineToday.border":"1px solid #fd5b77","week.currentTimeLineFuture.border":"1px solid #fd5b77","week.timegridOneHour.height":"68px","week.timegridHalfHour.height":"34px","week.vpanelSplitter.height":"5px","week.pastDay.color":"#393535","week.futureDay.color":"#393535","week.pastTime.color":"#393535","week.futureTime.color":"#393535","week.creationGuide.color":"#fd5b77","week.today.backgroundColor":"inherit","week.timegrid.paddingRight":"1px","week.dayGridSchedule.marginRight":"1px","week.dayname.borderTop":"none","week.dayname.borderBottom":"none","week.dayname.borderLeft":"none","week.dayname.textAlign":"center","week.dayname.height":"51px","week.timegridHorizontalLine.borderBottom":"1px solid rgba(57, 53, 53, 0.2)","week.daygrid.borderRight":"1px solid rgba(57,53,53,0.2)","week.timegrid.borderRight":"1px solid rgba(57,53,53,0.2)","week.dayGridSchedule.borderLeft":"2px solid","week.daygridLeft.width":"54px","week.timegridLeft.borderRight":"none","week.timegridLeft.width":"54px"}}),NMNS.calendar.on({clickSchedule:function(e){D(NMNS.scheduleTarget=e),x.call(u(".scheduleLink"),e)},beforeCreateSchedule:function(e){D(NMNS.scheduleTarget=e),u("#scheduleTabList a[data-target='#scheduleTab']").text("ì˜ˆì•½ ì¶”ê°€").tab("show"),u("#scheduleBtn").text("ì˜ˆì•½ ì¶”ê°€ ì™„ë£Œ"),u("#scheduleModal").removeClass("update").modal("show")},beforeUpdateSchedule:function(e){if(e.schedule&&e.start&&e.end){var t=e.schedule||u.extend(!0,{},e.schedule);NMNS.history.push(t),e.schedule.start=e.start||e.schedule.start,e.schedule.end=e.end||e.schedule.end,NMNS.calendar.updateSchedule(e.schedule.id,e.history?e.history.selectedCal.id:e.schedule.calendarId,e.schedule),NMNS.socket.emit("update reserv",{id:e.schedule.id,start:moment(e.schedule.start.toDate?e.schedule.start.toDate():e.schedule.start).format("YYYYMMDDHHmm"),end:moment(e.schedule.end.toDate?e.schedule.end.toDate():e.schedule.end).format("YYYYMMDDHHmm")})}},beforeDeleteSchedule:function(e){NMNS.history.push(e.schedule),NMNS.calendar.deleteSchedule(e.schedule.id,e.schedule.calendarId),NMNS.socket.emit("update reserv",{id:e.schedule.id,status:"DELETED"})},beforeChangeView:function(e){NMNS.calendar.changeView(e.viewName),NMNS.calendar.setDate(e.date),f(),p()}}),NMNS.socket=io(),NMNS.socket.emit("get info"),NMNS.socket.emit("get manager"),setTimeout(function(){NMNS.socket.emit("get task",{start:moment().format("YYYYMMDD"),end:moment().add(7,"days").format("YYYYMMDD")})},200),NMNS.socket.on("get reserv",socketResponse("ì˜ˆì•½ ì •ë³´ ë°›ì•„ì˜¤ê¸°",function(e){T(e.data),NMNS.holiday=NMNS.holiday.concat(e.holiday.filter(function(t){return!NMNS.holiday.some(function(e){return e.date===t.date})})),h()})),NMNS.socket.on("get info",socketResponse("ë§¤ì¥ ì •ë³´ ë°›ì•„ì˜¤ê¸°",function(e){NMNS.info=e.data,NMNS.calendar&&NMNS.calendar.setOptions({week:{hourStart:NMNS.info.bizBeginTime?parseInt(NMNS.info.bizBeginTime.substring(0,2),10):9,hourEnd:NMNS.info.bizEndTime?parseInt(NMNS.info.bizEndTime.substring(0,2),10)+("00"===NMNS.info.bizEndTime.substring(2)?0:1):23}}),NMNS.email=e.data.email||NMNS.email,NMNS.calendarHeight=4.26*(NMNS.calendar.getOptions().week.hourEnd-NMNS.calendar.getOptions().week.hourStart)+7.25,u("#mainCalendar").css("height",NMNS.calendarHeight+"rem"),"BEFORE_EMAIL_VERIFICATION"===NMNS.info.authStatus&&moment(NMNS.info.signUpDate,"YYYYMMDD").add(30,"d").isSameOrAfter(moment(),"day")&&showNotification({title:"ì´ë©”ì¼ì„ ì¸ì¦í•´ì£¼ì„¸ìš”!",body:"ì´ë©”ì¼ì„ ì¸ì¦í•˜ë©´ WA:SHOWì˜ ëª¨ë“  ê¸°ëŠ¥ì„ ì´ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë©”ì¼ì„ ì¸ì¦í•´ì£¼ì„¸ìš”! ì¸ì¦ë©”ì¼ì€ ë‚´ ë§¤ì¥ ì •ë³´ í™”ë©´ì—ì„œ ë‹¤ì‹œ ë³´ë‚´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤."}),"true"!==localStorage.getItem("notAnyMore")&&(u(document.body).append('<div id="welcomeModal" class="modal fade" tabIndex="-1" role="dialog" aria-label="í™˜ì˜ íŒì—…" aria-hidden="true">\t\t\t\t\t\t<div class="modal-dialog modal-dialog-centered" role="document">\t\t\t\t\t\t\t<div class="modal-content rounded-0">\t\t\t\t\t\t\t\t<div class="modal-body flex-column" style="padding:20px">\t\t\t\t\t\t\t\t\t<div><img src="/nmns/img/mobile_welcome.png" style="width:100%"/></div>\t\t\t\t\t\t\t\t\t<div style="text-align:center;margin:20px 0 33px 0;font-size:14px">\t\t\t\t\t\t\t\t\t\tì™“ì‡¼ì— ì˜¤ì‹ ê±¸ í™˜ì˜í•´ìš” &gt;_&lt;<br><br>ëª¨ë°”ì¼ ë²„ì „ì—ì„œëŠ”<br>ë…¸ì‡¼, ì˜ˆì•½, ì¼ì •, ê³ ê°, ë©”ë‰´ ì¶”ê°€ ê¸°ëŠ¥ì„ ëº€<br>ëª¨ë“  ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ìˆì–´ìš”.<br>ì¶”ê°€ ê¸°ëŠ¥ì€ PCì—ì„œ ì´ìš©í•  ìˆ˜ ìˆë‹µë‹ˆë‹¤!\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div class="modal-footer" style="padding:0 25px;height:57px"><input type="checkbox" id="notAnyMore"><label for="notAnyMore"></label><label for="notAnyMore" style="font-size:12px;margin-left:0">ë‹¤ì‹œ ë³´ì§€ ì•Šê¸°</label><button type="button" class="btn btn-flat ml-auto px-0" style="font-size:14px" data-dismiss="modal">ë‹«ê¸°</button></div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>'),u("#notAnyMore").on("change",function(){localStorage.setItem("notAnyMore","true"),u("#welcomeModal").modal("hide")}),u("#welcomeModal").modal("show")),NMNS.info.newAnnouncement?(u("#announcementIcon").addClass("icon-announcement-count"),u(".announcementCount").html(99<NMNS.info.newAnnouncement?"99+":NMNS.info.newAnnouncement)):u("#announcementIcon").removeClass("icon-announcement-count"),NMNS.info.logo&&function(e,t){e?(u("#mainShopCapital").addClass("d-none"),u("#mainShopIcon").removeClass("d-none").attr("src",t)):(u("#mainShopIcon").addClass("d-none"),u("#mainShopCapital").text(""!==t?t.substring(0,1):NMNS.email.substring(0,1)).removeClass("d-none"))}(!0,NMNS.info.logo)})),NMNS.socket.on("get manager",socketResponse("ë‹´ë‹¹ì ì •ë³´ ë°›ì•„ì˜¤ê¸°",function(e){e.data.forEach(function(e){e.checked=!0,e.bgColor=getBackgroundColor(e.color),e.borderColor=e.color,e.color=e.color}),NMNS.calendar.setCalendars(e.data),NMNS.needInit&&(delete NMNS.needInit,p()),h()})),u("#toggleCalendarToday").on("touch click",function(){if(u(this).blur(),NMNS.calendar.setDate(new Date),NMNS.siemaCalendar&&(document.getElementById("mainCalendarRangeInput"+(NMNS.siemaCalendar.currentSlide+1))._flatpickr.setDate(NMNS.calendar.getDate().toDate()),NMNS.siemaCalendar.resizeHandler(),u("#mainCalendarCalendar").is(":visible")))return u("#mainCalendarRange").trigger("click"),void o();o(),NMNS.siema.resizeHandler(),f()}),NMNS.generateMenuList=w,o(),f(),NMNS.socket.on("get summary",socketResponse("ì˜ˆì•½ì •ë³´ ê°€ì ¸ì˜¤ê¸°",function(e){var n="";0===e.data.length?n="<div class='row col-12 px-0 mt-1 empty'><span class='col-12 text-center'>ê²€ìƒ‰ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤. ê²€ìƒ‰ì¡°ê±´ì„ ë°”ê¿”ì„œ ê²€ìƒ‰í•´ë³´ì„¸ìš” :)</span></div>":e.data.forEach(function(t){var a="";if(t.contents)try{a=JSON.parse(t.contents).map(function(e){return e.value}).join(", ")}catch(e){a=t.contents}n+="<div class='row col-12 mx-0' style='padding: 10px 0;font-size:12px' data-id='"+(t.id||"")+"' data-manager='"+(t.manager||"")+"' data-status='"+(t.status||"")+"'"+(t.contents?" title='"+a+"'":"")+"><div class='col-1 pl-0'><input type='checkbox' class='noShowScheduleCheck' id='noShowSchedule"+t.id+"'></input><label for='noShowSchedule"+t.id+"'></label></div><div class='col-2 montserrat px-0'>"+(t.start?moment(t.start,"YYYYMMDDHHmm").format("YYYY. MM. DD"):"")+"</div><div class='col-2 pr-0'>"+(t.name||"")+"</div><div class='col-3 pr-0 montserrat'>"+dashContact(t.contact)+"</div><div class='col-4 pr-0'>"+a+"</div></div>"}),u("#noShowScheduleList").html(n),u("#noShowScheduleList input[type=checkbox]").on("change",function(e){u("#noShowScheduleList input[type=checkbox]").not(this).prop("checked",!1),u(this).prop("checked")&&(0<u("#noShowScheduleContent .bg-primary").length||0<u("#noShowScheduleCaseEtc").val().trim().length)?u("#noShowScheduleBtn span").css("opacity",1):u("#noShowScheduleBtn span").css("opacity",.35)})})),NMNS.socket.on("add reserv",socketResponse("ì˜ˆì•½/ì¼ì • ì¶”ê°€í•˜ê¸°",function(e){NMNS.history.remove(e.data.id,function(e,t){return e.id===t})},function(t){var e=NMNS.history.find(function(e){return e.id===t.data.id});NMNS.history.remove(t.data.id,function(e,t){return e.id===t}),delete e.id,NMNS.calendar.deleteSchedule(t.data.id,e.manager)})),NMNS.socket.on("update reserv",socketResponse("ì˜ˆì•½/ì¼ì • ì •ë³´ ë³€ê²½í•˜ê¸°",function(t){var e=NMNS.history.find(function(e){return e.id===t.data.id});NMNS.history.remove(t.data.id,function(e,t){return e.id===t}),"task"===e.category?"boolean"!=typeof e.isDone&&NMNS.socket.emit("get task",{start:moment().format("YYYYMMDD"),end:moment().add(7,"days").format("YYYYMMDD")}):u("#noShowScheduleList").is(":visible")&&u("#noShowScheduleList .row[data-id='"+t.data.id+"']").length?(showSnackBar("<span>ë…¸ì‡¼ë¡œ ë“±ë¡í•˜ì˜€ìŠµë‹ˆë‹¤.</span>"),u("#noShowScheduleList .row[data-id='"+t.data.id+"']").remove(),u("#noShowScheduleBtn span").css("opacity",.35)):u("#announcementArea").is(":visible")&&u("#announcementArea .addAnnouncementNoShow[data-schedule-id='"+t.data.id+"']").length&&(showSnackBar("<span>ë…¸ì‡¼ë¡œ ë“±ë¡í•˜ì˜€ìŠµë‹ˆë‹¤.</span>"),u("#announcementArea .addAnnouncementNoShow[data-schedule-id='"+t.data.id+"']").hide())},function(t){var e=NMNS.history.find(function(e){return e.id===t.data.id});NMNS.history.remove(t.data.id,function(e,t){return e.id===t}),e&&("task"===e.category?"boolean"==typeof e.isDone&&u("#mainTaskContents .task[data-id='"+e.id+"'] input").prop("checked",e.isDone):"DELETED"===(e.status||e.raw.status)?(T([e]),h()):e.newCalendarId&&!NMNS.calendar.getSchedule(t.data.id,e.selectedCal?e.selectedCal.id:e.calendarId)?(NMNS.calendar.deleteSchedule(t.data.id,e.newCalendarId,!0),e.category="task"===e.category?"task":"time",e.dueDateClass="",e.calendarId=e.selectedCal?e.selectedCal.id:e.calendarId,e.start="string"==typeof e.start?moment(e.start,"YYYYMMDDHHmm").toDate():e.start,e.end="string"==typeof e.end?moment(e.end,"YYYYMMDDHHmm").toDate():e.end,e.color=e.color||e.selectedCal.color,e.bgColor=e.bgColor||e.selectedCal.bgColor,e.borderColor=e.borderColor||e.selectedCal.borderColor,NMNS.calendar.createSchedules([e])):("string"==typeof e.start&&(e.start=moment(e.start,"YYYYMMDDHHmm").toDate()),"string"==typeof e.end&&(e.end=moment(e.end,"YYYYMMDDHHmm").toDate()),NMNS.calendar.updateSchedule(t.data.id,e.selectedCal?e.selectedCal.id:e.calendarId,e)))})),NMNS.socket.on("get task",socketResponse("ì¼ì • ê°€ì ¸ì˜¤ê¸°",function(e){e.data.some(function(e){return e.date===moment().format("YYYYMMDD")})&&u("#todayTask").text(e.data.find(function(e){return e.date===moment().format("YYYYMMDD")}).task.length),u("#mainTaskContents").html(function(e){var o="";if(0<e.length){var t=moment().format("YYYYMMDD"),a=moment().add(1,"days").format("YYYYMMDD");e.forEach(function(n){0<n.task.length&&(o+="<div class='taskDate' style='font-size:12px;opacity:0.5'><hr class='hr-text' data-content='"+(n.date===t?"ì˜¤ëŠ˜":n.date===a?"ë‚´ì¼":moment(n.date,"YYYYMMDD").format("YYYY. MM. DD"))+"'></div>",n.task.forEach(function(e,t){var a=c(e.manager)||{};o+="<div class='row mx-0 px-0 col-12 position-relative' data-id='"+e.id+"' data-calendar-id='"+e.manager+"' data-start='"+e.start+"' data-end='"+e.end+"' data-name='"+e.name+"'><input type='checkbox' class='task-checkbox' id='task-checkbox"+t+"'"+(e.isDone?" checked='checked'":"")+"><label for='task-checkbox"+t+"'></label><div class='flex-column d-inline-flex cursor-pointer task' style='margin-left:10px;max-width:calc(100% - 35px)'><div style='font-size:14px'>"+e.name+"</div><div class='montserrat' style='font-size:12px;opacity:0.5'>"+moment(e.start,"YYYYMMDDHHmm").format(moment(e.start,"YYYYMMDDHHmm").isSame(moment(n.date,"YYYYMMDD"),"day")?"HH:mm":"MM. DD HH:mm")+(e.end?" - "+moment(e.end,"YYYYMMDDHHmm").format(moment(e.end,"YYYYMMDDHHmm").isSame(moment(n.date,"YYYYMMDD"),"day")?"HH:mm":"MM. DD HH:mm"):"")+"</div></div><span class='tui-full-calendar-weekday-schedule-bullet' style='top:8px;right:0;left:unset;background:"+a.borderColor+"' title='"+a.name+"'></span></div>"}))})}else o="<div class='m-auto'>ë“±ë¡ëœ ì¼ì •ì´ ì—†ì–´ìš”.</div>";return o}(e.data)),u("#mainTaskContents input").on("change",function(e){e.stopPropagation();var t=u(this).parent();NMNS.history.push({id:t.data("id"),category:"task",isDone:!u(this).prop("checked")}),NMNS.socket.emit("update reserv",{id:t.data("id"),type:"T",isDone:u(this).prop("checked")})}),u("#mainTaskContents .task").on("touch click",function(e){e.stopPropagation();var t=u(this).parent();Y({id:t.data("id"),name:t.data("name"),start:t.data("start"),end:t.data("end"),calendarId:t.data("calendar-id"),category:"task"}),x.call(u(".taskDetailLink"),e)})})),NMNS.socket.on("update info",socketResponse("ë§¤ì¥ ì •ë³´ ë³€ê²½í•˜ê¸°",function(){showSnackBar("<span>ì •ìƒì ìœ¼ë¡œ ë§¤ì¥ ì •ë³´ë¥¼ ë³€ê²½í•˜ì˜€ìŠµë‹ˆë‹¤.</span>"),NMNS.history.remove("info",findById)},function(e){var t=NMNS.history.find(function(e){return"info"===e.id});(t.bizBeginTime||t.bizEndTime)&&NMNS.calendar.setOptions({week:{hourStart:t.bizBeginTime?t.bizBeginTime.substring(0,2):NMNS.info.bizBeginTime.substring(0,2),hourEnd:t.bizEndTime?t.bizEndTime.substring(0,2):NMNS.info.bizEndTime.substring(0,2)}}),t.shopName&&N(t.shopName),NMNS.info.shopName=t.shopName||NMNS.info.shopName,NMNS.info.bizType=t.bizType,NMNS.history.remove("info",findById),NMNS.initedInfoModal=!1})),NMNS.socket.on("update alrim",socketResponse("ì•Œë¦¼í†¡ ì •ë³´ ë³€ê²½í•˜ê¸°",function(){showSnackBar("<span>ì •ìƒì ìœ¼ë¡œ ì•Œë¦¼í†¡ ì •ë³´ë¥¼ ë³€ê²½í•˜ì˜€ìŠµë‹ˆë‹¤.</span>"),NMNS.history.remove("alrimInfo",findById)},function(){var t=NMNS.history.find(function(e){return"alrimInfo"===e.id});Object.keys(t).forEach(function(e){NMNS.info.alrimTalkInfo[e]=t[e]}),NMNS.history.remove("alrimInfo",findById),NMNS.initedAlrimModal=!1})),NMNS.socket.on("get noshow",socketResponse("ë…¸ì‡¼ ì •ë³´ ê°€ì ¸ì˜¤ê¸°",function(t){if(0<t.data.summary.noShowCount){if(u("#noShowClean").removeClass("d-flex").addClass("d-none"),u("#noShowDirtyImage").attr("src")||u("#noShowDirtyImage").attr("src","/nmns/img/badperson.png"),u("#myNoShowCount").text(t.data.detail.length),u("#otherNoShowCount").text(Math.max(t.data.summary.noShowCount-t.data.detail.length,0)),t.data.summary.lastNoShowDate&&u("#noShowSearchSummary").text("ë§ˆì§€ë§‰ ë…¸ì‡¼ëŠ” "+moment(t.data.summary.lastNoShowDate,"YYYYMMDD").format("YYYYë…„ Mì›” Dì¼ì…ë‹ˆë‹¤.")),0<t.data.detail.length){var a="";t.data.detail.forEach(function(e){a+="<div class='row col-12 noShowRow' data-id='"+e.id+"' data-contact='"+(t.data.summary.contact||"")+"' data-date='"+(e.date||"")+"' data-noshowcase='"+(e.noShowCase||"")+"'><div class='col-3 px-0'>ë…¸ì‡¼ ë‚ ì§œ</div><div class='col-9 pl-0 montserrat'>"+(e.date?e.date.substring(0,4)+". "+e.date.substring(4,6)+". "+e.date.substring(6):"")+"</div><div class='col-3 px-0'>ì „í™”ë²ˆí˜¸</div><div class='col-9 pl-0 montserrat'>"+(t.data.summary.contact?dashContact(t.data.summary.contact):"")+"</div><div class='col-3 px-0'>ë…¸ì‡¼ ì‚¬ìœ </div><div class='col-9 pl-0'>"+(e.noShowCase||"")+"</div><div class='noShowSearchDelete'><span title='ì‚­ì œ'>&times;</span></div></div>"}),u("#noShowSearchList").html(a),u("#noShowSearchList .noShowSearchDelete").on("touch click",function(){E(u(this))})}u("#noShowDirty").removeClass("d-none").addClass("d-flex")}else u("#noShowDirty").removeClass("d-flex").addClass("d-none"),u("#noShowClean").removeClass("d-none").addClass("d-flex"),u("#noShowImage").attr("src")||u("#noShowImage").attr("src","/nmns/img/goodperson.png"),u("#noShowSentense").text(["ì•ˆì‹¬í•˜ì„¸ìš”. ë…¸ì‡¼ë¥¼ í•˜ì‹  ì ì´ ì—†ì–´ìš”!","ì´ë¶„ ìµœì†Œ ë°°ìš°ì‹ ë¶„!! ë…¸ì‡¼ ì´ë ¥ì´ ì—†ì–´ìš”.","ë…¸ì‡¼ë¥¼ í•˜ì‹  ì ì´ ì—†ì–´ìš”! ê²©í•˜ê²Œ í™˜ì˜í•´ì£¼ì„¸ìš”~~"][Math.floor(3*Math.random())])})),NMNS.socket.on("add noshow",socketResponse("ë…¸ì‡¼ ì¶”ê°€í•˜ê¸°",function(e){showSnackBar("<span>ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤! ë‹¤ë¥¸ ë¶„ë“¤ì—ê²Œ ë§ì€ ë„ì›€ì´ ë ê±°ì—ìš” :)</span>")})),NMNS.socket.on("delete noshow",socketResponse("ë…¸ì‡¼ ì‚­ì œí•˜ê¸°",function(e){NMNS.history.remove(e.data.id,findById)},function(t){if(t&&t.data){var e=NMNS.history.find(function(e){return e.id===t.data.id});if(e){var a=u("<div class='row col-12 noShowRow' data-id='"+e.id+"' data-contact='"+(e.contact||"")+"' data-date='"+(e.date||"")+"' data-noshowcase='"+(e.noShowCase||"")+"'><div class='col-3 px-0'>ë…¸ì‡¼ ë‚ ì§œ</div><div class='col-9 pl-0 montserrat'>"+(e.date?e.date.substring(0,4)+". "+e.date.substring(4,6)+". "+e.date.substring(6):"")+"</div><div class='col-3 px-0'>ì „í™”ë²ˆí˜¸</div><div class='col-9 pl-0 montserrat'>"+(e.contact?dashContact(e.contact):"")+"</div><div class='col-3 px-0'>ë…¸ì‡¼ ì‚¬ìœ </div><div class='col-9 pl-0'>"+(e.noShowCase||"")+"</div><div class='noShowSearchDelete'><span title='ì‚­ì œ'>&times;</span></div></div>");a.find(".noShowSearchDelete").off("touch click").on("touch click",function(){E(u(this))}),u("#noShowSearchList .empty").length?u("#noShowSearchList").html(a):u("#noShowSearchList .noShowSearchAdd").length?a.insertBefore("#noShowSearchList .noShowSearchAdd:first-child"):u("#noShowSearchList").append(a)}}})),NMNS.socket.on("update password",socketResponse("ë¹„ë°€ë²ˆí˜¸ ë³€ê²½í•˜ê¸°")),NMNS.socket.on("get customer info",socketResponse("ìë™ì™„ì„± ìë£Œ ê°€ì ¸ì˜¤ê¸°",function(e){if(e.data.id){var t=u("#"+e.data.id);t.autocomplete().onSuccess.call(t.autocomplete(),e.data.query,e.data.result)}},function(e){if(e.data.id){var t=u("#"+e.data.id);t.autocomplete().onFail.call(t.autocomplete(),e.data)}},!0)),NMNS.socket.on("get customer",socketResponse("ê³ ê° ì •ë³´ ê°€ì ¸ì˜¤ê¸°",function(e){var t=u(".scheduleMenu");if(t.is(":visible")){if(e.data.contact===t.find("#scheduleContact").val().replace(/-/gi,"")&&t.data("contact")!==e.data.contact||e.data.name===t.find("#scheduleName").val()&&t.data("name")!==e.data.name){if(e.data.etc&&t.find("#scheduleEtc").val(e.data.etc),e.data.manager){var a=c(e.data.manager);a&&t.find("#scheduleManager").html(t.find("#scheduleManager").next().find("button[data-calendar-id='"+a.id+"']").html()).data("calendar-id",a.id)}e.data.contents&&t.find("#scheduleTabContents").append(b(e.data.contents)).find("button").off("touch click").on("touch click",function(){C(this)}),e.data.name&&""===t.find("#scheduleName").val()&&t.find("#scheduleName").val(e.data.name),e.data.contact&&""===t.find("#scheduleContact").val().replace(/-/gi,"")&&t.find("#scheduleContact").val(e.data.contact)}void 0!==e.data.totalNoShow&&0<e.data.totalNoShow&&t.find("#scheduleContact").is(":visible")&&(t.find("#scheduleContact").tooltip({title:"ì´ ë²ˆí˜¸ì—ëŠ” ì´ "+e.data.totalNoShow+"ê±´ì˜ ë…¸ì‡¼ê°€ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤."+(e.data.myNoShow&&0<e.data.myNoShow?"<br/>ìš°ë¦¬ ë§¤ì¥ì—ì„œëŠ” "+e.data.myNoShow+"ê±´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.":""),placement:"top",trigger:"click hover focus",delay:{hide:1e3},html:!0}).tooltip("show"),setTimeout(function(){t.find("#scheduleContact").tooltip("hide")},3e3),t.find("#scheduleContact").one("keyup change",function(){u(this).tooltip("dispose")}))}},void 0,!0)),NMNS.socket.on("message",socketResponse("ì„œë²„ ë©”ì‹œì§€ ë°›ê¸°",function(e){"push"===e.type?e.data.forEach(function(e){showNotification(e)}):"alert"===e.type&&(showSnackBar(e.data.body),0<e.data.body.indexOf("ìƒˆë¡œìš´ ê³ ê°ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤")&&(NMNS.customerList=null))},void 0,!0)),NMNS.socket.on("get alrim history",socketResponse("ì•Œë¦¼í†¡ ë‚´ì—­ ì¡°íšŒ",function(e){!function(e){var t=u("#alrimHistoryList");if(e&&0<e.length){var a="",n=u("#alrimHistoryList .alrimRow").length;e.forEach(function(e,t){a+='<div class="d-flex alrimRow col" title="ëˆŒëŸ¬ì„œ ì „ì†¡ëœ ì•Œë¦¼í†¡ ë‚´ìš© ë³´ê¸°"><a href="#alrimDetail'+(t+n)+'" class="alrimDetailLink collapsed" data-toggle="collapse" role="button" aria-expanded="false" aria-controls="alrimDetail'+(t+n)+'"></a><div class="col-4 pl-0 text-left montserrat">'+moment(e.date,"YYYYMMDDHHmm").format("YYYY. MM. DD")+'</div><div class="col-3 px-0 ellipsis">'+(e.name||"(ì´ë¦„ ì—†ìŒ)")+'</div><div class="col-4 px-0 montserrat">'+dashContact(e.contact)+'</div><div class="col-1 px-0"></div></div><div class="row alrimDetailRow collapse col-12" id="alrimDetail'+(t+n)+'">'+(e.contents?e.contents.replace(/\n/g,"<br>"):"")+"</div>",0<t&&t%50==0&&(u("#alrimHistoryList").append(a),a="")}),t.append(a),u("#alrimHistoryList .alrimDetailLink").off("touch click").on("touch click",function(){u(this).parent().toggleClass("show"),u(this).parent().hasClass("show")&&((document.scrollingElement||document.documentElement).scrollTop=u(this).offset().top-(u("html,body").height()-u(this).outerHeight(!0))/2)})}else t.append("<div class='row alrimRow'><span class='col-12 text-center'>ê²€ìƒ‰ëœ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</span></div>")}(e.data)},void 0,!0)),NMNS.socket.on("resend alrimtalk",socketResponse("ì•Œë¦¼í†¡ ë‹¤ì‹œ ë³´ë‚´ê¸°",function(e){u("#resendAlrimScheduleBtn").addClass("d-none"),showSnackBar("<span>ê³ ê°ì—ê²Œ ì•Œë¦¼í†¡ì„ ë‹¤ì‹œ ë³´ëƒˆìŠµë‹ˆë‹¤!</span>")},function(e){u("#resendAlrimScheduleBtn").addClass("d-none"),showSnackBar("<span>"+e.message||"ì•Œë¦¼í†¡ì„ ë‹¤ì‹œ ë³´ë‚´ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</span>")}),!0),NMNS.socket.on("get announcement",socketResponse("ê³µì§€ì‚¬í•­ ì¡°íšŒ",function(e){if(u("#announcementArea .flex-column").remove(),0<e.data.announcement.length){var t=u(function(e){var t="";return e&&e.forEach(function(e){switch(e.type){case"SCHEDULE_ADDED":t+='<div class="notification"><div class="d-flex align-items-center"><span>'+(e.title?"ê³ ê°ëª… : "+e.title:"ê³ ê°ë²ˆí˜¸ : "+e.contact)+'</span><span class="d-flex ml-auto montserrat notificationTime">'+(e.registeredDate?moment(e.registeredDate,"YYYYMMDDHHmm").isSame(moment(),"day")?moment(e.registeredDate,"YYYYMMDDHHmm").format("HH:mm"):moment(e.registeredDate,"YYYYMMDDHHmm").format("MM. DD"):"")+"</span></div><div><p>"+(e.title?"ê³ ê°ë²ˆí˜¸ : "+dashContact(e.contact):"")+"<br>ì˜ˆì•½ë‚ ì§œ : "+moment(e.start,"YYYYMMDDHHmm").format("YYYY. MM. DD")+"<br>ì˜ˆì•½ì‹œê°„ : "+moment(e.start,"YYYYMMDDHHmm").format("HHì‹œ mmë¶„")+(e.contents?"<br>ì˜ˆì•½ë‚´ìš© : "+e.contents:"")+'</p></div><div><span class="text-accent font-weight-bold" style="font-size:14px">ì˜ˆì•½ ë“±ë¡</span></div></div>';break;case"SCHEDULE_CANCELED":t+='<div class="notification"><div class="d-flex align-items-center"><span>'+(e.title?"ê³ ê°ëª… : "+e.title:"ê³ ê°ë²ˆí˜¸ : "+e.contact)+'</span><span class="d-flex ml-auto montserrat notificationTime">'+(e.registeredDate?moment(e.registeredDate,"YYYYMMDDHHmm").isSame(moment(),"day")?moment(e.registeredDate,"YYYYMMDDHHmm").format("HH:mm"):moment(e.registeredDate,"YYYYMMDDHHmm").format("MM. DD"):"")+"</span></div><div><p>"+(e.title?"ê³ ê°ë²ˆí˜¸ : "+dashContact(e.contact):"")+"<br>ì˜ˆì•½ë‚ ì§œ : "+moment(e.start,"YYYYMMDDHHmm").format("YYYY. MM. DD")+"<br>ì˜ˆì•½ì‹œê°„ : "+moment(e.start,"YYYYMMDDHHmm").format("HHì‹œ mmë¶„")+'</p></div><div class="d-flex align-items-center"><span class="text-accent font-weight-bold" style="font-size:14px">ì˜ˆì•½ ì·¨ì†Œ</span><span class="d-flex ml-auto addAnnouncementNoShow cursor-pointer" style="font-size:11px" data-schedule-id="'+e.id+'">ì§ì „ì·¨ì†Œë¡œ ë…¸ì‡¼ë“±ë¡ &gt;</span></div></div>';break;case"ANNOUNCEMENT":default:t+='<div class="announcement"><div class="d-flex align-items-center" style="margin-bottom:15px"><span class="announcementTitle">'+e.title+'</span><span class="d-flex ml-auto montserrat announcementTime">'+(e.registeredDate?moment(e.registeredDate,"YYYYMMDDHHmm").isSame(moment(),"day")?moment(e.registeredDate,"YYYYMMDDHHmm").format("HH:mm"):moment(e.registeredDate,"YYYYMMDDHHmm").format("MM. DD"):"")+"</span></div><div><p>"+e.contents+'</p></div><div><span class="text-accent font-weight-bold" style="font-size:14px">ê³µì§€ì‚¬í•­</span></div></div>'}}),t}(e.data.announcement));t.find(".addAnnouncementNoShow").on("touch click",function(){NMNS.socket.emit("update reserv",{id:u(this).data("schedule-id"),status:"NOSHOW",noShowCase:"ì§ì „ì·¨ì†Œ"})}),u("#announcementArea").append(t).removeClass("d-flex")}else 1===NMNS.announcementPage&&u("#announcementArea").append("<div class='m-auto text-center' style='font-size:14px;line-height:1.71'>ì•„ì§ ì•Œë¦¼ë‚´ì—­ì´ ì—†ì–´ìš”.<br>ê³µì§€ì‚¬í•­, ì˜ˆì•½ ë“±ë¡ ë‚´ì—­, ì˜ˆì•½ ì·¨ì†Œ<br>ë‚´ì—­ì´ ë³´ì—¬ì§‘ë‹ˆë‹¤.</div>").addClass("d-flex");var a=NMNS.info.newAnnouncement;if(a&&0<a){var n=0;e.data.schedule.forEach(function(e){e.isRead||n++}),e.data.announcement.forEach(function(e){e.isRead||n++}),n<a?(u(".announcementCount").text(99<a-n?"99+":a-n),NMNS.info.newAnnouncement=a-n,u("#announcementIcon").addClass("icon-announcement-count")):(u(".announcementCount").text(""),NMNS.info.newAnnouncement=0,u("#announcementIcon").removeClass("icon-announcement-count"))}5<=e.data.schedule.length+e.data.announcement.length?NMNS.expectMoreAnnouncement=!0:NMNS.expectMoreAnnouncement=!1})),NMNS.socket.on("get menu list",socketResponse("ë©”ë‰´ ëª©ë¡ ì¡°íšŒ",function(e){u("#scheduleTabContentList").length&&u("#scheduleTabContentList").html(w(e.data)),NMNS.menuList=e.data,u("#mainMenuList").is(":visible")&&NMNS.drawMenuList&&NMNS.drawMenuList(!0)},void 0,!0)),NMNS.socket.on("get reserv sales",socketResponse("ë§¤ì¶œ ì •ë³´ ê°€ì ¸ì˜¤ê¸°",function(e){u("#salesBtn").removeClass("disabled"),u("#salesLoading").hide(),u("#salesForm").show()})),NMNS.socket.on("save sales",socketResponse("ë§¤ì¶œ ë‚´ì—­ ì €ì¥",function(e){showSnackBar("ë§¤ì¶œ ë‚´ì—­ì„ ì €ì¥í•˜ì˜€ìŠµë‹ˆë‹¤."),u("#salesTab").is(":visible")&&u("#scheduleModal").modal("hide")})).on("link sns",socketResponse("SNS ê³„ì • ì—°ê²°",function(e){"NAVER"===e.data.snsType&&(NMNS.info.naver=e.data.snsLinkId,u("#naverBtn").is(":visible")&&u("#naverBtn").addClass("connected")),"KAKAO"===e.data.snsType&&(NMNS.info.kakao=e.data.snsLinkId,u("#kakaoBtn").is(":visible")&&u("#kakaoBtn").addClass("connected"))},function(e){"KAKAO"===e.data.snsType&&alert("ì¹´ì¹´ì˜¤í†¡ê³¼ì˜ ì—°ë™ì„ í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì¹´ì¹´ì˜¤í†¡ì—ì„œ ì—°ë™ì„ í•´ì œí•œ ë’¤ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")},!0)),u(".modal").on("shown.bs.modal",function(){u(".modal-backdrop").one("touch click",function(e){u(".modal.show").modal("hide")})}),u("#cancelStoreBtn").on("touch click",function(){if("INPUT"===document.activeElement.tagName)return!1;var e=!1;if(u("#infoBizBeginTime").val()!==NMNS.info.bizBeginTime&&(e=!0),e||u("#infoBizEndTime").val()===NMNS.info.bizEndTime||(e=!0),e||u("#infoShopName").val()===(NMNS.info.shopName||"")||(e=!0),e||u("#infoBizType").val()===(NMNS.info.bizType||"")||(e=!0),e&&!confirm("ì €ì¥ë˜ì§€ ì•Šì€ ë³€ê²½ë‚´ì—­ì´ ìˆìŠµë‹ˆë‹¤. ê³„ì† í•˜ì‹œê² ì–´ìš”?"))return u(this).blur(),!1;history.back()}),u(".storeLink").one("touch click",function(){u("#storeBtn").off("touch click").on("touch click",M)}).on("touch click",function(){u("#infoEmail").text(NMNS.email),u("#infoAuthStatus").html("BEFORE_EMAIL_VERIFICATION"===NMNS.info.authStatus?u(g(NMNS.info.authStatus)).on("touch click",function(){NMNS.socket.emit("send verification",{}),showSnackBar("<span>ì¸ì¦ë©”ì¼ì„ ë³´ëƒˆìŠµë‹ˆë‹¤. ë„ì°©í•œ ì´ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”!</span>")}):g(NMNS.info.authStatus)),u("#infoShopName").val(NMNS.info.shopName),u("#infoBizType").val(NMNS.info.bizType),u("#infoBizBeginTime").val(NMNS.info.bizBeginTime),u("#infoBizEndTime").val(NMNS.info.bizEndTime)}),u("#cancelAlrimBtn").on("touch click",function(){if("INPUT"===document.activeElement.tagName)return!1;if(u("#alrimShopName").is(":visible")){var e=!1;if((u("#alrimUseYn").prop("checked")&&"Y"!==NMNS.info.alrimTalkInfo.useYn||!u("#alrimUseYn").prop("checked")&&"N"!==NMNS.info.alrimTalkInfo.useYn)&&(e=!0),e||u("#alrimShopName").val()===(NMNS.info.shopName||"")||(e=!0),e||u("#alrimCallbackPhone").val().replace(/-/gi,"")===(NMNS.info.alrimTalkInfo.callbackPhone||"")||(e=!0),e||u("#alrimCancelDue").val()===(NMNS.info.alrimTalkInfo.cancelDue||"")||(e=!0),e||u("#alrimNotice").val()===(NMNS.info.alrimTalkInfo.notice||"")||(e=!0),e&&!confirm("ì €ì¥ë˜ì§€ ì•Šì€ ë³€ê²½ë‚´ì—­ì´ ìˆìŠµë‹ˆë‹¤. ì°½ì„ ë‹«ìœ¼ì‹œê² ì–´ìš”?"))return!1}history.back()}),u(".alrimLink").on("touch click",function(){S(),u("#alrimTabList a[data-target='#alrimTab']").tab("show")}).one("touch click",function(){u("#labelAlrimUseYn").on("touch click",function(){u(this).next().children("label").trigger("click")}),u("#alrimNotice").on("blur",function(){u(this).val(removeNonCharacter(u(this).val()))}),u("#alrimUseYn").off("change").on("change",function(){u(this).prop("checked")?u("#alrimScreen").hide():u("#alrimScreen").show()}),u("#alrimInfoBtn").off("touch click").on("touch click",v),u("#alrimHistorySearch").off("touch click").on("touch click",function(){var e={};""!==u("#alrimHistoryTarget").val()&&(e.target=u("#alrimHistoryTarget").val()),u("#alrimHistoryList .row").remove(),NMNS.socket.emit("get alrim history",e)}),u("#alrimHistoryTarget").off("keyup").on("keyup",function(e){13===e.which&&u("#alrimHistorySearch").trigger("click")})}),u("#noShowModal").on("hide.bs.modal",function(){if("INPUT"===document.activeElement.tagName)return!1}).on("show.bs.modal",function(e){u(e.relatedTarget).hasClass("getNoShowLink")?u("#noShowTabList .nav-link[href='#noShowSearch']").tab("show"):u(e.relatedTarget).hasClass("addNoShowLink")&&u("#noShowTabList .nav-link[href='#noShowAdd']").tab("show")}),u("#scheduleModal").on("hide.bs.modal",function(){NMNS.scheduleTarget&&NMNS.scheduleTarget.guide&&NMNS.scheduleTarget.guide.clearGuideElement(),delete NMNS.scheduleTarget}).on("hidden.bs.modal",function(){u("#scheduleName").val(""),u("#scheduleTabContents").html(b("")).find("button").off("touch click").on("touch click",function(){C(this)}),u("#scheduleContact").val("")}),u("#showTutorial").on("touch click",function(){if(document.getElementById("tutorialScript"))u("#tutorialModal").modal();else{var e=document.createElement("script");e.src="/nmns/js/tutorial.min.js",e.id="tutorialScript",document.body.appendChild(e),e.onload=function(){u("#tutorialModal").modal()}}}),u(".announcementMenuLink").on("touch click",function(){NMNS.announcementPage||(NMNS.announcementPage=1,NMNS.socket.emit("get announcement",{page:1,combined:!0}))}),u("#exitDetailMenu").on("touch click",function(){history.back()}),u("#mainMenu").on("shown.bs.popover",function(){u(".mainMenuRow a[data-link]").off("touch click").on("touch click",function(e){u("#mainMenu").popover("hide"),u(u(this).data("link")).modal("show")}),u("#signoutLink").on("touch click",function(){NMNS.socket.close()})}),u("html").on("click",function(e){0<u("body").children(".popover.show").length&&void 0===u(e.target).data("original-title")&&!u(e.target).parents().is(".popover.show")&&0===u(e.target).parents('[data-toggle="popover"]').length&&u("body").children(".popover.show").popover("hide")}),u("#alrimTabList a[data-target='#alrimTab']").on("show.bs.tab",S),u("#alrimTabList a[data-target='#alrimHistoryTab']").on("show.bs.tab",function(){u("#alrimHistorySearch").trigger("click")}),u("#scheduleTabList a[data-target='#scheduleTab']").on("touch click",function(){u(this).next().hasClass("active")&&D("switch")}),u("#scheduleTabList a[data-target='#salesTab']").one("show.bs.tab",function(){u("#salesBtn").on("touch click",function(e){if(e.preventDefault(),u(this).hasClass("disabled"))alert("ì…ë ¥í•œ ê¸ˆì•¡ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");else{var o,i=[];u("#salesTab .scheduleSalesPayments").each(function(e,t){var a={},n=u(t);a.id=n.data("id"),a.customerId=n.data("customer-id"),a.managerId=n.data("manager-id"),a.scheduleId=n.data("schedule-id"),a.type=n.data("type"),a.item=n.data("item"),a.price=n.data("is-registered")?n.find(".scheduleSalesPayment:checked").data("price"):n.find(".scheduleSalesPaymentPrice").val(),n.data("is-registered")||""!==a.price?a.price*=1:o=e,Number.isInteger(a.price)||(o=e),i.push(a)}),0<=o?alert(o+1+"ë²ˆì§¸ ë§¤ì¶œ("+i[o].item+")ì˜ ë§¤ì¶œì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."):NMNS.socket.emit("save sales",i)}})}).on("show.bs.tab",function(){return!(!NMNS.scheduleTarget||!NMNS.scheduleTarget.schedule)&&(u("#salesLoading").show(),u("#salesForm").hide(),u("#salesBtn").addClass("disabled"),NMNS.socket.emit("get reserv sales",{scheduleId:NMNS.scheduleTarget.schedule.id}),!0)}),u(".userLink").one("touch click",function(){u("#resetPasswordBtn").on("touch click",function(){0!==u("#currentPassword").val().length?0!==u("#newPassword").val().length?0!==u("#renewPassword").val().length?u("#newPassword").val()===u("#renewPassword").val()?(NMNS.socket.emit("update password",{currentPassword:u("#currentPassword").val(),newPassword:u("#newPassword").val()}),u("#currentPassword").val(""),u("#newPassword").val(""),u("#renewPassword").val("")):showSnackBar("ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."):showSnackBar("ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ í•œ ë²ˆ ë” ì…ë ¥í•´ì£¼ì„¸ìš”."):showSnackBar("ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."):showSnackBar("í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")}),u("#naverBtn").on("touch click",function(e){if(u(this).hasClass("connected"))return e.stopImmediatePropagation(),!1;e.preventDefault()})}).on("touch click",function(){if(NMNS.info.kakaotalk&&u("#kakaoBtn").addClass("connected").find("span").text("ì¹´ì¹´ì˜¤ ê³„ì • ì—°ë™ ì™„ë£Œ"),NMNS.info.naver&&u("#naverBtn").addClass("connected").find("span").text("ë„¤ì´ë²„ ê³„ì • ì—°ë™ ì™„ë£Œ"),!u("#naverBtn").hasClass("connected")&&!document.getElementById("naverScript")){var e=document.createElement("script");e.src="/nmns/js/naver.min.js",e.id="naverScript",document.body.appendChild(e),e.onload=function(){new naver.LoginWithNaverId({clientId:"5dHto9KiEXdHoHJBDcqE",callbackUrl:window.location.origin+"/naver",isPopup:!0,loginButton:{color:"green",type:1,height:20}}).init()}}if(!u("#kakaoBtn").hasClass("connected")&&!document.getElementById("kakaoScript")){var t=document.createElement("script");t.src="/nmns/js/kakao.min.js",t.id="kakaoScript",document.body.appendChild(t),t.onload=function(){Kakao.init("0bc4ec615d313261ebfd5ac0fe9c055f"),u("#kakaoBtn").on("touch click",function(){u(this).hasClass("connected")||Kakao.Auth.login({success:function(e){Kakao.API.request({url:"/v2/user/me",success:function(e){NMNS.socket.emit("link sns",{snsLinkId:e.for_partner.uuid,snsEmail:e.for_partner.properties.email,snsType:"KAKAO"})},fail:function(e){alert("ì¹´ì¹´ì˜¤ ì„œë²„ì™€ ì—°ê²°í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")}})},fail:function(e){alert("ì—°ê²°ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤."),console.log(JSON.stringify(e))}})})}}u("#currentPassword").val(""),u("#newPassword").val(""),u("#renewPassword").val("")}),u("#mainCalendarRange").on("touch click",function(){u("#mainCalendarCarousel, #mainCalendarCalendar").toggle(),NMNS.siema&&NMNS.siema.resizeHandler(),NMNS.siemaCalendar&&NMNS.siemaCalendar.resizeHandler(),u("#mainCalendar").toggleClass("pushedDown"),u("#mainCalendarCalendar").is(":visible")&&(u("#mainCalendarRangeInput1")[0]._flatpickr?document.getElementById("mainCalendarRangeInput"+(NMNS.siemaCalendar.currentSlide+1))._flatpickr.setDate(NMNS.calendar.getDate().toDate()):(flatpickr("#mainCalendarRangeInput1",{dateFormat:"Ymd",locale:"ko",disableMobile:!0,appendTo:u(".mainCalendarCalendarMonth[data-index='1']")[0],clickOpens:!1,onChange:r("#mainCalendarRangeInput1")}),flatpickr("#mainCalendarRangeInput2",{dateFormat:"Ymd",locale:"ko",defaultDate:NMNS.calendar.getDate().toDate(),disableMobile:!0,appendTo:u(".mainCalendarCalendarMonth[data-index='2']")[0],clickOpens:!1,onChange:r("#mainCalendarRangeInput2")}),flatpickr("#mainCalendarRangeInput3",{dateFormat:"Ymd",locale:"ko",disableMobile:!0,appendTo:u(".mainCalendarCalendarMonth[data-index='3']")[0],clickOpens:!1,onChange:r("#mainCalendarRangeInput3")}),NMNS.siemaCalendar=new Siema({selector:"#mainCalendarCalendar",duration:200,easing:"ease-out",perPage:1,startIndex:1,draggable:!0,multipleDrag:!1,threshold:20,loop:!0,rtl:!1,onChange:s}),document.getElementById("mainCalendarRangeInput1")._flatpickr.jumpToDate(moment(NMNS.calendar.getDate().toDate()).add(-1,"month").toDate()),document.getElementById("mainCalendarRangeInput3")._flatpickr.jumpToDate(moment(NMNS.calendar.getDate().toDate()).add(1,"month").toDate()))),f()}),NMNS.socket.emit("get noti"),NMNS.socket.on("get noti",socketResponse("ì„œë²„ ë©”ì‹œì§€ ë°›ê¸°",function(e){e.data.data.forEach(function(e){showNotification(e)})})),u(".customerMenuLink").off("touch click").on("touch click",function(){var e=u("#customerSortTypeMenu").data("action");if(!document.getElementById("customerStyle")){var t=document.createElement("link");t.rel="stylesheet",t.href="/nmns/css/customer.mobile.min.css",t.id="customerStyle",document.head.appendChild(t)}if(document.getElementById("customerScript"))NMNS.customerList&&NMNS.customerList!==[]||NMNS.socket.emit("get customer list",{type:"all",target:""===u("#customerSearchTarget").val()?void 0:u("#customerSearchTarget").val(),sort:e});else{var a=document.createElement("script");a.src="/nmns/js/customer.mobile.min.js",a.id="customerScript",document.body.appendChild(a),a.onload=function(){NMNS.socket.emit("get customer list",{type:"all",target:""===u("#customerSearchTarget").val()?void 0:u("#customerSearchTarget").val(),sort:e}),u("#customerManagerList").html(y()).off("touch click","button").on("touch click","button",function(){u("#customerManager").data("calendar-id",u(this).data("calendar-id")).data("color",u(this).data("color")).html(u(this).html())})}}u("#customerAddManager").next().html("<button type='button' class='dropdown-item tui-full-calendar-dropdown-item' data-calendar-id='' data-bgcolor='#b2dfdb'><span class='tui-full-calendar-icon tui-full-calendar-calendar-dot' style='background-color:#b2dfdb'></span><span class='tui-full-calendar-content'>(ë‹´ë‹¹ì ì—†ìŒ)</span></button>").append(y()).off("touch click","button").on("touch click","button",function(){u("#customerAddManager").data("calendar-id",u(this).data("calendar-id")).data("bgcolor",u(this).data("bgcolor")).html(u(this).html())}),u("#customerAddManager").html("<span class='tui-full-calendar-icon tui-full-calendar-calendar-dot' style='background-color: "+NMNS.calendar.getCalendars()[0].bgColor+"'></span><span class='tui-full-calendar-content'>"+NMNS.calendar.getCalendars()[0].name+"</span>").data("calendar-id",NMNS.calendar.getCalendars()[0].id).data("bgcolor",NMNS.calendar.getCalendars()[0].bgColor),u("#customerManager").next().html("<button type='button' class='dropdown-item tui-full-calendar-dropdown-item' data-calendar-id='' data-bgcolor='#b2dfdb'><span class='tui-full-calendar-icon tui-full-calendar-calendar-dot' style='background-color:#b2dfdb'></span><span class='tui-full-calendar-content'>(ë‹´ë‹¹ì ì—†ìŒ)</span></button>").append(y()).off("touch click","button").on("touch click","button",function(){u("#customerManager").data("calendar-id",u(this).data("calendar-id")).data("bgcolor",u(this).data("bgcolor")).html(u(this).html())})}),u(".menuMenuLink").one("touch click",function(){if(!document.getElementById("menuStyle")){var e=document.createElement("link");e.rel="stylesheet",e.href="/nmns/css/menu.mobile.min.css",e.id="menuStyle",document.head.appendChild(e)}if(!document.getElementById("menuScript")){var t=document.createElement("script");t.src="/nmns/js/menu.mobile.min.js",t.id="menuScript",document.body.appendChild(t),t.onload=function(){NMNS.socket.emit("get menu list",null)}}u(this).on("touch click",function(){NMNS.socket.emit("get menu list",null)})}),u(".salesMenuLink").one("touch click",function(){if(!document.getElementById("salesStyle")){var e=document.createElement("link");e.rel="stylesheet",e.href="/nmns/css/sales.mobile.min.css",e.id="salesStyle",document.head.appendChild(e)}if(document.getElementById("salesScript"))u(".salesMenu .menuTitle").removeClass("fixedScroll"),u(".salesSearchSwitch").hide(),u("#mainSalesSearch").show();else{var t=document.createElement("script");t.src="/nmns/js/sales.mobile.min.js",t.id="salesScript",document.body.appendChild(t),t.onload=function(){u("#salesSearchButton").removeClass("disabled")},u("#salesSearchName").autocomplete({serviceUrl:"get customer info",paramName:"name",zIndex:1060,maxHeight:150,triggerSelectOnValidInput:!1,transformResult:function(e){return e.forEach(function(e){e.data=e.contact,e.value=e.name,delete e.contact,delete e.name}),{suggestions:e}},onSearchComplete:function(){},formatResult:function(e){return e.value+" ("+dashContact(e.data)+")"},onSearchError:function(){},onSelect:function(e){u("#scheduleContact").val(e.data).trigger("blur")}},NMNS.socket),u("#salesSearchStartDate").val(moment().startOf("month").format("YYYY. MM. DD")),u("#salesSearchEndDate").val(moment().format("YYYY. MM. DD")),flatpickr("#salesCalendar",{dateFormat:"Y. m. d",defaultDate:[moment().startOf("month").toDate(),new Date],mode:"range",disableMobile:!0,appendTo:document.getElementById("salesCalendarArea"),locale:"ko",onChange:function(e,t,a){2===e.length&&u("#salesCalendarModal").modal("hide")}});var a=moment();u("#mainSalesSearch .activable").each(function(e,t){t.innerHTML='<span class="montserrat">'+a.format("M")+"</span>ì›”",a.add(-1,"month")}),u("#salesSearchManagerList").html(y(!0)).off("touch click","button").on("touch click","button",function(){u("#salesSearchManager").data("calendar-id",u(this).data("calendar-id")).data("color",u(this).data("color")).html(u(this).html())})}}),NMNS.switchMenu=x,function(){if(u(".moveDate").on("touch click",l),u("#lnbManagerList").on("change",m),u(".addNoShowLink").one("touch click",k),window.addEventListener("resize",debounce(function(){NMNS.calendar.render()},200)),flatpickr.localize("ko"),u(".taskMenu").on("touch click",d),u("#sidebarToggler").on("touch click",function(){u("#mainAside").addClass("sidebar-toggled"),u(document.body).addClass("modal-open").append(u('<div class="modal-backdrop fade show" style="z-index:2"></div>').on("touch click",function(e){e.preventDefault(),e.stopPropagation(),u(this).remove(),u(document.body).removeClass("modal-open"),u("#mainAside").removeClass("sidebar-toggled")}))}),u("#searchNoShow").on("keyup",function(e){13!==e.keyCode&&13!==e.which||u(this).prev().trigger("click")}).prev().on("touch click",function(){11===u(this).next().val().replace(/-/gi,"").length||10===u(this).next().val().replace(/-/gi,"").length?(u(".calendarMenuLink").hasClass("menuLinkActive")||(u(".switchingMenu:not(.calendarMenu)").hide(),u("#mainRow").removeClass("fixedScroll"),u(".menuLinkActive").removeClass("menuLinkActive"),u(".calendarMenuLink").addClass("menuLinkActive"),u("#mainTask").removeClass("show")),u(".calendarMenu").removeClass("fixedScroll"),u("#mainSearchNoShow").prev().hide().prev().hide(),u("#mainSearchNoShow").show(),document.scrollingElement.scrollTop=0,u("#mainAside").removeClass("sidebar-toggled"),"/search"!==location.pathname&&history.pushState({link:"calendarMenu",subLink:"search"},"","search"),NMNS.socket.emit("get noshow",{contact:u(this).next().val().replace(/-/gi,""),mine:!1})):showSnackBar("ì „í™”ë²ˆí˜¸ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.")}),u(".calendarMenuLink").off("touch click").on("touch click",p),u("#searchNoShow").autocomplete({serviceUrl:"get customer info",paramName:"contact",zIndex:1060,maxHeight:150,noCache:!0,triggerSelectOnValidInput:!1,transformResult:function(e,t){return e.forEach(function(e){e.data=e.name,e.value=e.contact,delete e.contact,delete e.name}),{suggestions:e}},onSearchComplete:function(){},formatResult:function(e,t){return dashContact(e.value)+" ("+e.data+")"},onSearchError:function(){},onSelect:function(e){}},NMNS.socket),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&!document.getElementById("datalistPolyfillScript")){var e=document.createElement("script");e.src="/lib/datalist-polyfill/datalist-polyfill.min.js",e.id="datalistPolyfillScript",document.body.appendChild(e)}u(".infoCenterLink").one("touch click",function(){if(0===u("#faq").children().length){u("#submitFeedback").on("touch click",function(){var e=u("#feedbackBody").val();e&&0<e.trim().length?(NMNS.socket.emit("submit feedback",{data:e.trim()}),showSnackBar("ì œì•ˆ/ë¬¸ì˜í•´ì£¼ì‹  ë‚´ìš©ì´ ì˜ ì „ë‹¬ë˜ì—ˆìŠµë‹ˆë‹¤.<br/> ì†Œì¤‘í•œ ì˜ê²¬ì— ê°ì‚¬ë“œë¦½ë‹ˆë‹¤."),u("#feedbackBody").val("")):showSnackBar("ì œì•ˆ/ë¬¸ì˜í•˜ì‹¤ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")});var a="";[{title:"ì¼ì • ì¶”ê°€ëŠ” ì–´ë””ì„œ í•˜ë‚˜ìš”?",contents:"ì¼ì • ì¶”ê°€ëŠ” ì˜ˆì•½/ì¼ì • ê´€ë¦¬ í™”ë©´ì—ì„œ í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!"},{title:"ì¼ì • ì¶”ê°€ëŠ” ì–´ë””ì„œ í•˜ë‚˜ìš”?",contents:"ì¼ì • ì¶”ê°€ëŠ” ì˜ˆì•½/ì¼ì • ê´€ë¦¬ í™”ë©´ì—ì„œ í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!"},{title:"ì¼ì • ì¶”ê°€ëŠ” ì–´ë””ì„œ í•˜ë‚˜ìš”?",contents:"ì¼ì • ì¶”ê°€ëŠ” ì˜ˆì•½/ì¼ì • ê´€ë¦¬ í™”ë©´ì—ì„œ í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!"},{title:"ì¼ì • ì¶”ê°€ëŠ” ì–´ë””ì„œ í•˜ë‚˜ìš”?",contents:"ì¼ì • ì¶”ê°€ëŠ” ì˜ˆì•½/ì¼ì • ê´€ë¦¬ í™”ë©´ì—ì„œ í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!"},{title:"ì¼ì • ì¶”ê°€ëŠ” ì–´ë””ì„œ í•˜ë‚˜ìš”?",contents:"ì¼ì • ì¶”ê°€ëŠ” ì˜ˆì•½/ì¼ì • ê´€ë¦¬ í™”ë©´ì—ì„œ í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!"},{title:"ì¼ì • ì¶”ê°€ëŠ” ì–´ë””ì„œ í•˜ë‚˜ìš”?",contents:"ì¼ì • ì¶”ê°€ëŠ” ì˜ˆì•½/ì¼ì • ê´€ë¦¬ í™”ë©´ì—ì„œ í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!"}].forEach(function(e,t){a+='<div class="row faqRow col mx-0" title="'+e.title+'"><a href="#faqDetail'+t+'" class="faqDetailLink collapsed" data-toggle="collapse" role="button" aria-expanded="false" aria-controls="faqDetail'+t+'"></a><div class="ellipsis">'+e.title+'</div></div><div class="row faqDetailRow collapse mx-0" id="faqDetail'+t+'"><div class="d-inline-flex pb-3"><span>ã„´</span></div><span class="col px-2 pb-3">'+e.contents+"</span></div></div>",0<t&&t%50==0&&(u("#faq").append(a),a="")}),u("#faq").append(a)}}),u(".menuLink").on("touch click",x),Inputmask("999-999[9]-9999",{showMaskOnFocus:!1,showMaskOnHover:!1,autoUnmask:!0,placeholder:""}).mask(".inputmask-mobile")}(),window.onpopstate=function(e){var t;t=e.state?e.state.link:"calendarMenu";var a=u(".menuLink[data-link='"+t+"']");a.length&&x.call(a[0],null,!0),"salesMenu"===t?"search"===e.state.subLink?(u(".salesMenu .menuTitle").addClass("fixedScroll"),u("#mainSalesSearch").hide(),u(".salesSearchSwitch").show()):(u(".salesMenu .menuTitle").removeClass("fixedScroll"),u(".salesSearchSwitch").hide(),u("#mainSalesSearch").show()):"calendarMenu"===t&&(e.state&&"search"===e.state.subLink?(u("#mainSearchNoShow").prev().hide().prev().hide(),u("#mainSearchNoShow").show()):(u("#mainSearchNoShow").hide().prev().show().prev().show(),NMNS.siema&&NMNS.siema.resizeHandler(),NMNS.siemaCalendar&&NMNS.siemaCalendar.resizeHandler())),e.state&&"detail"===e.state.type?(u("#detailMenuTitle").html(e.state.title).show().prev().hide(),u(".announcementMenuLink").hide().next().show()):(u("#detailMenuTitle").hide().prev().show(),u("#exitDetailMenu").hide().prev().show())},u(document).on("scroll",function(){u("#mainCalendar").is(":visible")&&(document.scrollingElement.scrollTop>document.getElementById("mainSearchArea").offsetHeight?u(".calendarMenu").addClass("fixedScroll"):u(".calendarMenu").removeClass("fixedScroll"))}).on("scroll",debounce(function(){if(u("#announcementArea").is(":visible")){var e=Math.max(0,u("#announcementArea")[0].scrollHeight-u("#announcementArea").scrollTop()-u("#announcementArea").innerHeight());NMNS.expectMoreAnnouncement&&e<Math.max(100,.2*u("#announcementArea").innerHeight())&&NMNS.socket.emit("get announcement",{page:++NMNS.announcementPage,combined:!0})}},100))}(jQuery);