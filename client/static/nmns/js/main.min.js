!function(c){if(document.documentMode){var a,e=navigator.userAgent.toLowerCase();if("Microsoft Internet Explorer"==navigator.appName?a="msie ":-1<e.search("trident")?a="trident/.*rv:":-1<e.search("edge/")&&(a="edge/"),null!==new RegExp(a+"([0-9]{1,})(\\.{0,}[0-9]{0,1})").exec(e)&&parseFloat(RegExp.$1+RegExp.$2)<10&&!confirm("오래된 IE"+parseFloat(RegExp.$1+RegExp.$2)+" 브라우저를 사용하고 계십니다.\n 계속하시면 페이지가 정확히 표시되지 않을 수 있습니다. 그래도 계속하시겠습니까?\n *No More No Show는 IE10 이상의 브라우저를 지원하고,\nChrome 브라우저에 최적화되어있습니다."))return location.href="/signout"}c(".js-scroll-trigger").click(function(){c(".navbar-collapse").collapse("hide")}),NMNS.calendar=new tui.Calendar("#mainCalendar",{taskView:["task"],defaultView:550<c(window).width()?"week":"day",scheduleView:!0,useCreationPopup:!0,useDetailPopup:!0,disableDblClick:!0,template:{allday:function(a){return n(a,a.isAllDay)},time:function(a){return n(a,a.isAllDay)},task:function(a){return n(a,a.isAllDay)},alldayTitle:function(){return"<span class='tui-full-calendar-left-content'>하루종일</span>"},taskTitle:function(){return"<span class='tui-full-calendar-left-content'>일정</span>"},timegridDisplayPrimayTime:function(a){return a.hour+":00"},popupIsAllDay:function(){return"하루종일"},startDatePlaceholder:function(){return"시작시간"},endDatePlaceholder:function(){return"종료시간"},popupDetailDate:function(a,e,t){var n=moment(e instanceof Date?e:e.toDate()),o=moment(t instanceof Date?t:t.toDate()),i=n.isSame(o,"day"),l=(i?"":"YYYY.MM.DD ")+"a h:mm";return a?n.format("YYYY.MM.DD")+(i?"":" - "+o.format("YYYY.MM.DD")):n.format("YYYY.MM.DD a h:mm")+" - "+o.format(l)},popupEdit:function(){return"수정"},popupDelete:function(){return"삭제"},weekDayname:function(e){var a="tui-full-calendar-dayname-date",t="tui-full-calendar-dayname-name"+(NMNS.calendar&&"week"===NMNS.calendar.getViewName()?" weekViewDayName":""),n=NMNS.holiday?NMNS.holiday.find(function(a){return a.date===e.renderDate}):void 0;return n&&(t+=" tui-full-calendar-holiday",a+=" tui-full-calendar-holiday"),'<span class="'+a+'">'+e.date+'</span>&nbsp;&nbsp;<span class="'+t+'">'+e.dayName+(n?"["+n.title+"]":"")+"</span>"},monthGridHeader:function(e){var a=parseInt(e.date.split("-")[2],10),t=["tui-full-calendar-weekday-grid-date"];e.isToday&&t.push("tui-full-calendar-weekday-grid-date-decorator");var n=NMNS.holiday?NMNS.holiday.find(function(a){return a.date===e.date}):void 0;return n&&t.push("tui-full-calendar-holiday"),'<span class="'+t.join(" ")+'">'+a+(n?"<small class='d-none d-sm-inline'>["+n.title+"]</small>":"")+"</span>"},monthGridHeaderExceed:function(a){return'<span class="tui-full-calendar-weekday-grid-more-schedules" title="숨겨진 항목 더보기">+'+a+"</span>"},monthMoreTitleDate:function(a,e){var t=a.split(".").join("-"),n=NMNS.holiday?NMNS.holiday.find(function(a){return a.date===t}):void 0;return'<span class="'+("tui-full-calendar-month-more-title-day"+("일"===e?" tui-full-calendar-holiday-sun":"")+(n?" tui-full-calendar-holiday":"")+("토"===e?" tui-full-calendar-holiday-sat":""))+'">'+parseInt(t.substring(8),10)+'</span> <span class="tui-full-calendar-month-more-title-day-label">'+e+(n?"<small class='d-none d-sm-inline'>["+n.title+"]</small>":"")+"</span>"}},month:{daynames:["일","월","화","수","목","금","토"],scheduleFilter:function(){return!0},grid:{header:{height:26}}},week:{daynames:["일","월","화","수","목","금","토"],hourStart:NMNS.info?parseInt(NMNS.info.bizBeginTime.substring(0,2),10):9,hourEnd:NMNS.info?parseInt(NMNS.info.bizEndTime.substring(0,2),10)+("00"===NMNS.info.bizEndTime.substring(2)?0:1):23},theme:{"week.currentTime.color":"#009688","week.currentTimeLinePast.border":"1px dashed #009688","week.currentTimeLineBullet.backgroundColor":"#009688","week.currentTimeLineToday.border":"1px solid #009688","common.border":".07rem solid #e5e5e5","common.saturday.color":"#304ffe","common.dayname.color":"#212121","week.timegridOneHour.height":"68px","week.timegridHalfHour.height":"34px","week.vpanelSplitter.height":"5px","week.pastDay.color":"#212121","week.futureDay.color":"#212121","week.pastTime.color":"#212121","week.futureTime.color":"#212121","month.schedule.marginLeft":"0px","month.schedule.marginRight":"1px","month.schedule.height":"20px","common.creationGuide.backgroundColor":"rgba(68, 138, 255, 0.05)","common.creationGuide.border":"1px solid #448aff","week.creationGuide.color":"#448aff","week.timegrid.paddingRight":"1px","week.dayGridSchedule.marginRight":"1px"}}),NMNS.calendar.on({beforeCreateSchedule:function(a){!function(a){a.id=NMNS.email+generateRandom(),NMNS.calendar.createSchedules([a]),NMNS.history.push(a);var e=c.extend({},a);e.start=moment(e.start.toDate()).format("YYYYMMDDHHmm"),e.end=moment(e.end.toDate()).format("YYYYMMDDHHmm"),NMNS.socket.emit("add reserv",e)}(a)},beforeUpdateSchedule:function(a){var e=a.history||c.extend(!0,{},a.schedule);NMNS.history.push(e),a.schedule.start=a.start||a.schedule.start,a.schedule.end=a.end||a.schedule.end,a.schedule.raw.status=a.schedule.status||a.schedule.raw.status,a.history&&a.history.selectedCal.id!==a.schedule.calendarId?(NMNS.calendar.deleteSchedule(a.schedule.id,a.history.selectedCal.id,!0),a.schedule.category=a.schedule.isAllDay?"allday":"time",a.schedule.dueDateClass="",NMNS.calendar.createSchedules([a.schedule]),a.history.newCalendarId=a.schedule.calendarId):NMNS.calendar.updateSchedule(a.schedule.id,a.history?a.history.selectedCal.id:a.schedule.calendarId,a.schedule),NMNS.socket.emit("update reserv",{id:a.schedule.id,start:moment(a.schedule.start.toDate?a.schedule.start.toDate():a.schedule.start).format("YYYYMMDDHHmm"),end:moment(a.schedule.end.toDate?a.schedule.end.toDate():a.schedule.end).format("YYYYMMDDHHmm"),manager:a.schedule.calendarId,name:a.schedule.title,contact:a.schedule.contact||a.schedule.raw.contact,contents:a.schedule.contents||a.schedule.raw.contents,etc:a.schedule.etc||a.schedule.raw.etc,status:a.schedule.status||a.schedule.raw.status,isAllDay:a.schedule.isAllDay})},beforeDeleteSchedule:function(a){NMNS.history.push(a.schedule),NMNS.calendar.deleteSchedule(a.schedule.id,a.schedule.calendarId),NMNS.socket.emit("update reserv",{id:a.schedule.id,status:"DELETED"})},afterRenderSchedule:function(a){NMNS.calendar.getViewName()}});var t=function(e,t,n,o){return function(a){a&&"response"===a.type?a.status?t&&t(a):(o||alert(e+"에 실패했습니다."+(a.message?"("+a.message+")":"")),n&&n(a)):!a||"push"!==a.type&&"alert"!==a.type?console.error(a):t&&t(a)}};function n(a,e){var t="task"===a.category?"일정":"예약",n="<div class='tui-full-calendar-schedule-cover'>";switch(a.title&&(n+="<span title='"+t+"이름:"+a.title+"'>","task"===a.category?n+="<span title='일정이름:"+a.title+"'><span class='calendar-font-icon'># </span>":n+=e?"<span class='calendar-font-icon far fa-clock'></span> ":"<strong class='calendar-font-icon'>"+moment(a.start.toDate()).format("HH:mm")+"</strong> ",n+=a.title+"</span><br/>"),a.raw.status){case"CANCELED":n+="<span title='상태/"+t+"내용'><span class='badge badge-light'>취소</span>";break;case"NOSHOW":n+="<span title='상태/"+t+"내용'><span class='badge badge-danger'>노쇼</span>";break;case"CUSTOMERCANCELED":n+="<span title='상태/"+t+"내용'><span class='badge badge-light'>고객취소</span>"}return n+=(a.raw.contents?("RESERVED"===a.raw.status?"<span title='"+t+"내용:"+a.raw.contents+"'><i class='fas fa-list calendar-font-icon'></i> ":" ")+a.raw.contents+"</span><br/>":"")+(a.raw.contact?"<span title='연락처:"+a.raw.contact+"'><i class='fas fa-phone fa-rotate-90 calendar-font-icon'></i> "+a.raw.contact+"</span>":"")+"</div>"}function o(a){var e=a.target.getAttribute("data-action");e||(e=a.target.parentElement.getAttribute("data-action"));var t="";switch(e){case"toggle-daily":t="day",c("#mainCalendar").css("height",NMNS.calendarHeight+"rem");break;case"toggle-weekly":t="week",c("#mainCalendar").css("height",NMNS.calendarHeight+"rem");break;case"toggle-monthly":t="month",c("#mainCalendar").css("height","62rem")}NMNS.calendar.changeView(t,!0),h(),m(),f()}function i(a){var e=a.target.getAttribute("data-action");switch(e||(e=a.target.parentElement.getAttribute("data-action")),e){case"prev":NMNS.calendar.prev();break;case"next":NMNS.calendar.next();break;default:return}m(),f()}function l(a){a.preventDefault();var e,t,n;c(a.target).closest('a[role="menuitem"]')[0].getAttribute("data-action");e=document.getElementById("calendarName"),t=NMNS.manager,(n=[]).push('<span class="calendar-bar" style="background-color: '+t.bgColor+"; border-color:"+t.borderColor+';"></span>'),n.push('<span class="calendar-name">'+t.name+"</span>"),e.innerHTML=n.join("")}function r(a){a.preventDefault();var e=moment(new Date);e.hour()>=Number(NMNS.info.bizEndTime.substring(0,2))||e.hour()+1==Number(NMNS.info.bizEndTime.substring(0,2))&&e.minute()+30>Number(NMNS.info.bizEndTime.substring(2))?e=moment(NMNS.info.bizEndTime,"HHmm").subtract(30,"m"):e.hour()<Number(NMNS.info.bizBeginTime.substring(0,2))||e.hour()==Number(NMNS.info.bizBeginTime.substring(0,2))&&e.minute()<Number(NMNS.info.bizBeginTime.substring(2))?e=moment(NMNS.info.bizBeginTime,"HHmm"):e.minute(10*Math.ceil(e.minute()/10)),NMNS.calendar.openCreationPopup({start:e.toDate(),end:e.add(30,"m").toDate()}),c("#creationPopupName").focus()}function d(e){return NMNS.calendar.getCalendars().find(function(a){return a.id===e})}function s(a){var t=a.target.checked,e=document.querySelector(".lnbManagerItem input"),n=Array.prototype.slice.call(document.querySelectorAll("#lnbManagerList input")),o=!0;if(c(a.target).is("#managerCheckAll"))o=t,n.forEach(function(a){var e=a.parentNode;a.checked=t,e.style.backgroundColor=t?e.style.borderColor:"transparent"}),NMNS.calendar.getCalendars().forEach(function(a){a.checked=t});else{var i=c(a.target).parents(".lnbManagerItem");if(i.is(".addManagerItem"))return;var l=i.data("value");l&&(d(l).checked=t,o=n.every(function(a){return a.checked}),e.checked=!!o)}u()}function u(){var a=Array.prototype.slice.call(document.querySelectorAll("#lnbManagerList input"));NMNS.calendar.getCalendars().forEach(function(a){NMNS.calendar.toggleSchedules(a.id,!a.checked,!1)}),NMNS.calendar.render(!0),a.forEach(function(a){var e=a.nextElementSibling;e.style.backgroundColor=a.checked?e.style.borderColor:"transparent"})}function h(){switch(c(".calendarType").removeClass("active"),NMNS.calendar.getViewName()){case"day":c("#calendarTypeMenu").html(c(".calendarType[data-action='toggle-daily']").addClass("active").html());break;case"week":c("#calendarTypeMenu").html(c(".calendarType[data-action='toggle-weekly']").addClass("active").html());break;default:c("#calendarTypeMenu").html(c(".calendarType[data-action='toggle-monthly']").addClass("active").html())}}function m(){var a=document.getElementById("renderRange"),e=NMNS.calendar.getOptions(),t=NMNS.calendar.getViewName(),n=[];"day"===t?n.push(moment(NMNS.calendar.getDate().getTime()).format("YYYY.MM.DD")):"month"===t&&(!e.month.visibleWeeksCount||4<e.month.visibleWeeksCount)?n.push(moment(NMNS.calendar.getDate().getTime()).format("YYYY.MM")):(n.push(moment(NMNS.calendar.getDateRangeStart().getTime()).format("YYYY.MM.DD")),n.push(" – "),n.push(moment(NMNS.calendar.getDateRangeEnd().getTime()).format(" MM.DD"))),a.innerHTML=n.join("")}function f(){var a,e;NMNS.calendar.clear(),a=NMNS.calendar.getDateRangeStart(),e=NMNS.calendar.getDateRangeEnd(),NMNS.socket.emit("get reserv",{start:toYYYYMMDD(a._date)+"0000",end:toYYYYMMDD(e._date)+"2359"})}function N(a){switch(a){case"BEFORE_EMAIL_VERIFICATION":return"<span class='badge badge-danger' title='인증메일 보내기' style='cursor:pointer;'>이메일 미인증</span><span class='btn btn-sm btn-flat btn-secondary ml-2'>인증메일 보내기</span>";case"EMAIL_VERIFICATED":return"<span class='badge badge-success'>인증</span>"}return c("#infoAccountStatus").removeClass("pl-2"),""}function p(a){switch(a){case"RESERVED":return"<span class='badge badge-success' title='바꾸기'>정상 </span><span class='btn btn-sm btn-light noShowScheduleNoShow' title='노쇼처리'><i class='fas fa-exclamation-triangle'></i><span class='d-none d-lg-inline-block'> 노쇼처리</span></span>";case"CANCELED":case"CUSTOMERCANCELED":return"<span class='badge badge-secondary' title='바꾸기'>취소 </span><span class='btn btn-sm btn-light noShowScheduleNoShow' title='노쇼처리'><i class='fas fa-exclamation-triangle'></i><span class='d-none d-lg-inline-block'> 노쇼처리</span></span>";case"NOSHOW":return"<span class='badge badge-danger' title='바꾸기'>노쇼 </span><span class='btn btn-sm btn-light noShowScheduleNormal' title='되돌리기'><i class='fas fa-undo'></i><span class='d-none d-lg-inline-block'> 되돌리기</span></span>"}return""}function S(a){var e="";return a.forEach(function(a){e+="<div class='infoManagerItem'><label><input class='tui-full-calendar-checkbox-round' checked='checked' readonly='readonly' type='checkbox'/><span class='infoManagerColor' style='background-color:"+a.bgColor+"; border-color:"+a.bgColor+";'></span><input type='text' name='name' class='align-middle form-control form-control-sm rounded-0' data-id='"+a.id+"' data-color='"+a.bgColor+"' placeholder='담당자 이름' value='"+a.name+"' data-name='"+a.name+"'/></label><i class='fas fa-trash deleteManager pl-2' title='삭제'></i></div>"}),e}function g(a){var e="";return a.forEach(function(a){e+="<div class='lnbManagerItem' data-value='"+a.id+"'><label><input class='tui-full-calendar-checkbox-round' checked='checked' type='checkbox'>",e+="<span style='background-color:"+a.bgColor+"; border-color:"+a.borderColor+"' title='이 담당자의 예약 가리기/보이기'></span><small>"+a.name+"</small></label></div>"}),e}function M(a){c("#mainShopName").length?""!==a?c("#mainShopName").text(a):c("#navbarResponsive").prev().children("span").html(NMNS.email):""!==a&&c("#navbarResponsive").prev().children("span").html("<span id='mainShopName'>"+a+"</span><small class='d-none d-md-inline-block'>("+NMNS.email+")</small>")}function b(){"Y"===NMNS.info.alrimTalkInfo.useYn?(c("#alrimUseYn").prop("checked",!0),c("#alrimScreen").hide()):(c("#alrimUseYn").prop("checked",!1),c("#alrimScreen").show()),c("#alrimCallbackPhone").val(NMNS.info.alrimTalkInfo.callbackPhone||""),c("#alrimShopName").val(NMNS.info.shopName||""),c("#alrimCancelDue").val(NMNS.info.alrimTalkInfo.cancelDue||""),c("#alrimNotice").val(NMNS.info.alrimTalkInfo.notice||""),c("#noticeByteCount").text(c("#alrimNotice").val().length)}function k(){if(700<c("#alrimNotice").val().length)return alert("알림 안내문구의 길이가 너무 깁니다. 조금만 줄여주세요 :)"),void c("#alrimNotice").focus();if(c("#alrimUseYn").prop("checked")){if(""===c("#alrimCallbackPhone").val())return alert("알림톡을 사용하시려면 반드시 휴대폰번호를 입력해주세요!"),void c("#alrimCallbackPhone").focus();if(!/^01([016789]?)([0-9]{3,4})([0-9]{4})$/.test(c("#alrimCallbackPhone").val()))return alert("입력하신 휴대폰번호가 정확하지 않은 것 같습니다.\n휴대폰번호를 정확히 입력해주세요!"),void c("#alrimCallbackPhone").focus();if(""===c("#alrimShopName").val())return alert("알림톡을 사용하시려면 고객에게 보여줄 매장 이름을 입력해주세요!"),void c("#alrimShopName").focus()}var a={},e={id:"alrimInfo"},t=!1;c("#alrimShopName").val()!==(NMNS.info.shopName||"")&&(NMNS.history.push({id:"info",shopName:NMNS.info.shopName}),a={shopName:c("#alrimShopName").val()},NMNS.info.shopName=a.shopName,NMNS.socket.emit("update info",a),M(a.shopName),a={},t=!0),(c("#alrimUseYn").prop("checked")&&"Y"!==NMNS.info.alrimTalkInfo.useYn||!c("#alrimUseYn").prop("checked")&&"N"!==NMNS.info.alrimTalkInfo.useYn)&&(e.useYn=NMNS.info.alrimTalkInfo.useYn,a.useYn=c("#alrimUseYn").prop("checked")?"Y":"N",NMNS.info.alrimTalkInfo.useYn=a.useYn),c("#alrimCallbackPhone").val()!==(NMNS.info.alrimTalkInfo.callbackPhone||"")&&(e.callbackPhone=NMNS.info.alrimTalkInfo.callbackPhone,a.callbackPhone=c("#alrimCallbackPhone").val(),NMNS.info.alrimTalkInfo.callbackPhone=a.callbackPhone),c("#alrimCancelDue").val()!==(NMNS.info.alrimTalkInfo.cancelDue||"")&&(e.cancelDue=NMNS.info.alrimTalkInfo.cancelDue,a.cancelDue=c("#alrimCancelDue").val(),NMNS.info.alrimTalkInfo.cancelDue=a.cancelDue),c("#alrimNotice").val()!==(NMNS.info.alrimTalkInfo.notice||"")&&(e.notice=NMNS.info.alrimTalkInfo.notice,a.notice=c("#alrimNotice").val(),NMNS.info.alrimTalkInfo.notice=a.notice),Object.keys(a).length&&(NMNS.history.push(e),NMNS.socket.emit("update alrim",a)),Object.keys(a).length||t?alert("정상적으로 요청하였습니다."):alert("변경된 내역이 없습니다."),c("#alrimModal").modal("hide")}function v(){NMNS.initedAlrimModal||(NMNS.initedAlrimModal=!0,c("#alrimNotice").off("keyup keydown paste cut change").on("keyup keydown paste cut change",function(a){c("#noticeByteCount").text(c(this).val().length),c(this).height(0).height(150<this.scrollHeight?150:this.scrollHeight<60?60:this.scrollHeight)}),c("#alrimUseYn").off("change").on("change",function(){c(this).prop("checked")?c("#alrimScreen").hide():c("#alrimScreen").show()}),c("#alrimModalRefresh").off("touch click").on("touch click",b),c("#alrimModalSave").off("touch click").on("touch click",k),c("#alrimCallbackPhone").off("blur").on("blur",function(){filterNonNumericCharacter(c(this))})),b()}function w(){if(c(".infoManagerItem input[type='text']").length){var a=!0;if(c(".infoManagerItem input[type='text']").each(function(){c(this).val().length||(a=!1,c(this).focus())}),a){var e=moment(c("#infoBizBeginTime").val(),"HH:mm");if(!e.isValid())return alert("매장 운영 시작시간이 올바르지 않습니다."),void c("#infoBizBeginTime").focus();var t=moment(c("#infoBizEndTime").val(),"HH:mm");if(!t.isValid())return alert("매장 운영 종료시간이 올바르지 않습니다."),void c("#infoBizEndTime").focus();if(e.isAfter(t,"hour")&&(e=[t,t=e][0]),""===c("#infoShopName").val()&&"Y"===NMNS.info.alrimTalkInfo.useYn)return alert("알림톡을 사용하고 계실 때는 예약고객에게 보여드릴 매장이름이 반드시 있어야 합니다.\n매장이름을 삭제하고 싶으시다면 알림톡 사용을 먼저 해제해주세요."),void c("#infoShopName").val(NMNS.info.shopName);var n={},o={id:"info"};e.format("HHmm")===NMNS.info.bizBeginTime&&t.format("HHmm")===NMNS.info.bizEndTime||(o.hourStart=NMNS.info.bizBeginTime||"0900",o.hourEnd=NMNS.info.bizEndTime||"2300",n.bizBeginTime=e.format("HHmm"),n.bizEndTime=t.format("HHmm"),NMNS.info.bizBeginTime=n.bizBeginTime||"0900",NMNS.info.bizEndTime=n.bizEndTime||"2300",NMNS.calendar.setOptions({week:{hourStart:n.bizBeginTime?parseInt(n.bizBeginTime.substring(0,2),10):NMNS.calendar.getOptions().week.hourStart,hourEnd:n.bizEndTime?parseInt(n.bizEndTime.substring(0,2),10):NMNS.calendar.getOptions().week.hourEnd}})),c("#infoShopName").val()!==(NMNS.info.shopName||"")&&(o.shopName=NMNS.info.shopName,n.shopName=c("#infoShopName").val(),NMNS.info.shopName=n.shopName,M(n.shopName)),c("#infoBizType").val()!==(NMNS.info.bizType||"")&&(o.bizType=NMNS.info.bizType,n.bizType=c("#infoBizType").val(),NMNS.info.bizType=n.bizType),Object.keys(n).length&&(NMNS.history.push(o),NMNS.socket.emit("update info",n));var i=!1;""!==c("#infoPassword").val()&&(NMNS.socket.emit("update password",{password:c("#infoPassword").val()}),c("#infoPassword").val(""),i=!0),c(".infoManagerItem").each(function(){if(c(this).hasClass("addManagerItem"))i=!0,H(c(this).find("input[type='text']")[0]);else{var a=c(this).find("input[type='text']"),e=d(a.data("id"));if(c(this).data("delete")&&e)i=!0,NMNS.calendar.setCalendars(NMNS.calendar.getCalendars().remove(e.id,function(a,e){return a.id===e})),NMNS.history.push({id:e.id,bgColor:e.bgColor,borderColor:e.borderColor,color:e.color,name:e.name}),NMNS.socket.emit("delete manager",{id:e.id});else if(e&&(a.data("color")!==e.bgColor||a.val()!==e.name)){i=!0;var t=a.data("color");NMNS.calendar.setCalendar(e.id,{color:getColorFromBackgroundColor(t),bgColor:t,borderColor:t,name:a.val()},!0),NMNS.calendar.setCalendarColor(e.id,{color:getColorFromBackgroundColor(t),bgColor:t,borderColor:t},!0),NMNS.history.push({id:e.id,color:e.bgColor,name:e.name}),NMNS.socket.emit("update manager",{id:e.id,color:t,name:a.val()})}}}),i&&(c("#lnbManagerList").html(g(NMNS.calendar.getCalendars())),u()),i||Object.keys(n).length?alert("변경된 정보를 전송하였습니다."):alert("변경된 내역이 없습니다."),c("#infoModal").modal("hide")}else alert("담당자의 이름을 입력해주세요.")}else alert("담당자는 최소 1명 이상이 있어야 합니다.")}function y(a){c("#infoModalColorPicker").css("left",c("#infoManagerList").position().left+a.position().left+"px").css("top",c("#infoManagerList").position().top+a.position().top+74+"px").data("target",a.next().data("id")).show(300)}function C(){c("#infoEmail").text(NMNS.email),c("#infoPassword").val(""),c("#infoAuthStatus").html("BEFORE_EMAIL_VERIFICATION"===NMNS.info.authStatus?c(N(NMNS.info.authStatus)).on("touch click",function(){NMNS.socket.emit("send verification",{}),alert("인증메일을 보냈습니다. 도착한 이메일을 확인해주세요!")}):N(NMNS.info.authStatus)),c("#infoShopName").val(NMNS.info.shopName),c("#infoBizType").val(NMNS.info.bizType);var a=c("#infoManagerList");NMNS.infoModalScroll?(a.children(":not(.ps__rail-x):not(.ps__rail-y)").remove(),c(S(NMNS.calendar.getCalendars())).prependTo(a)):(a.html(S(NMNS.calendar.getCalendars())),NMNS.infoModalScroll=new PerfectScrollbar(a[0])),c(".infoManagerItem .deleteManager").off("touch click").on("touch click",function(){var a=c(this).parents(".infoManagerItem");0!=a.siblings(".infoManagerItem:visible").length?(a.hide(),c(a.siblings(".infoManagerItem:visible")[0]).find("input.form-control").focus(),a.attr("data-delete","true"),NMNS.infoModalScroll.update()):alert("담당자는 반드시 1명 이상 있어야합니다!")}),c(".infoManagerItem input.form-control").off("keyup").on("keyup",function(a){if(27===a.which){var e=c(this).parents(".infoManagerItem");if(0==e.siblings(".infoManagerItem:visible").length)return;e.hide(),c(e.siblings(".infoManagerItem:visible")[0]).find("input.form-control").focus(),e.attr("data-delete","true"),NMNS.infoModalScroll.update()}}),c(".infoManagerItem .infoManagerColor").off("touch click").on("touch click",function(){y(c(this))})}function D(){NMNS.initedInfoModal||(NMNS.initedInfoModal=!0,flatpickr("#infoBizBeginTime",{dateFormat:"H:i",time_24hr:!0,defaultHour:Number((NMNS.info.bizBeginTime||"0900").substring(0,2)),defaultMinute:Number((NMNS.info.bizBeginTime||"0900").substring(2,4)),minuteIncrement:10,noCalendar:!0,enableTime:!0,appendTo:document.getElementById("infoModal"),applyBtn:!0}).setDate(moment(NMNS.info.bizBeginTime?NMNS.info.bizBeginTime:"0900","HHmm").toDate()),flatpickr("#infoBizEndTime",{dateFormat:"H:i",time_24hr:!0,defaultHour:Number((NMNS.info.bizEndTime||"2300").substring(0,2)),defaultMinute:Number((NMNS.info.bizEndTime||"2300").substring(2,4)),minuteIncrement:10,noCalendar:!0,enableTime:!0,appendTo:document.getElementById("infoModal"),applyBtn:!0}).setDate(moment(NMNS.info.bizEndTime?NMNS.info.bizEndTime:"2300","HHmm").toDate()),NMNS.infoModalScroll||(NMNS.infoModalScroll=new PerfectScrollbar("#infoManagerList")),c("#infoModalSave").off("touch click").on("touch click",w),c("#infoModalRefresh").off("touch click").on("touch click",C),c("#infoModalColorPickerClose").off("touch click").on("touch click",function(){c("#infoModalColorPicker").hide(300)}),c(".infoModalColor").off("touch click").on("touch click",function(){var a=c(".infoManagerItem input[data-id='"+c("#infoModalColorPicker").data("target")+"']"),e=c(this).attr("data-color");a.length&&(a.data("color",e),a.prev().css("background-color",e).css("border-color",e).data("color",e))})),C()}function T(a){var e=a.children("input"),t=a.parent();NMNS.history.push({id:t.data("id"),calendarId:t.data("manager"),status:"NOSHOW"}),NMNS.calendar.updateSchedule(t.data("id"),t.data("manager"),{raw:{status:"NOSHOW"}}),NMNS.socket.emit("update reserv",{id:t.data("id"),status:"NOSHOW",noShowCase:e.val()});var n=c("#noShowScheduleList .row[data-id='"+t.data("id")+"']");n.children("span:last-child").html(c(p("NOSHOW"))),n.find(".badge, .noShowScheduleNoShow").each(function(){c(this).on("touch click",function(a){a.stopPropagation(),x(c(this))})}),n.find(".noShowScheduleNormal").on("touch click",function(a){a.stopPropagation(),U(c(this))}),t.hide(300)}function E(){if(NMNS.initedNoShowModal)c("#noShowAddContact").autocomplete().clearCache(),c("#noShowSearchContact").autocomplete().clearCache(),c("#noShowScheduleName").autocomplete().clearCache(),c("#noShowScheduleContact").autocomplete().clearCache();else{NMNS.initedNoShowModal=!0;var t={format:"Y-m-d",defaultDate:new Date,appendTo:document.getElementById("noShowModal"),locale:"ko",closeOnSelect:!0};NMNS.noShowModalSearchScroll||(NMNS.noShowModalSearchScroll=new PerfectScrollbar("#noShowSearchList",{suppressScrollX:!0})),NMNS.noShowModalScheduleScroll||(NMNS.noShowModalScheduleScroll=new PerfectScrollbar("#noShowScheduleList",{suppressScrollX:!0})),c(".noShowAddCase").off("touch click").on("touch click",function(){c(".noShowAddCase").not(c(this)).removeClass("badge-danger").addClass("badge-light"),c(this).removeClass("badge-light").addClass("badge-danger").is("#noShowAddCaseEtc")?c(this).next().removeAttr("disabled"):c(this).siblings("input").attr("disabled","disabled")}),c("#noShowAddBtn").off("touch click").on("touch click",function(){if(""!==c("#noShowAddContact").val()){var a=c("#noShowAddContent .badge-danger").is("#noShowAddCaseEtc")?c("#noShowAddContent input").val():c("#noShowAddContent .badge-danger").data("value");NMNS.socket.emit("add noshow",{id:NMNS.email+generateRandom(),contact:c("#noShowAddContact").val(),noShowCase:a})}else alert("저장할 전화번호를 입력해주세요!")}),c("#noShowSearchBtn").off("touch click").on("touch click",function(){""!==c("#noShowSearchContact").val()?NMNS.socket.emit("get noshow",{contact:c("#noShowSearchContact").val(),mine:!1}):alert("검색할 전화번호를 입력해주세요!")}),c("#noShowScheduleSearch").off("touch click").on("touch click",function(){var a={};if(""!==c("#noShowScheduleStartDate").val()){var e=moment(c("#noShowScheduleStartDate").val(),"YYYY-MM-DD");if(!e.isValid())return void alert("검색 시작일자가 올바르지 않아요. 다시 입력해주세요!");a.start=e.format("YYYYMMDD")}if(""!==c("#noShowScheduleEndDate").val()){var t=moment(c("#noShowScheduleEndDate").val(),"YYYY-MM-DD");if(!t.isValid())return void alert("검색 끝일자가 올바르지 않아요. 다시 입력해주세요!");a.end=t.format("YYYYMMDD")}""!==c("#noShowScheduleName").val()&&(a.name=c("#noShowScheduleName").val()),""!==c("#noShowScheduleContact").val()&&(a.contact=c("#noShowScheduleContact").val()),c("#noShowScheduleList").html(""),NMNS.socket.emit("get summary",a)}),c("#noShowSearchAdd").off("touch click").on("touch click",function(){var a=generateRandom(),e=c("<div class='row px-0 col-12 mt-1 noShowSearchAdd' data-id='"+a+"'><div class='col-4 pr-0'><input type='text' class='form-control form-control-sm rounded-0' name='noShowSearchAddContact' placeholder='고객 전화번호'></div><div id='noShowSearchAddDatePicker"+a+"' class='col-4 input-group input-group-sm pr-0'><div class='input-group-prepend'><i id='noShowSearchAddDateIcon"+a+"' class='input-group-text far fa-calendar rounded-0'></i></div><input id='noShowSearchAddDate"+a+"' type='text' class='form-control form-control-sm rounded-0' name='noShowSearchAddDate' aria-describedby='noShowSearchAddDateIcon"+a+"'></div><div class='col-3'><select class='form-control form-control-sm rounded-0' name='noShowType'><option value='지각'>지각</option><option value='잠수' selected='selected'>잠수</option><option value='직전취소'>직전취소</option><option value='기타'>기타</option></select></div><div class='col-1 px-0'><i class='fas fa-check noShowSearchAddSubmit align-middle' title='저장'></i>  <i class='fas fa-trash noShowSearchAddCancel align-middle ml-lg-2 ml-md-1' title='취소'></i></div></div>");c("#noShowSearchList .empty").length?c("#noShowSearchList").html(e):c("#noShowSearchList").append(e),e.find(".noShowSearchAddSubmit").off("touch click").on("touch click",function(){A(c(this))}),e.find(".noShowSearchAddCancel").off("touch click").on("touch click",function(){var a,e;a=c(this),(e=a.parentsUntil("#noShowSearchList",".row")).data("datetimepicker").destroy(),e.remove(),""===c("#noShowSearchList").html()&&c("#noShowSearchList").html("<div class='row col-12 px-0 mt-2 empty'><span class='col-12 text-center'>전화번호로 검색하거나 아래 버튼을 눌러<br/>노쇼를 직접 추가해보세요!</span></div>")}),e.find("input[name='noShowSearchAddContact']").off("blur").on("blur",function(){filterNonNumericCharacter(c(this))}).val(c("#noShowSearchContact").val()).select().focus(),e.data("datetimepicker",flatpickr("#noShowSearchAddDate"+a,t))}),c("#noShowSearchContact, #noShowAddContact, #noShowScheduleContact").off("blur").on("blur",function(){filterNonNumericCharacter(c(this))}),c("#noShowSearchContact").on("keyup",function(a){13===a.which&&(filterNonNumericCharacter(c(this)),c("#noShowSearchBtn").trigger("click"))}),c("#noShowAddContact").on("keyup",function(a){13===a.which&&(filterNonNumericCharacter(c(this)),c("#noShowAddBtn").trigger("click"))}),c("#noShowScheduleContact").off("keyup").on("keyup",function(a){13===a.which&&(filterNonNumericCharacter(c(this)),c("#noShowScheduleSearch").trigger("click"))}),flatpickr("#noShowScheduleStartDate",t).setDate(moment().subtract(1,"M").toDate()),flatpickr("#noShowScheduleEndDate",t).setDate(moment().add(1,"M").toDate()),c("#noShowScheduleDropdown .dropdown-item:not(:last-child)").off("touch click").on("touch click",function(a){var e=c(this).parent();a.preventDefault(),NMNS.history.push({id:e.data("id"),calendarId:e.data("manager"),raw:{status:e.data("status")}}),NMNS.calendar.updateSchedule(e.data("id"),e.data("manager"),{raw:{status:c(this).data("status")}}),NMNS.socket.emit("update reserv",{id:e.data("id"),status:c(this).data("status"),noShowCase:c(this).data("type")});var t=c("#noShowScheduleList .row[data-id='"+e.data("id")+"']");t.children("span:last-child").html(c(p(c(this).data("status")))),t.find(".badge, .noShowScheduleNoShow").each(function(){c(this).on("touch click",function(a){a.stopPropagation(),x(c(this))})}),t.find(".noShowScheduleNormal").on("touch click",function(a){a.stopPropagation(),U(c(this))}),e.hide(300)}),c("#noShowScheduleDropdown .noShowScheduleCheck").off("touch click").on("touch click",function(){T(c(this).parent())}),c("#noShowScheduleDropdown .dropdown-item-etc").off("touch click").on("touch click",function(a){a.preventDefault()}),c("#noShowScheduleDropdown .dropdown-item-etc input").off("keyup").on("keyup",function(a){switch(a.which){case 13:T(c(this).parent());break;case 27:c(this).parent().parent().hide(300)}}).off("touch click").on("touch click",function(a){a.preventDefault(),a.stopPropagation(),c(this).focus()}),c("#noShowAddContact").autocomplete({serviceUrl:"get customer info",paramName:"contact",zIndex:1060,maxHeight:150,triggerSelectOnValidInput:!1,transformResult:function(a,e){return a.forEach(function(a){a.data=a.name,a.value=a.contact,delete a.contact,delete a.name}),{suggestions:a}},onSearchComplete:function(){},formatResult:function(a,e){return dashContact(a.value)+" ("+a.data+")"},onSearchError:function(){},onSelect:function(a){}},NMNS.socket),c("#noShowSearchContact").autocomplete({serviceUrl:"get customer info",paramName:"contact",zIndex:1060,maxHeight:150,triggerSelectOnValidInput:!1,transformResult:function(a,e){return a.forEach(function(a){a.data=a.name,a.value=a.contact,delete a.contact,delete a.name}),{suggestions:a}},onSearchComplete:function(){},formatResult:function(a,e){return dashContact(a.value)+" ("+a.data+")"},onSearchError:function(){},onSelect:function(a){}},NMNS.socket),c("#noShowScheduleName").autocomplete({serviceUrl:"get customer info",paramName:"name",zIndex:1060,maxHeight:150,triggerSelectOnValidInput:!1,transformResult:function(a,e){return a.forEach(function(a){a.data=a.contact,a.value=a.name,delete a.contact,delete a.name}),{suggestions:a}},onSearchComplete:function(){},formatResult:function(a,e){return a.value+" ("+dashContact(a.data)+")"},onSearchError:function(){},onSelect:function(a){c("#noShowScheduleContact").val(a.data)}},NMNS.socket),c("#noShowScheduleContact").autocomplete({serviceUrl:"get customer info",paramName:"contact",zIndex:1060,maxHeight:150,triggerSelectOnValidInput:!1,transformResult:function(a,e){return a.forEach(function(a){a.data=a.name,a.value=a.contact,delete a.contact,delete a.name}),{suggestions:a}},onSearchComplete:function(){},formatResult:function(a,e){return dashContact(a.value)+" ("+a.data+")"},onSearchError:function(){},onSelect:function(a){c("#noShowScheduleName").val(a.data)}},NMNS.socket)}}function Y(e){if(!NMNS.initedTaskModal){var a={format:"Y-m-d H:i",enableTime:NMNS.initedTaskModal=!0,defaultDate:new Date,appendTo:document.getElementById("taskModal"),locale:"ko",minuteIncrement:10,time_24hr:!0,minTime:moment(NMNS.info.bizBeginTime||"0900","HHmm").format("HH:mm"),maxTime:moment(NMNS.info.bizEndTime||"2300","HHmm").format("HH:mm"),applyBtn:!0};flatpickr("#taskStartDate",a),flatpickr("#taskEndDate",a),c("#taskModalSave").on("touch click",function(){if(""===c("#taskName").val())return alert("일정 이름을 입력해주세요!"),void c("#taskName").focus();var a,e=c("#taskStartDate")[0]._flatpickr.selectedDates[0],t=c("#taskEndDate")[0]._flatpickr.selectedDates[0];if(e.getTime()>t.getTime()&&(e=[t,t=e][0]),c("#taskModal").data("edit")){var n=c("#taskModal").data("task");n.manager=n.calendarId,NMNS.history.push(n),n.calendarId!==c("#taskManager").data("calendar-id")?(n.newCalendarId=c("#taskManager").data("calendar-id"),NMNS.calendar.deleteSchedule(n.id,n.manager,!0),NMNS.calendar.createSchedules([{id:n.id,calendarId:c("#taskManager").data("calendar-id"),title:c("#taskName").val(),start:e,end:t,isAllDay:!1,category:"task",dueDateClass:"",color:getColorFromBackgroundColor(c("#taskManager").data("bgcolor")),bgColor:c("#taskManager").data("bgcolor"),borderColor:c("#taskManager").data("bgcolor"),raw:{contents:c("#taskContents").val(),status:"RESERVED"}}])):NMNS.calendar.updateSchedule(n.id,n.calendarId,{title:c("#taskName").val(),start:e,end:t,isAllDay:!1,raw:{contents:c("#taskContents").val()}}),NMNS.socket.emit("update reserv",{id:n.id,manager:c("#taskManager").data("calendar-id"),name:c("#taskName").val(),start:moment(e).format("YYYYMMDDHHmm"),end:moment(t).format("YYYYMMDDHHmm"),isAllDay:!1,contents:c("#taskContents").val()})}else a=NMNS.email+generateRandom(),NMNS.calendar.createSchedules([{id:a,calendarId:c("#taskManager").data("calendar-id"),title:c("#taskName").val(),start:e,end:t,isAllDay:!1,category:"task",dueDateClass:"",color:getColorFromBackgroundColor(c("#taskManager").data("bgcolor")),bgColor:c("#taskManager").data("bgcolor"),borderColor:c("#taskManager").data("bgcolor"),raw:{contents:c("#taskContents").val(),status:"RESERVED"}}]),NMNS.history.push({id:a,manager:c("#taskManager").data("calendar-id")}),NMNS.socket.emit("add reserv",{id:a,manager:c("#taskManager").data("calendar-id"),name:c("#taskName").val(),start:moment(e).format("YYYYMMDDHHmm"),end:moment(t).format("YYYYMMDDHHmm"),isAllDay:!1,type:"T",contents:c("#taskContents").val(),status:"RESERVED"});c("#taskModal").modal("hide")})}var t,n;if(e.start&&e.end)c("#taskModal").data("edit",!!e.id).data("task",e),document.getElementById("taskStartDate")._flatpickr.setDate(e.start.toDate()),document.getElementById("taskEndDate")._flatpickr.setDate(e.end.toDate()),c("#taskName").val(e.title||""),c("#taskContents").val(e.raw&&e.raw.contents||""),(t=e.calendarId?NMNS.calendar.getCalendars().find(function(a){return a.id===e.calendarId}):NMNS.calendar.getCalendars()[0])||(t={id:e.calendarId,bgColor:e.bgColor,name:"삭제된 담당자"});else{c("#taskModal").data("edit",!1).removeData("task");var o=moment(new Date);o.hour()>Number(NMNS.info.bizEndTime.substring(0,2))||o.hour()==Number(NMNS.info.bizEndTime.substring(0,2))&&o.minute()+30>Number(NMNS.info.bizEndTime.substring(2))?o=moment(NMNS.info.bizEndTime,"HHmm").subtract(30,"m"):o.hour()<Number(NMNS.info.bizBeginTime.substring(0,2))||o.hour()==Number(NMNS.info.bizBeginTime.substring(0,2))&&o.minute()<Number(NMNS.info.bizBeginTime.substring(2))?o=moment(NMNS.info.bizBeginTime,"HHmm"):o.minute(10*Math.ceil(o.minute()/10)),document.getElementById("taskStartDate")._flatpickr.setDate(o.toDate()),document.getElementById("taskEndDate")._flatpickr.setDate(o.add(30,"m").toDate()),c("#taskName").val(""),c("#taskContents").val(""),t=NMNS.calendar.getCalendars()[0]}c("#taskManager").next().html((n="",NMNS.calendar.getCalendars().forEach(function(a){n+="<button type='button' class='dropdown-item tui-full-calendar-dropdown-item' data-calendar-id='"+a.id+"' data-bgcolor='"+a.bgColor+"'><span class='tui-full-calendar-icon tui-full-calendar-calendar-dot' style='background-color: "+a.bgColor+"'></span><span class='tui-full-calendar-content'>"+a.name+"</span></button>"}),n)).off("touch click","button").on("touch click","button",function(){c("#taskManager").data("calendar-id",c(this).data("calendar-id")).data("bgcolor",c(this).data("bgcolor")).html(c(this).html())}),c("#taskManager").html("<span class='tui-full-calendar-icon tui-full-calendar-calendar-dot' style='background-color: "+t.bgColor+"'></span><span class='tui-full-calendar-content'>"+t.name+"</span>").data("calendar-id",t.id).data("bgcolor",t.bgColor)}function I(a){NMNS.calendar.createSchedules(a.map(function(a){if(a.raw)return"string"==typeof a.start&&(a.start=moment(a.start,"YYYYMMDDHHmm").toDate()),"string"==typeof a.end&&(a.end=moment(a.end,"YYYYMMDDHHmm").toDate()),a;var e=d(a.manager||a.calendarId)||{};return{id:a.id,calendarId:e.id||"A1",title:a.name||a.title,start:"string"==typeof a.start?moment(a.start,"YYYYMMDDHHmm").toDate():a.start,end:"string"==typeof a.end?moment(a.end,"YYYYMMDDHHmm").toDate():a.end,isAllDay:a.isAllDay,category:"T"===a.type?"task":a.isAllday?"allday":"time",dueDateClass:"T"===a.type?"dueDateClass":"",attendees:[],recurrenceRule:!1,isPending:a.isCanceled,isFocused:!1,isVisible:!0,isReadOnly:!1,isPrivate:!1,customStyle:"",location:"",bgColor:e.bgColor||"#b2dfdb",borderColor:e.borderColor||"#b2dfdb",color:e.color||getColorFromBackgroundColor("#b2dfdb"),dragBgColor:e.bgColor||"#b2dfdb",raw:{contact:a.contact,contents:a.contents,etc:a.etc,status:a.status}}}),!0)}function x(a){var e=a.parentsUntil("#noShowScheduleList",".row");c("#noShowScheduleDropdown").data("id",e.data("id")).data("manager",e.data("manager")).data("status",e.data("status")).css("top",a[0].getBoundingClientRect().top-c("#noShowSchedule")[0].getBoundingClientRect().top+a.height()+3+"px").css("right",a[0].getBoundingClientRect().right-c("#noShowSchedule")[0].getBoundingClientRect().right<-20?"1rem":a[0].getBoundingClientRect().right-c("#noShowSchedule")[0].getBoundingClientRect().right+"px").show()}function A(a){var e=a.parentsUntil("#noShowSearchList",".row");if(""===e.find("input[name='noShowSearchAddContact']").val())return alert("전화번호를 입력해주세요!"),void e.find("input[name='noShowSearchAddContact']").focus();if(!moment(e.find("input[name='noShowSearchAddDate']").val(),"YYYY-MM-DD").isValid())return alert("노쇼 날짜를 알맞게 입력해주세요!"),void e.find("input[name='noShowSearchAddDate']").focus();var t={id:e.data("id"),contact:e.find("input[name='noShowSearchAddContact']").val(),date:moment(e.find("input[name='noShowSearchAddDate']").val(),"YYYY-MM-DD").format("YYYYMMDD"),noShowCase:e.find("select").val()};NMNS.socket.emit("add noshow",t),a.off("touch click").on("touch click",function(){alert("저장 요청중입니다..!")})}function B(a){var e=a.parentsUntil("#noShowSearchList",".row");NMNS.history.push({id:e.data("id"),contact:e.data("contact"),date:e.data("date"),noShowCase:e.data("noshowcase")}),NMNS.socket.emit("delete noshow",{id:e.data("id")}),e.remove()}function H(a){var e=c(a).parents(".addManagerItem"),t=e.find("input[type='text']");if(!t.val()||t.val().length<1)alert("담당자 이름을 입력해주세요.");else{var n=t.data("id"),o=e.find(".addManagerColor").data("color");e.removeClass("addManagerItem"),e.html("<label><input class='tui-full-calendar-checkbox-round' checked='checked' type='checkbox'><span style='background-color:"+t.data("color")+"; border-color:"+t.data("color")+"'></span><small>"+t.val()+"</small></label>");var i=NMNS.calendar.getCalendars();i.push({id:n,name:t.val(),checked:!0,bgColor:o,borderColor:o,color:getColorFromBackgroundColor(o)}),NMNS.calendar.setCalendars(i),NMNS.socket.emit("add manager",{id:n,name:t.val(),color:o})}}function R(a){c(a).parents(".addManagerItem").remove()}NMNS.socket=io(),NMNS.socket.emit("get info"),NMNS.socket.emit("get manager"),NMNS.socket.on("get reserv",t("예약 정보 받아오기",function(a){I(a.data),NMNS.holiday=a.holiday,u()})),NMNS.socket.on("get info",t("매장 정보 받아오기",function(a){NMNS.info=a.data,NMNS.calendar&&NMNS.calendar.setOptions({week:{hourStart:NMNS.info.bizBeginTime?parseInt(NMNS.info.bizBeginTime.substring(0,2),10):9,hourEnd:NMNS.info.bizEndTime?parseInt(NMNS.info.bizEndTime.substring(0,2),10)+("00"===NMNS.info.bizEndTime.substring(2)?0:1):23}}),NMNS.email=a.data.email||NMNS.email,NMNS.calendarHeight=4.26*(NMNS.calendar.getOptions().week.hourEnd-NMNS.calendar.getOptions().week.hourStart)+7.25,c("#mainCalendar").css("height",NMNS.calendarHeight+"rem"),NMNS.info.isFirstVisit&&"BEFORE_EMAIL_VERIFICATION"===NMNS.info.authStatus?F({title:"No More No Show에 오신 것을 환영합니다!",body:"계정 인증을 위하여 이메일 주소로 메일을 보냈으니 확인해주세요 :)"}):"BEFORE_EMAIL_VERIFICATION"===NMNS.info.authStatus&&moment(NMNS.info.signUpDate,"YYYYMMDD").add(30,"d").isSameOrAfter(moment(),"day")&&F({title:"이메일을 인증해주세요!",body:"인증메일은 내 매장 정보 화면에서 다시 보내실 수 있습니다. 이메일을 인증해주세요!"}),(NMNS.info.isFirstVisit||("true"===getCookie("showTips")||void 0===getCookie("showTips"))&&Math.random()<.7)&&c("#tipsModal").modal("show")})),NMNS.socket.on("get manager",t("매니저 정보 받아오기",function(a){a.data.forEach(function(a){a.checked=!0,a.bgColor=a.color,a.borderColor=a.color,a.color=getColorFromBackgroundColor(a.bgColor)}),c("#lnbManagerList").html(g(a.data)),NMNS.calendar.setCalendars(a.data),NMNS.needInit&&(delete NMNS.needInit,f())})),NMNS.initTaskModal=Y;var z,L,P,O,_,V,U=function(a){var e=a.parentsUntil("#noShowScheduleList",".row");NMNS.history.push({id:e.data("id"),calendarId:e.data("manager"),raw:{status:e.data("status")}}),NMNS.calendar.updateSchedule(e.data("id"),e.data("manager"),{raw:{status:"RESERVED"}}),NMNS.socket.emit("update reserv",{id:e.data("id"),status:"RESERVED"}),e.children("span:last-child").html(c(p("RESERVED"))).on("touch click",function(){x(c(this))})};function F(e){if(NMNS.notification||("Notification"in window&&("granted"===Notification.permission?NMNS.notification="GRANTED":"default"===Notification.permission&&(NMNS.notification="REQUESTING",Notification.requestPermission().then(function(a){"granted"===a?NMNS.notification="GRANTED":(NMNS.notification="DENIED",c.notifyDefaults({newest_on_top:!0,type:"minimalist",allow_dismiss:!0,delay:0,url:"#",element:"#notifications",icon_type:"class",onClosed:function(){var t=10;c("#notifications .alert").each(function(a,e){t+=e.getBoundingClientRect().height+10}),c("#notifications").height(t+"px"),""===c("#notifications").html()&&c("#notifications").hide()},template:'<div data-notify="container" class="col-12 alert alert-{0}" role="alert" data-id="'+e.id+'"><button type="button" aria-hidden="true" class="close" data-notify="dismiss">×</button><i data-notify="icon" class="img-circle float-left notification-icon"></i><span data-notify="title" class="notification-title">{1}</span><span data-notify="message" class="notification-body">{2}</span></div>'}))}))),"GRANTED"!==NMNS.notification&&c.notifyDefaults({newest_on_top:!0,type:"minimalist",allow_dismiss:!0,delay:0,url:"#",element:"#notifications",icon_type:"class",onClosed:function(){var t=10;c("#notifications .alert").each(function(a,e){t+=e.getBoundingClientRect().height+10}),c("#notifications").height(t+"px")},template:'<div data-notify="container" class="col-12 alert alert-{0}" role="alert" data-id="'+e.id+'"><button type="button" aria-hidden="true" class="close" data-notify="dismiss">×</button><i data-notify="icon" class="img-circle float-left notification-icon"></i><span data-notify="title" class="notification-title">{1}</span><span data-notify="message" class="notification-body">{2}</span><a href="{3}" target="{4}" data-notify="url"></a></div>'})),e.data&&"cancel reserv"===e.data.type&&e.data.id&&e.data.manager&&NMNS.calendar.updateSchedule(e.data.id,e.data.manager,{raw:{status:"CUSTOMERCANCELED"}}),"GRANTED"===NMNS.notification)try{return void(new Notification(e.title,{requireInteraction:!0,lang:"ko-KR",body:e.body,icon:"/nmns/img/favicon-32x32.png"}).onclick=function(a){a.preventDefault(),e.data&&e.data.url&&window.open(e.data.url,"_blank")})}catch(a){console.error(a)}c.notify({icon:"fas fa-bell",title:e.title,message:e.body,url:e.data&&e.data.url?e.data.url:"#"},{});var t=10;c("#notifications .alert").each(function(a,e){t+=e.getBoundingClientRect().height+10}),c("#notifications").height(t+"px")}c("#nextTips").one("touch click",function(){NMNS.socket.emit("get tips"),c("#waitTips").parent().addClass("wait"),NMNS.tips=[{title:c("#tipsTitle").html(),body:c("#tipsBody").html()}],c(this).on("touch click",function(){if(!c(this).hasClass("disabled")&&!c("#waitTips").is(":visible")){var a=c("#tipsModal").data("index")+1;NMNS.tips&&a<NMNS.tips.length&&(c("#tipsModal").data("index",a),a===NMNS.tips.length-1&&c("#nextTips").addClass("disabled"),c("#tipsTitle").html(NMNS.tips[a].title),c("#tipsBody").html(NMNS.tips[a].body),c("#prevTips").removeClass("disabled"))}}),c("#prevTips").on("touch click",function(){if(!c(this).hasClass("disabled")){var a=c("#tipsModal").data("index")-1;c("#waitTips").is(":visible")||0<=a&&NMNS.tips&&(c("#tipsModal").data("index",a),0===a&&c("#prevTips").addClass("disabled"),c("#tipsTitle").html(NMNS.tips[a].title),c("#tipsBody").html(NMNS.tips[a].body),c("#nextTips").removeClass("disabled"))}})}),c("#submitFeedback").off("touch click").on("touch click",function(a){var e=c("#feedbackBody").val();if(e&&0<e.trim().length){NMNS.socket.emit("submit feedback",{data:e.trim()}),c("#feedbackModal").modal("hide");var t=document.getElementById("snackbar");t||((t=document.createElement("div")).setAttribute("id","snackbar"),t.innerHTML="제안/문의해주신 내용이 잘 전달되었습니다.<br/> 소중한 의견에 감사드립니다.",document.getElementById("mainContents").appendChild(t)),t.className="show",setTimeout(function(){t.className=t.className.replace("show","")},3e3),c("#feedbackBody").val("")}else alert("제안/문의하실 내용을 입력해주세요!")}),h(),m(),function(){c(".moveDate").on("touch click",i),c(".calendarType").on("touch click",o),c("#calendarTypeMenu").next().children("a").on("touch click",function(a){a.preventDefault();var e=c(a.target);e.hasClass("dropdown-item")||(e=e.parents(".dropdown-item")),c("#calendarTypeMenu").html(e.html()),c("#calendarTypeMenu").attr("data-action",e.data("action")),c("#calendarTypeMenu").trigger("click")}),c("#managerElements").on("change",s),c("#dropdownMenu-calendars-list").on("touch click",l),c(".addReservLink").on("touch click",r),c(".addTaskLink").on("touch click",Y),c("#infoLink").on("touch click",D),c("#alrimLink").on("touch click",v),c(".addNoShowLink, .getNoShowLink").on("touch click",E);var a=tui.util.throttle(function(){NMNS.calendar.render()},50);window.addEventListener("resize",a),flatpickr.localize("ko")}(),NMNS.socket.on("get tips",t("팁 정보 가져오기",function(a){a.data&&0<a.data.length?(NMNS.tips=NMNS.tips.concat(a.data),c("#tipsModal").data("index",1),c("#tipsModal #tipsTitle").html(NMNS.tips[1].title),c("#tipsModal #tipsBody").html(NMNS.tips[1].body),c("#prevTips").removeClass("disabled"),2===NMNS.tips.length&&c("#nextTips").addClass("disabled")):c("#nextTips").add("disabled"),c("#waitTips").parent().removeClass("wait")})).on("get summary",t("예약정보 가져오기",function(a){var e="";0===a.data.length?e="<div class='row col-12 px-0 mt-1 empty'><span class='col-12 text-center'>검색된 내용이 없습니다. 검색조건을 바꿔서 검색해보세요 :)</span></div>":a.data.forEach(function(a){e+="<div class='row col-12 px-0 mt-1' data-id='"+(a.id||"")+"' data-manager='"+(a.manager||"")+"' data-status='"+(a.status||"")+"'"+(a.contents?" title='"+a.contents+"'":"")+"><span class='col-3 col-lg-2 pr-0'>"+(a.start?moment(a.start,"YYYYMMDDHHmm").format("YYYY-MM-DD"):"")+"</span><span class='col-4 col-lg-3'>"+(a.name||"")+"</span><span class='col-3 col-lg-2 px-0'>"+dashContact(a.contact)+"</span><span class='col-3 d-none d-lg-inline-flex'>"+(a.contents||"")+"</span><span class='col-2 px-0'>"+p(a.status)+"</span></div>"}),c("#noShowScheduleList").html(e),c("#noShowScheduleList .badge, #noShowScheduleList .noShowScheduleNoShow").each(function(){c(this).off("touch click").on("touch click",function(a){a.stopPropagation(),x(c(this))})}),c("#noShowScheduleList .noShowScheduleNormal").off("touch click").on("touch click",function(a){a.stopPropagation(),U(c(this))}),NMNS.noShowModalScheduleScroll&&NMNS.noShowModalScheduleScroll.update()})),NMNS.socket.on("add reserv",t("예약/일정 추가하기",function(a){NMNS.history.remove(a.data.id,function(a,e){return a.id===e})},function(e){var a=NMNS.history.find(function(a){return a.id===e.data.id});NMNS.history.remove(e.data.id,function(a,e){return a.id===e}),delete a.id,NMNS.calendar.deleteSchedule(e.data.id,a.manager)})),NMNS.socket.on("update reserv",t("예약/일정 정보 변경하기",function(a){NMNS.history.remove(a.data.id,function(a,e){return a.id===e})},function(e){var a=NMNS.history.find(function(a){return a.id===e.data.id});if(NMNS.history.remove(e.data.id,function(a,e){return a.id===e}),"DELETED"===(a.status||a.raw.status)?(I([a]),u()):a.newCalendarId&&!NMNS.calendar.getSchedule(e.data.id,a.selectedCal?a.selectedCal.id:a.calendarId)?(NMNS.calendar.deleteSchedule(e.data.id,a.newCalendarId,!0),a.category="task"===a.category?"task":a.isAllDay?"allday":"time",a.dueDateClass="",a.calendarId=a.selectedCal?a.selectedCal.id:a.calendarId,a.start="string"==typeof a.start?moment(a.start,"YYYYMMDDHHmm").toDate():a.start,a.end="string"==typeof a.end?moment(a.end,"YYYYMMDDHHmm").toDate():a.end,a.color=a.color||a.selectedCal.color,a.bgColor=a.bgColor||a.selectedCal.bgColor,a.borderColor=a.borderColor||a.selectedCal.borderColor,NMNS.calendar.createSchedules([a])):("string"==typeof a.start&&(a.start=moment(a.start,"YYYYMMDDHHmm").toDate()),"string"==typeof a.end&&(a.end=moment(a.end,"YYYYMMDDHHmm").toDate()),NMNS.calendar.updateSchedule(e.data.id,a.selectedCal?a.selectedCal.id:a.calendarId,a)),c("#noShowScheduleList").is(":visible")&&c("#noShowScheduleList .row[data-id='"+e.data.id+"']").length){var t=c("#noShowScheduleList .row[data-id='"+e.data.id+"']");t.children("span:last-child").html(c(p(a.status||a.raw.status))),t.find(".badge, .noShowScheduleNoShow").each(function(){c(this).on("touch click",function(a){a.stopPropagation(),x(c(this))})}),t.find(".noShowScheduleNormal").on("touch click",function(a){a.stopPropagation(),U(c(this))})}})),NMNS.socket.on("add manager",t("담당자 추가하기",void 0,function(e){NMNS.calendar.setCalendars(NMNS.calendar.getCalendars().filter(function(a){return a.id!==e.data.id})),c(".lnbManagerItem[data-value='"+e.data.id+"']").remove()})),NMNS.socket.on("delete manager",t("담당자 삭제하기",function(a){NMNS.history.remove(a.data.id,findById)},function(e){var a=NMNS.history.find(function(a){return a.id===e.data.id});if(a){var t=NMNS.calendar.getCalendars();t.push(a),NMNS.calendar.setCalendars(NMNS.calendar.getCalendars()),c("#lnbManagerList").html(g(t)),u(),NMNS.history.remove(e.data.id,findById)}})),NMNS.socket.on("update manager",t("담당자 변경하기",function(a){NMNS.history.remove(a.data.id,findById)},function(e){var a=NMNS.history.find(function(a){return a.id===e.data.id});a&&(NMNS.calendar.setCalendar(e.data.id,a),c("#lnbManagerList").html(g(NMNS.calendar.getCalendars())),u(),NMNS.history.remove(e.data.id,findById))})),NMNS.socket.on("update info",t("매장 정보 변경하기",function(){NMNS.history.remove("info",findById)},function(a){var e=NMNS.history.find(function(a){return"info"===a.id});(e.bizBeginTime||e.bizEndTime)&&NMNS.calendar.setOptions({week:{hourStart:e.bizBeginTime?e.bizBeginTime.substring(0,2):NMNS.info.bizBeginTime.substring(0,2),hourEnd:e.bizEndTime?e.bizEndTime.substring(0,2):NMNS.info.bizEndTime.substring(0,2)}}),e.shopName&&M(e.shopName),NMNS.info.shopName=e.shopName||NMNS.info.shopName,NMNS.info.bizType=e.bizType,NMNS.history.remove("info",findById),NMNS.initedInfoModal=!1})),NMNS.socket.on("update alrim",t("알림톡 정보 변경하기",function(){NMNS.history.remove("alrimInfo",findById)},function(){var e=NMNS.history.find(function(a){return"alrimInfo"===a.id});Object.keys(e).forEach(function(a){NMNS.info.alrimTalkInfo[a]=e[a]}),NMNS.history.remove("alrimInfo",findById),NMNS.initedAlrimModal=!1})),NMNS.socket.on("get noshow",t("노쇼 정보 가져오기",function(e){var t="";0<e.data.summary.noShowCount?(c("#noShowSearchSummary").html(dashContact(e.data.summary.contact)+" 고객은 "+(0<e.data.detail.length?e.data.detail.length==e.data.summary.noShowCount?"우리매장에서만 ":"다른 매장 포함 ":"다른 매장에서만 ")+(1<e.data.summary.noShowCount?"총 ":"")+e.data.summary.noShowCount+"번 노쇼하셨어요. <br class='d-inline-block d-lg-none'/> 가장 마지막은 "+(moment().year()+""===e.data.summary.lastNoShowDate.substring(0,4)?"올해 ":moment().year()-1+""===e.data.summary.lastNoShowDate.substring(0,4)?"작년 ":e.data.summary.lastNoShowDate.substring(0,4)+"년 ")+parseInt(e.data.summary.lastNoShowDate.substring(4,6))+"월 "+parseInt(e.data.summary.lastNoShowDate.substring(6))+"일이었어요.").show(),0<e.data.detail.length?e.data.detail.forEach(function(a){t+="<div class='row col-12 px-0 mt-1' data-id='"+a.id+"' data-contact='"+(e.data.summary.contact||"")+"' data-date='"+(a.date||"")+"' data-noshowcase='"+(a.noShowCase||"")+"'><span class='col-4'>"+(e.data.summary.contact?dashContact(e.data.summary.contact):"")+"</span><span class='col-4'>"+(a.date?a.date.substring(0,4)+"-"+a.date.substring(4,6)+"-"+a.date.substring(6):"")+"</span><span class='col-3'>"+(a.noShowCase?"<span class='badge badge-danger'>"+a.noShowCase+"</span>":"")+"</span><span class='col-1 px-0'><i class='fas fa-trash noShowSearchDelete' title='삭제'></i></span></div>"}):t="<div class='row col-12 px-0 mt-1 empty'><span class='col-12 text-center'>우리 매장에서 추가한 노쇼는 아직 없네요!<br/>이분이 노쇼를 하셨다면 아래 추가 버튼을 눌러 다른 매장에도 공유해주세요.</span></div>"):(c("#noShowSearchSummary").html("전화번호 "+dashContact(e.data.summary.contact)+" 고객에 대해 등록된 노쇼 전적이 없습니다.").show(),t="<div class='row col-12 px-0 mt-1 empty'><span class='col-12 text-center'>이분은 노쇼를 한 적이 없으시네요! 안심하세요 :)</span></div>"),c("#noShowSearchList").html(t),c("#noShowSearchList").addClass("summary"),c("#noShowSearchList .noShowSearchDelete").off("touch click").on("touch click",function(){B(c(this))}),NMNS.noShowModalSearchScroll&&NMNS.noShowModalSearchScroll.update()})),NMNS.socket.on("add noshow",t("노쇼 추가하기",function(a){var e,t="";if(c("#noShowSearch").is(":visible")){t=a.data.noShowCase?"<span class='badge badge-light'>"+a.data.noShowCase+"</span>":"",(e=c("<div class='row col-12 px-0 mt-1' data-id='"+a.data.id+"' data-contact='"+a.data.contact+"' data-date='"+a.data.date+"' data-noshowcase='"+a.data.noShowCase+"'><span class='col-4'>"+(a.data.contact||c("#noShowSearchList div.noShowSearchAdd[data-id='"+a.data.id+"'] input[name='noShowSearchAddContact']").val())+"</span><span class='col-4'>"+(a.data.date?a.data.date.substring(0,4)+"-"+a.data.date.substring(4,6)+"-"+a.data.date.substring(6):"")+"</span><span class='col-3'>"+t+"</span><span class='col-1 px-0'><i class='fas fa-trash noShowSearchDelete' title='삭제'></i></span></div>")).insertBefore(c("#noShowSearchList").children(".noShowSearchAdd:eq(0)")),e.find(".noShowSearchDelete").on("touch click",function(){B(c(this))});var n=c("#noShowSearchList div.noShowSearchAdd[data-id='"+a.data.id+"']");n.data("datetimepicker").destroy(),n.remove()}alert("추가되었습니다! 다른 분들에게 많은 도움이 될거에요 :)")},function(a){c("#noShowSearchList div.noShowSearchAdd[data-id='"+a.data.id+"'] .noShowSearchAddSubmit").off("touch click").on("touch click",function(){A(c(this))})})),NMNS.socket.on("delete noshow",t("노쇼 삭제하기",function(a){NMNS.history.remove(a.data.id,findById)},function(e){if(e&&e.data){var a=NMNS.history.find(function(a){return a.id===e.data.id});if(a){var t=c("<div class='row col-12 px-0 mt-1' data-id='"+a.id+"' data-contact='"+(a.contact||"")+"' data-date='"+(a.date||"")+"' data-noshowcase='"(a.noShowCase||"")+"'><span class='col-4'>"+(a.contact?dashContact(a.contact):"")+"</span><span class='col-4'>"+(a.date?a.date.substring(0,4)+"-"+a.date.substring(4,6)+"-"+a.date.substring(6):"")+"</span><span class='col-3'>"+(a.noShowCase?"<span class='badge badge-light'>"+a.noShowCase+"</span>":"")+"</span><span class='col-1 px-0'><i class='fas fa-trash noShowSearchDelete' title='삭제'></i></span></div>");t.find(".noShowSearchDelete").off("touch click").on("touch click",function(){B(c(this))}),c("#noShowSearchList .empty").length?c("#noShowSearchList").html(t):c("#noShowSearchList .noShowSearchAdd").length?t.insertBefore("#noShowSearchList .noShowSearchAdd:first-child"):c("#noShowSearchList").append(t)}}})),NMNS.socket.on("update password",t("비밀번호 변경하기")),NMNS.socket.on("get customer info",t("자동완성 자료 가져오기",function(a){if(a.data.id){var e=c("#"+a.data.id);e.autocomplete().onSuccess.call(e.autocomplete(),a.data.query,a.data.result)}},function(a){if(a.data.id){var e=c("#"+a.data.id);e.autocomplete().onFail.call(e.autocomplete(),a.data)}},!0)),NMNS.socket.on("get customer",t("고객 정보 가져오기",function(a){if(a.data.contact===c("#creationPopupContact").val()&&c("#creationPopup").data("contact")!==a.data.contact){if(a.data.etc&&c("#creationPopupEtc").val(a.data.etc),a.data.manager){var e=d(a.data.manager);e&&c("#creationPopupManager").html(c("#creationPopupManager").next().find("button[data-calendar-id='"+e.id+"']").html()).data("calendarid",e.id)}a.data.contents&&c("#creationPopupContents").val(a.data.contents),void 0!==a.data.isAllDay&&c("#creationPopupAllDay").attr("checked",a.data.isAllDay),a.data.name&&c("#creationPopupName").val(a.data.name)}void 0!==a.data.totalNoShow&&0<a.data.totalNoShow&&(c("#creationPopupContact").tooltip({title:"이 번호에 등록된 노쇼는 총 "+a.data.totalNoShow+"건입니다.<br/>"+(a.data.myNoShow&&0<a.data.myNoShow?"우리 매장에서는 "+a.data.myNoShow+"번 등록되었습니다.":""),placement:576<c(window).width()?"right":"top",trigger:"click hover focus",delay:{hide:1e3},html:!0}).tooltip("show"),setTimeout(function(){c("#creationPopupContact").tooltip("hide")},3e3),c("#creationPopupContact").one("keyup change",function(){c(this).tooltip("dispose")}))},void 0,!0)),NMNS.socket.on("message",t("서버 메시지 받기",function(a){"push"===a.type?a.data.forEach(function(a){F(a)}):"alert"===a.type&&alert(a.data.body)},void 0,!0)),c("#infoModal").on("hide.bs.modal",function(){if("INPUT"===document.activeElement.tagName)return!1;var t=!1;return moment(c("#infoBizBeginTime").val(),"HH:mm").format("HHmm")!==NMNS.info.bizBeginTime&&(t=!0),t||moment(c("#infoBizEndTime").val(),"HH:mm").format("HHmm")===NMNS.info.bizEndTime||(t=!0),t||c("#infoShopName").val()===(NMNS.info.shopName||"")||(t=!0),t||""===c("#infoPassword").val()||(t=!0),t||c("#infoBizType").val()===(NMNS.info.bizType||"")||(t=!0),t||c(".infoManagerItem").each(function(){if(!t)if(c(this).hasClass("addManagerItem"))t=!0;else{var a=c(this).find("input[type='text']"),e=d(a.data("id"));c(this).data("delete")&&e?t=!0:e&&(a.data("color")===e.bgColor&&a.val()===e.name||(t=!0))}}),!(t&&!confirm("저장되지 않은 변경내역이 있습니다. 창을 닫으시겠어요?"))&&void 0}).on("touch click",function(a){if(c("#infoModalColorPicker").is(":visible")){var e=c(a.target);e.parents("#infoModalColorPicker").length||e.hasClass("infoManagerColor")||e.hasClass("tui-full-calendar-checkbox-round")||e.parents(".infoManagerColor").length||e.parents(".tui-full-calendar-checkbox-round").length||e.hasClass("addManagerColor")||e.parents(".addManagerColor").length||e.parents(".addManagerColor").length||c("#infoModalColorPicker").hide(300)}}).on("shown.bs.modal",function(){NMNS.infoModalScroll.update(),c("#infoManagerList")[0].scrollTop=0}),c("#alrimModal").on("hide.bs.modal",function(){if("INPUT"===document.activeElement.tagName)return!1;var a=!1;return(c("#alrimUseYn").prop("checked")&&"Y"!==NMNS.info.alrimTalkInfo.useYn||!c("#alrimUseYn").prop("checked")&&"N"!==NMNS.info.alrimTalkInfo.useYn)&&(a=!0),a||c("#alrimShopName").val()===(NMNS.info.shopName||"")||(a=!0),a||c("#alrimCallbackPhone").val()===(NMNS.info.alrimTalkInfo.callbackPhone||"")||(a=!0),a||c("#alrimCancelDue").val()===(NMNS.info.alrimTalkInfo.cancelDue||"")||(a=!0),a||c("#alrimNotice").val()===(NMNS.info.alrimTalkInfo.notice||"")||(a=!0),!(a&&!confirm("저장되지 않은 변경내역이 있습니다. 창을 닫으시겠어요?"))&&void 0}),c("#noShowModal").on("touch click",function(a){if(c("#noShowScheduleDropdown").is(":visible")){var e=c(a.target);e.parents("#noShowScheduleDropdown").length||e.hasClass("badge")||e.parents(".noShowScheduleNoShow").length||c("#noShowScheduleDropdown").hide(300)}}).on("hide.bs.modal",function(){if("INPUT"===document.activeElement.tagName)return!1}).on("show.bs.modal",function(a){c(a.relatedTarget).hasClass("getNoShowLink")?c("#noShowTabList .nav-link[href='#noShowSearch']").tab("show"):c(a.relatedTarget).hasClass("addNoShowLink")&&c("#noShowTabList .nav-link[href='#noShowAdd']").tab("show")}),c("#taskModal").on("hide.bs.modal",function(a){var e=c(this).data("task");e&&e.guide&&(e.guide.clearGuideElement(),e.guide=null)}),c("#mainRow").on("touch click",function(){c("#navbarResponsive").hasClass("show")&&c("#navbarResponsive").collapse("hide")}),c("#noMoreTips").on("touch click",function(){document.cookie="showTips=false"}),c("#showTips").on("touch click",function(a){a.preventDefault(),c("#noMoreTips").remove(),c("#tipsModal").modal("show")}),c("#lnbLastMenu a").on("touch click",function(a){a.preventDefault()}),z=document.getElementById("mainRow"),V=function(a){"left"===a?c("#renderRange").next().trigger("click"):"right"===a&&c("#renderRange").prev().trigger("click")}||function(a){},(_=z).addEventListener("touchstart",function(a){var e=a.changedTouches[0];dist=0,L=e.pageX,O=(new Date).getTime()},!1),_.addEventListener("touchend",function(a){var e=a.changedTouches[0];P=e.pageX-L,(new Date).getTime()-O<=300&&150<=Math.abs(P)&&V(P<0?"left":"right")},!1),c(".addManager").on("touch click",function(){var a=NMNS.colorTemplate[Math.floor(Math.random()*NMNS.colorTemplate.length)],e=c(this).prev(),t="lnbManagerList"===e.attr("id")?"lnbManagerItem":"infoManagerItem",n=c("<div class='"+t+" addManagerItem'><label><input class='tui-full-calendar-checkbox-round' checked='checked' type='checkbox'/><span class='addManagerColor' style='background-color:"+a+"; border-color:"+a+";' data-color='"+a+"'></span><input type='text' name='name' class='align-middle form-control form-control-sm rounded-0' data-color='"+a+"' data-id='"+NMNS.email+generateRandom()+"' placeholder='담당자 이름'/></label>"+("lnbManagerItem"===t?"<i class='fas fa-check submitAddManager pl-1' title='추가'></i><i class='fas fa-times cancelAddManager pl-1' title='취소'></i>":"<i class='fas fa-trash cancelAddManager pl-2 title='삭제'></i>")+"</div>");e.append(n),"lnbManagerItem"===t?(n.find(".submitAddManager").off("touch click").on("touch click",function(){H(this)}),n.find("input[type='text']").off("keyup").on("keyup",function(a){27===a.which?(R(this),e.find("div:last-child input[type='text']").focus()):13===a.which&&H(this)}),n.find(".cancelAddManager").off("touch click").on("touch click",function(){R(this),e.find("div:last-child input[type='text']").focus()}),n.find(".addManagerColor").attr("title","담당자 색상은 저장 후 내 매장 정보 메뉴에서 바꾸실 수 있습니다.")):(n.find("input[type='text']").off("keyup").on("keyup",function(a){if(27===a.which){if(1==e.children(".infoManagerItem:visible").length)return;R(this),e.find("div:last-child input[type='text']").focus(),NMNS.infoModalScroll.update()}}),n.find(".addManagerColor").off("touch click").on("touch click",function(){y(c(this))}),n.find(".cancelAddManager").off("touch click").on("touch click",function(){1!=e.children(".infoManagerItem:visible").length?(R(this),e.find("div:last-child input[type='text']").focus(),NMNS.infoModalScroll.update()):alert("담당자는 반드시 1명 이상 있어야합니다!")})),e.find("div:last-child input[type='text']").focus()}),c("#copyEmail").on("touch click",function(a){a.preventDefault();var e=document.createRange();e.selectNodeContents(c(this)[0]);var t=window.getSelection?window.getSelection():document.selection;t.removeAllRanges(),t.addRange(e);var n="";return n=document.execCommand("copy")?"메일주소가 복사되었습니다.":"메일주소를 복사하지 못했습니다. 직접 선택하여 복사해주세요.",c(this).attr("title",n).tooltip({trigger:"manual",delay:{hide:1e3}}),c(this).tooltip("show"),setTimeout(function(){c("#copyEmail").attr("title","메일주소 복사").tooltip("dispose")},1500),t.empty?t.empty():t.removeAllRanges&&t.removeAllRanges(),!1}),c(".openAppLink").off("touch click").on("touch click",function(a){var e=navigator.userAgent.toLocaleLowerCase();-1<e.indexOf("android")||(-1<e.indexOf("ipod")||-1<e.indexOf("iphone")||-1<e.indexOf("ipad"))&&window.open(c(this).data("ios"),"_system")}),c(".mfb-component__button--child").off("touch click").on("touch click",function(a){document.getElementById("floatingButton").setAttribute("data-mfb-state","closed")}),NMNS.socket.emit("get noti"),NMNS.socket.on("get noti",t("서버 메시지 받기",function(a){a.data.data.forEach(function(a){F(a)})}))}(jQuery);