!function(a){var i;function e(){var e=document.querySelector(".mdl-stepper"),t="mdl-stepper--horizontal";if(e){var n=a(window).width();n<=840&&e.classList.contains(t)?e.classList.remove(t):840<n&&!e.classList.contains(t)&&e.classList.add(t)}}!function(){var e;if(i=document.querySelector("#signupStepper")){e=i.querySelectorAll(".mdl-step");for(var t=0;t<e.length;t++)0<t&&e[t].addEventListener("onstepback",function(e){i.MaterialStepper.back()})}}(),a("#contractText").on("scroll",function(){if(a("#agreeContractBtn").hasClass("disabled")){var e=a(this)[0].scrollHeight-a(this)[0].clientHeight-500;a(this).scrollTop()>e&&a("#agreeContractBtn").removeClass("disabled")}}),window.addEventListener("resize",e),document.addEventListener("DOMContentLoaded",function(){e(),flatpickr("#signupBizBeginTime",{dateFormat:"H:i",time_24hr:!0,defaultHour:9,defaultMinute:0,minuteIncrement:10,noCalendar:!0,enableTime:!0,applyBtn:!0}).setDate(moment("0900","HHmm").toDate()),flatpickr("#signupBizEndTime",{dateFormat:"H:i",time_24hr:!0,defaultHour:23,defaultMinute:0,minuteIncrement:10,noCalendar:!0,enableTime:!0,applyBtn:!0}).setDate(moment("2300","HHmm").toDate())}),a("#agreeContractBtn").on("touch click",function(e){if(a(this).hasClass("disabled"))return i.MaterialStepper.error("이용약관을 끝까지 확인 후 동의해주세요."),alert("이용약관을 끝까지 확인 후 동의해주세요."),!1;i.MaterialStepper.next()}),a("#signupBtn").on("touch click",function(e){if(!validateEmail(a("#signupEmail").val()))return alert("입력된 이메일이 올바르지 않습니다. 다시 한 번 확인해주세요!"),void a("#signupEmail").focus();if(!/\W+/.test(a("#signupPassword").val())||!/[0-9]+/.test(a("#signupPassword").val()))return alert("비밀번호는 하나 이상의 숫자와 특수문자를 포함해야합니다."),void a("#signupPassword").focus();if(a("#signupPassword").val()!==a("#signupRePassword").val())return alert("비밀번호 확인 값이 일치하지 않습니다."),void a("#signupRePassword").focus();if(a("#signupUseYn").prop("checked")){if(700<a("#signupNotice").val().length)return alert("알림 안내문구의 길이가 너무 깁니다. 조금만 줄여주세요 :)"),void a("#signupNotice").focus();if(""===a("#signupCallbackPhone").val())return alert("알림톡을 사용하시려면 반드시 휴대폰번호를 입력해주세요!"),void a("#signupCallbackPhone").focus();if(!/^01([016789]?)([0-9]{3,4})([0-9]{4})$/.test(a("#signupCallbackPhone").val()))return alert("입력하신 휴대폰번호가 정확하지 않습니다.\n휴대폰번호를 정확히 입력해주세요!"),void a("#signupCallbackPhone").focus();if(""===a("#signupShopName").val())return alert("알림톡을 사용하시려면 고객에게 보여줄 매장 이름을 입력해주세요!"),void a("#signupShopName").focus()}var t=moment(a("#signupBizBeginTime").val(),"HH:mm"),n=moment(a("#signupBizEndTime").val(),"HH:mm");return t.isValid()?n.isValid()?(i.MaterialStepper.showTransitionEffect(),void fetch("/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a("#signupEmail").val(),password:a("#signupPassword").val(),shopName:a("#signupShopName").val(),bizBeginTime:t.format("HHmm"),bizEndTime:n.format("HHmm"),useYn:a("#signupUseYn").prop("checked")?"Y":"N",callbackPhone:a("#signupCallbackPhone").val(),notice:a("#signupNotice").val(),cancelDue:a("#signupCancelDue").val(),kakaotalk:a(this).data("kakaotalk")||void 0})}).then(function(e){return e.json()}).then(function(e){i.MaterialStepper.hideTransitionEffect(),"200"===e.status?i.MaterialStepper.next():(i.MaterialStepper.error(e.message),alert(e.message))}).catch(function(e){var t=e.json().message;i.MaterialStepper.error(t),i.MaterialStepper.hideTransitionEffect()})):(alert("매장 운영 종료시간이 올바르지 않습니다."),void a("#signupBizEndTime").focus()):(alert("매장 운영 시작시간이 올바르지 않습니다."),void a("#signupBizBeginTime").focus())}),a("label[for=signupUseYn]").on("touch click",function(){a(".alrimRequirement").toggle()}),a("#signupNotice").off("keyup keydown paste cut change").on("keyup keydown paste cut change",function(){a("#noticeByteCount").text(a(this).val().length),a(this).height(0).height(150<this.scrollHeight?150:this.scrollHeight<60?60:this.scrollHeight)}).on("blur",function(){a(this).val(removeNonCharacter(a(this).val()))}),a("#copyEmail").on("touch click",function(e){e.preventDefault();var t=document.createRange();t.selectNodeContents(a(this)[0]);var n=window.getSelection?window.getSelection():document.selection;n.removeAllRanges(),n.addRange(t);var i="";return i=document.execCommand("copy")?"메일주소가 복사되었습니다.":"메일주소를 복사하지 못했습니다. 직접 선택하여 복사해주세요.",a(this).attr("title",i).tooltip({trigger:"manual",delay:{hide:1e3}}),a(this).tooltip("show"),setTimeout(function(){a("#copyEmail").attr("title","메일주소 복사").tooltip("dispose")},1500),n.empty?n.empty():n.removeAllRanges&&n.removeAllRanges(),!1}),a("#resendEmail").on("touch click",function(e){return e.preventDefault(),fetch("/sendVerification",{method:"POST"}).then(function(e){return e.json()}).then(function(e){"200"===e.status?showSnackBar("<span>인증을 위한 이메일을 전송하였습니다.<br/>이메일을 확인해주세요.</span>"):alert(e.message||"이메일을 전송하지 못했습니다.["+JSON.stringify(e)+"]")}).catch(function(e){try{var t=e.json().message;alert(t)}catch(e){alert("이메일을 전송하지 못했습니다. 잠시 후 다시 시도해주세요.")}}),!1})}(jQuery);